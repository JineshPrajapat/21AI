export const blog = [
    {
        postId: "1",
        title: "Introduction to React",
        imgURL: "",
        content: `<header style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <h1 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:3vw auto 2vw;text-align:center;text-transform:uppercase;">
        Transformers from scratch
    </h1>
</header>
<ul class="links" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:table;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px 0px 0.3em;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            18 Aug 2019
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former">code on github</a>
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/playlist?list=PLIXJ-Sacf8u60G1TwcznBmK6rEL3gmZmV">video lecture</a>
        </p>
    </li>
</ul>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Transformers are a very exciting family of machine learning architectures. Many good tutorials exist (e.g. [1, 2]) but in the last few years, transformers have mostly become simpler, so that it is now much more straightforward to explain how modern architectures work. This post is an attempt to explain directly how modern transformers work, and why, without some of the historical baggage.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    I will assume a basic understanding of neural networks and backpropagation. If you’d like to brush up, <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture06/">this lecture</a> will give you the basics of neural networks and <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/">this one</a> will explain how these principles are applied in modern deep learning systems.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html">working knowledge of Pytorch</a> is required to understand the programming examples, but these can also be safely skipped.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="self-attention">
    Self-attention
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The fundamental operation of any transformer architecture is the <i>self-attention operation</i>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>We'll explain where the name "self-attention" comes from later. For now, don't read too much in to it.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Self-attention is a sequence-to-sequence operation: a sequence of vectors goes in, and a sequence of vectors comes out. Let’s call the input vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-1-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.694em;" id="MathJax-Span-1"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.121em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.12em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-2"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-3"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-4"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-5"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-6">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-7">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-8">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-9"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-10"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-11"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-12">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-13">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-14">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-15">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-16">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-17"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-18"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-19"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-20">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-21">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and the corresponding output vectors <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-2-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.104em;" id="MathJax-Span-22"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.489em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.49em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-23"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-24"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-25"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-26"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-27">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-28">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-29">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-30"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-31"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-32"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-33">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-34">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-35">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-36">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-37">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-38"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-39"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-40"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-41">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-42">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>. The vectors all have dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-3-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-43"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-44"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-45">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To produce output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-4-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-46"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-47"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-48"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-49"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-50"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-51">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-52"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-53"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-54"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-55"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-56">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>, the self attention operation simply takes <i>a weighted average over all the input vectors</i>
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-5-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:7.25em;" id="MathJax-Span-57"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.513em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.067em, 1006.51em, 3.606em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-58"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-59"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-60"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-61"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-62">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-63"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-64"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-65"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-66"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-67">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-68">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-69"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-70">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-71"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-72"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-73"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-74"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-75"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-76"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-77">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-78"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-79">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-80"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-81"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-82"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-83"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-84"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-85"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-86">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-87"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-88"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-89"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-90"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-91">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-92"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-93"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-94"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-95">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-96"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-97"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-98"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-99"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-100">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-101"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-102"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.543em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-6-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-103"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-104"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-109">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> indexes over the whole sequence and the weights sum to one over all <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-7-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-110"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-111"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-112"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-113"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-114"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-115"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-116">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. The weight&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-8-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-117"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1001.39em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-118"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-119"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-120">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-121"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-122"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-123"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-124"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-125"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-126"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-127">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-132">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span> is not a parameter, as in a normal neural net, but it is <i>derived</i> from a function over&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-9-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-133"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-134"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-135"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-136"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-137"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-138">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-139"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-140"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-141"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-142"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-143">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-10-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-145"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-146"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-147"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-149">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-150"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-151"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-152"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-153"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-154">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.002em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. The simplest option for this function is the dot product:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-11-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.858em;" id="MathJax-Span-155"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.285em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1005.28em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-156"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-158">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-159">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-160"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-161"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-162"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-163"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-164"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-165"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-166">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-167"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-168"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-169"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-170"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-171">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-172">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-173"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-174"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-175"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-177"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-178"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-179">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-180"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-181"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-182"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-183"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-184">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.862em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-185">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-187"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-188"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-189">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-190"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-191"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-192"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-193"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-194">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-195"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-196"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Note that&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-12-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;" id="MathJax-Span-197"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.89em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-198"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-200"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-201"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-202">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.537em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-203"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-204"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-205"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-206"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-207">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i> is the input vector at the same position as the current output vector </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-13-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.115em;" id="MathJax-Span-208"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.98em, 2.54em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-209"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-210"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.366em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-211"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-212"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-213">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.67em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.738em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-214"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-215"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-216"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-217"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-218">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.942em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.343em;width:0px;"></span></span></nobr></span></i></span><i>. For the next output vector, we get an entirely new series of dot products, and a different weighted sum.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The dot product gives us a value anywhere between negative and positive infinity, so we apply a softmax to map the values to&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-14-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-219"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.89em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-220"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-221">[</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-222">0</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-223">,</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-224">1</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-225">]</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and to ensure that they sum to 1 over the whole sequence:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-15-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:8.888em;" id="MathJax-Span-226"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.166em, 1007.99em, 3.565em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-227"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-228"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-229">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-230"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-231"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-232"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-233"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-234"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-235"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-236">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-237"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-238"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-239"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-240"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-241">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-242">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-243"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.67em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.03em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -1.513em;padding:0px;position:absolute;text-decoration:none;top:-4.953em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-244"><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-245"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-246"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-247">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-248">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-249"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-250"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-251"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-252"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-253"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-254"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-255">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-256"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-257"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-258"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-259"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-260">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1004.55em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -2.25em;padding:0px;position:absolute;text-decoration:none;top:-3.151em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-261"><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-262"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.155em, 1000.99em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Operators;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.203em;" id="MathJax-Span-263">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.067em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-265"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-266"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-267"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-268">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-269"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-270"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-271">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-272">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-273"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-274"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-275"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-276"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-277"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-278"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-279">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-280"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-281"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-282"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-283"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-284">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1004.67em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:4.67em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-285"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-286"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:3.593em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.498em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And that’s the basic operation of self attention.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1092/697;width:660px;" src="https://peterbloem.nl/files/transformers/self-attention.svg" width="1092" height="697">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        A visual illustration of basic self-attention. Note that the softmax operation over the <span style="color:rgb(177,62,38);"><span class="rc">weights</span></span> is not illustrated.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A few other ingredients are needed for a complete transformer, which we’ll discuss later, but this is the fundamental operation. More importantly, this is the only operation in the whole architecture that propagates information <i>between</i> vectors. Every other operation in the transformer is applied to each vector in the input sequence without interactions between vectors.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="understanding-why-self-attention-works">
    Understanding why self-attention works
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Despite its simplicity, it’s not immediately obvious why self-attention should work so well. To build up some intuition, let’s look first at the standard approach to <i>movie recommendation</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Let’s say you run a movie rental business and you have some movies, and some users, and you would like to recommend movies to your users that they are likely to enjoy.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    One way to go about this, is to create manual features for your movies, such as how much romance there is in the movie, and how much action, and then to design corresponding features for your users: how much they enjoy romantic movies and how much they enjoy action-based movies. If you did this, the dot product between the two feature vectors would give you a score for how well the attributes of the movie match what the user enjoys.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1011/410;width:660px;" src="https://peterbloem.nl/files/transformers/dot-product.svg" width="1011" height="410">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If the signs of a feature match for the user and the movie—the movie is romantic and the user loves romance or the movie is <i>unromantic</i> and the user hates romance—then the resulting dot product gets a positive term for that feature. If the signs don’t match—the movie is romantic and the user hates romance or vice versa—the corresponding term is negative.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Furthermore, the <i>magnitudes</i> of the features indicate how much the feature should contribute to the total score: a movie may be a little romantic, but not in a noticeable way, or a user may simply prefer no romance, but be largely ambivalent.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Of course, gathering such features is not practical. Annotating a database of millions of movies is very costly, and annotating users with their likes and dislikes is pretty much impossible.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What happens instead is that we make the movie features and user features <i>parameters</i> of the model. We then ask users for a small number of movies that they like and we optimize the user features and movie features so that their dot product matches the known likes.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Even though we don’t tell the model what any of the features should mean, in practice, it turns out that after training the features do actually reflect meaningful semantics about the movie content.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:431/333;width:660px;" src="https://peterbloem.nl/files/transformers/movie-features.svg" width="431" height="333">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        The first two learned features from a basic matrix factorization model. The model had no access to any information about the content of the movies, only which users liked them. Note that movies are arranged from low-brow to high-brow horizontally, and from mainstream to quirky vertically. From [4].
    </figcaption>
</figure>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture12/"><i>this lecture</i></a><i> for more details on recommender systems. For now, this suffices as an explanation of how the dot product helps us to represent objects and their relations.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic principle at work in the self-attention. Let’s say we are faced with a sequence of words. To apply self-attention, we simply assign each word&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-16-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-287"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-288"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-289"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-290"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-291"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-292"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-293">t</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> in our vocabulary an <i>embedding vector</i>&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-17-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-295"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-296"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-297"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-299">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-300"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-301"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-302"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-303"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-304">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> (the values of which we’ll learn). This is what’s known as an <i>embedding layer</i> in sequence modeling. It turns the word sequence&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-18-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:12.697em;" id="MathJax-Span-305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:11.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1011.43em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-306"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-307"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-308"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-309"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-310"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-311"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-312">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-313"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-314"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-315"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-316"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-317"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-318">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-319"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-320"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-321"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-322"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-323"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-324">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-325"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-326"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-327"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-328"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-329"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-330">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-331"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-332"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-333"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-334"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-335"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-336">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-337"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-338"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-339"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-340"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-341"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> into the vector sequence
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-19-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.294em;" id="MathJax-Span-342"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:12.86em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1012.86em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-343"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-344"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-345"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-346"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-347">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-348"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-349"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-350"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-351"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-352"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-353">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-354"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-355"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-356"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-357">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-358"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-359"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-360"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-361"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-362"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-363">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-364"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-365"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-366"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-367">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-368"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-369"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-370"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-371"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-372"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-373">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-374"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-375"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-376"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-377">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-378"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-379"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-380"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-381"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-382"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-383">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-384"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-385"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-386"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-387">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-388"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-389"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-390"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-391"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-392"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-393">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-394"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-395"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-396"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-397">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-398"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-399"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-400"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-401"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-402"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-403"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-404"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If we feed this sequence into a self-attention layer, the output is another sequence of vectors
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-20-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.662em;" id="MathJax-Span-405"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:13.188em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1013.19em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-406"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-407"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-408"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-409"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-410">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-411"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-412"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-413"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-414"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-415"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-416">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-417"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-418"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-419"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-420">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-421"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-422"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-423"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-424"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-425"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-426">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-427"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-428"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-429"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-430">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-431"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-432"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-433"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-434"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-435"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-436">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-437"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-438"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-439"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-440">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-441"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-442"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-443"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-444"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-445"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-446">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-447"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-448"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-449"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-450">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-451"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-452"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-453"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-454"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-455"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-456">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-457"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-458"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-459"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-460">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-461"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-462"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-463"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-464"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-465"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-21-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-466"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.56em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-467"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-468"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-469"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-470"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-471">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-472"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-473"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-474"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-475"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-476"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> is a weighted sum over all the embedding vectors in the first sequence, weighted by their (normalized) dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-22-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-477"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-478"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-479"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-480"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-481"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-482">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-483"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-484"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-485"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-486"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-487"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>.
</p>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we are <i>learning</i> what the values in&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-23-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-488"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-489"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-490"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-491"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-492"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-493">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-494"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-495"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-496"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-497"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-498">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> should be, how "related" two words are is entirely determined by the task. In most cases, the definite article <span style="color:rgb(48,102,147);"><span class="bc">the</span></span> is not very relevant to the interpretation of the other words in the sentence; therefore, we will likely end up with an embedding&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-24-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;" id="MathJax-Span-499"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.52em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-500"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-501"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-502"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-503"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-504">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-505"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-506"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-507"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-508"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-509"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that has a low or negative dot product with all other words. On the other hand, to interpret what <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span> means in this sentence, it's very helpful to work out <i>who</i> is doing the walking. This is likely expressed by a noun, so for nouns like <span style="color:rgb(48,102,147);"><span class="bc">cat</span></span> and verbs like <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span>, we will likely learn embeddings&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-25-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-510"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-511"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-512"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-513"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-514"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-515">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-516"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-517"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-518"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-519"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-520"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-26-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-521"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-522"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-523"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-524"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-525"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-526">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-527"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-528"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-529"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-530"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-531"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that have a high, positive dot product together.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic intuition behind self-attention. The dot product expresses how related two vectors in the input sequence are, with “related” defined by the learning task, and the output vectors are weighted sums over the whole input sequence, with the weights determined by these dot products.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before we move on, it’s worthwhile to note the following properties, which are unusual for a sequence-to-sequence operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            There are no parameters (yet). What the basic self-attention actually does is entirely determined by whatever mechanism creates the input sequence. Upstream mechanisms, like an embedding layer, drive the self-attention by learning representations with particular dot products (although we’ll add a few parameters later).
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            Self attention sees its input as a <i>set</i>, not a sequence. If we permute the input sequence, the output sequence will be exactly the same, except permuted also (i.e. self-attention is <i>permutation equivariant</i>). We will mitigate this somewhat when we build the full transformer, but the self-attention by itself actually <i>ignores</i> the sequential nature of the input.
        </p>
    </li>
</ul>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-basic-self-attention">
    In Pytorch: basic self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What I cannot create, I do not understand, as Feynman said. So we’ll build a simple transformer as we go along. We’ll start by implementing this basic self-attention operation in Pytorch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first thing we should do is work out how to express the self attention in matrix multiplications. A naive implementation that loops over all vectors to compute the weights and outputs would be much too slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ll represent the input, a sequence of&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-27-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-532"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-533"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-534">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> vectors of dimension&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-28-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-535"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-536"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-537">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> as a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-29-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-538"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-539"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-540">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-30-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-541"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-542"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-543">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-31-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-544"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-545"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-546"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-547"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-548">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. Including a minibatch dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-32-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-549"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.49em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-550"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-551">b</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, gives us an input tensor of size <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-33-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.606em;" id="MathJax-Span-552"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.237em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1003.11em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-553"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-554">(</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-555">b</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-556">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-557">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-558">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-559">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-560">)</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The set of all raw dot products&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-34-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-561"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-562"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-563"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-564">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-565">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-566"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-567"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-568"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-569"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-570"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-571"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-572">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-573"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-574"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-575"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-576"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-577">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> forms a matrix, which we can compute simply by multiplying&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-35-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-578"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-579"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-580"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-581"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-582">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by its transpose:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs makefile" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
import torch.nn.functional as F
# assume we have some tensor x with size (b, t, k)
x = ...
raw_weights = torch.bmm(x, x.transpose(1, 2))
# - torch.bmm is a batched matrix multiplication. It
#   applies matrix multiplication over batches of
#   matrices.</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Then, to turn the raw weights&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-36-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-583"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-584"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-585"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-586">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-587">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-588"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-589"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-590"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-591"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-592"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-593"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-594">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-595"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-596"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-597"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-598"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-599">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> into positive values that sum to one, we apply a <i>row-wise</i> softmax:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">weights = F.softmax(raw_weights, dim=2)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, to compute the output sequence, we just multiply the weight matrix by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-37-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-600"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-601"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-602"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-603"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-604">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. This results in a batch of output matrices&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-38-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-605"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-606"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-607"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-608"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-609">𝐘<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.084em;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> of size <code style="font-family:Consolas, monospace;font-size:0.8em;">(b, t, k)</code> whose rows are weighted sums over the rows of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-39-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-610"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-611"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-612"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-613"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-614">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">y = torch.bmm(weights, x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
That’s all. Two matrix multiplications and one softmax gives us a basic self-attention.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="additional-tricks">
Additional tricks
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The actual self-attention used in modern transformers relies on three additional tricks.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="1-queries-keys-and-values">
1) Queries, keys and values
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Every input vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-40-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-615"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-616"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-617"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-618"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-619"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-620">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-621"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-622"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-623"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-624"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-625">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> is used in three different ways in the self attention operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for its own output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-41-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-626"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-627"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-628"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-629"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-630"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-631">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-632"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-633"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-634"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-635"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-636">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for the output of the <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-42-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-637"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-638"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-639"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-640"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-641"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-642"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-643">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>-th vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-43-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-644"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.664em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-645"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-646"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-647"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-648"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-649">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-650"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-651"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-652"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-653"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-654">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.543em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is used as part of the weighted sum to compute each output vector once the weights have been established.
        </p>
    </li>
</ul>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
These roles are often called the <strong>query</strong>, the <strong>key</strong> and the <strong>value</strong> (we'll explain where these names come from later). In the basic self-attention we've seen so far, each input vector must play all three roles. We make its life a little easier by deriving new vectors for each role, by applying a linear transformation to the original input vector. In other words, we add three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-44-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-655"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-656"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-657">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-658">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-659">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> weight matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-45-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-660"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.64em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-661"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-662"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-663"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-664"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-665">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-666">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-46-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.804em;" id="MathJax-Span-667"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.6em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-668"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-669"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-670"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-671"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-672">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-673">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-47-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-674"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.56em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-675"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-676"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-677"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-678"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-679">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-680">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and compute three linear transformations of each <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-48-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-681"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-682"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-683"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-684">x</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-685"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-686"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-687"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-688"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-689">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>, for the three different parts of the self attention:
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-49-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:20.149em;" id="MathJax-Span-690"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:18.143em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1018.14em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-691"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-692"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:17.815em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-693"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-694"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-695"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-696"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-697"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-698">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-699"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-700"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-701"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-702"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-703">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.769em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-704"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-705"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-706"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-707">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-708"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-709"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-710"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-711">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-712">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-713"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-714"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-715"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-716">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-717"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-718"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-719"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-720"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-721">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;left:6.677em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-722"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-723"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-724"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-725"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-726"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-727">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-728"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-729"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-730"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-731"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-732">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:7.619em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.729em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-733"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-734"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-735"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-736">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-737"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-738"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-739"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-740">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-741">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-742"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-743"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-744"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-745">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-746"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-747"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-748"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-749"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-750">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:13.27em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-751"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-752"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-753"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-754"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-755"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-756">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-757"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-758"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-759"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-760"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-761">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:14.13em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-762"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-763"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-764"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-765">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-766"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-767"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-768"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-769">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-770">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-771"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-772"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-773"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-774">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-775"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-776"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-777"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-778"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-779">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>
</div>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-50-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:9.257em;" id="MathJax-Span-780"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:8.315em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(-1.104em, 1008.19em, 4.793em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-781"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-782"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.377em, 1001.39em, 6.964em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-5.362em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.39em, 4.629em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-783"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-784"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-785"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-786">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-787">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-788"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-789"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-790"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-791"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-792"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-793"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-794">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-795"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-796"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-797"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-798"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-799">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1001.39em, 4.466em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-826"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-827"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-828"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-829">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-830"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-831"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-832"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-833"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-834"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-835"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-836">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-837"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-838"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-839"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-840"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-841">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-864"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-865"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-866"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-867"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-868"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-869">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-870"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-871"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-872"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-873"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-874">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:5.367em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1006.47em, 9.339em, -999.998em);display:inline;left:1.394em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.632em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.595em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.65em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-800"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-801"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-802"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-803">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-804"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-805"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-806"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-807"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-808"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-809"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-810">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-811"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-812"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-813"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-814"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-815">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-816">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-817"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-818"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-819"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-820">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-821"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-822"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-823"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-824"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-825">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1006.47em, 4.629em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-842"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-843"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-844"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-845">=</span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-846"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">softmax</span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-847">(</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-848"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-849">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-850">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-851"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-852"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-853"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-854"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-855"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-856"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-857">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-858"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-859"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-860"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-861"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-862">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-863">)</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1005.49em, 5.489em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-875"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-876"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-877"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-878">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-879"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-880">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-881"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-882"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-883"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-884"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-885">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-886"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-887">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-888"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-889"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-890"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-891"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-892"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-893"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-894">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-895"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-896"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-897"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-898"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-899">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-900"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-901"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-902"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-903">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-904"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-905"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-906"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-907"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-908">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-909"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-910"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:6.636em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:6.366em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-2.907em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This gives the self-attention layer some controllable parameters, and allows it to modify the incoming vectors to suit the three roles they must play.
</p>
<p>
<img class="image_resized" style="aspect-ratio:873/724;width:660px;" src="https://peterbloem.nl/files/transformers/key-query-value.svg" width="873" height="724">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
Illustration of the self-attention with <span style="color:rgb(48,102,147);"><span class="bc">key</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">query</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">value</span></span> transformations.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="2-scaling-the-dot-product">
2) Scaling the dot product
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The softmax function can be sensitive to very large input values. These kill the gradient, and slow down learning, or cause it to stop altogether. Since the average value of the dot product grows with the embedding dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-51-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-911"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-912"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-913">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, it helps to scale the dot product back a little to stop the inputs to the softmax function from growing too large:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
&nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-52-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.063em;" id="MathJax-Span-914"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.448em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.412em, 1005.45em, 3.196em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-915"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-916"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-917">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-918">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-919"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-920"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-921"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-922"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-923"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-924"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-925">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-926"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-927"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-928"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-929"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-930">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-931">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-932"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1002.42em, 4.466em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -1.186em;padding:0px;position:absolute;text-decoration:none;top:-4.748em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-933"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-934"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-935"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-936"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-937"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-938"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-939"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-940">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-941"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-942"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-943"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-944"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-945">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-946">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-947"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-948"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-949"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-950">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-951"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-952"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-953"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-954"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-955">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1001.43em, 4.261em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -0.694em;padding:0px;position:absolute;text-decoration:none;top:-3.233em;transition:none;vertical-align:0px;"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-956"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-957"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-958">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.58em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.121em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.888em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1002.54em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:2.541em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.089em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>Why </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-53-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.605em;" id="MathJax-Span-959"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.43em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-960"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-961"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-962"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-963">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>? Imagine a vector in&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-54-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.204em;" id="MathJax-Span-964"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.982em, 1001.07em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-965"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-966"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-967"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-968"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.204em, 1000.58em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-969"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-970"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-971"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:20.2198px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.581em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.539em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-972">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.436em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> with values all </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-55-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.537em;" id="MathJax-Span-973"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.492em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.45em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-974"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-975">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.645em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i>. Its Euclidean length is </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-56-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.139em;" id="MathJax-Span-976"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.917em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.87em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-977"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-978"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-979"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-980">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-981">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>. Therefore, we are dividing out the amount by which the increase in dimension increases the length of the average vectors.</i>
    </p>
</aside>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="3-multi-head-attention">
3) Multi-head attention
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, we must account for the fact that a word can mean different things to different neighbours. Consider the following example.
</p>
<div class="MathJax_Display" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:block !important;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;orphans:2;position:relative;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:748px;word-spacing:0px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-57-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:11.959em;" id="MathJax-Span-982"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:10.772em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1010.77em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-983"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-984"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-985"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-986"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-987"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-988"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-989">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-990"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-991"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-992"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-993"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-994"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-995">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-996"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-997"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-998"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-999"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1000"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">roses</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1001">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1002"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1003"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1004"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1005"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1006"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">to</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1007">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1008"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1009"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1010"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1011"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1012"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We see that the word <span style="color:rgb(48,102,147);"><span class="bc">gave</span></span> has different relations to different parts of the sentence. <span style="color:rgb(48,102,147);"><span class="bc">mary</span></span> expresses who’s doing the giving, <span style="color:rgb(48,102,147);"><span class="bc">roses</span></span> expresses what’s being given, and <span style="color:rgb(48,102,147);"><span class="bc">susan</span></span> expresses who the recipient is.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
In a single self-attention operation, all this information just gets summed together. The inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-58-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;" id="MathJax-Span-1013"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.09em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1014"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1015"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1016"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1017"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1018">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1019"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1020"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1021"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1022"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1023"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-59-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1024"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1025"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1026"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1027"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1028"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1029">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1030"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1031"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1032"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1033"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1034"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> can influence the output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-60-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1035"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1036"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1037"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1038"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1039"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1040">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1041"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1042"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1043"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1044"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1045"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> by different amounts, depending on their dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-61-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;" id="MathJax-Span-1046"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.89em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1047"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1048"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1049"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1050"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1051">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1052"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1053"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1054"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1055"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1056"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, but they can’t influence it <i>in different ways</i>. If, for instance, we want the information about who gave the roses and who received them to end up in different parts of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-62-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1057"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1058"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1059"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1060"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1061"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1062">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1063"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1064"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1065"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1066"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1067"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we need a little more flexibility.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>This leaves aside how we figure out who gave the roses. We can do that based on prior knowledge about Mary and Susan, encoded in the embeddings. We can also look at the order of the words, but we'll look at how to achieve that later.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can give the self attention greater power of discrimination, by combining several self-attention mechanisms (which we'll index with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-63-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;" id="MathJax-Span-1068"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1069"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1070"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1071"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1072"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1073"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1074">r</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>), each with different matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-64-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1075"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1076"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1077"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1078"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1079"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1080">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1081"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1082"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1083"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1084"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1085">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.524em, 1000.49em, 4.302em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1086">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.498em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-65-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1087"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1088"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1089"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1090"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1091"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1092">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1093"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1094"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1095"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1096"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1097">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.49em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1098">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-66-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1099"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1100"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1101"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1102"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1103"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1104">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1109">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.41em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1110">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. These are called <i>attention heads</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
For input&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-67-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1111"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1112"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1113"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1114"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1115"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1116">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1117"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1118"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1119"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1120"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1121">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> each attention head produces a different output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-68-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.19em;" id="MathJax-Span-1122"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.07em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1123"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1124"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1125"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1126"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1127">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1132">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.33em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1133"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1134"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1135"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1136"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1137">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. We concatenate these, and pass them through a linear transformation to reduce the dimension back to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-69-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1138"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1139"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1140">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
<strong>Efficient multi-head self-attention.</strong> The simplest way to understand multi-head self-attention is to see it as a small number of copies of the self-attention mechanism applied in parallel, each with their own key, value and query transformation. This works well, but for&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-70-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1141"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1142"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1143">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> heads, the self-attention operation is&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-71-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1145"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1146">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> times as slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
It turns out we can have our cake and eat it too: there is a way to implement multi-head self-attention so that it is roughly as fast as the single-head version, but we still get the benefit of having different self-attention operations in parallel. To accomplish this, each head receives low-dimensional keys queries and values. If the input vector has&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-72-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;" id="MathJax-Span-1147"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.319em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.28em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1149">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1150">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1151">256</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> dimensions, and we have&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-73-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.664em;" id="MathJax-Span-1152"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.377em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.34em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1153"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1154">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1155">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1156">4</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> attention heads, we multiply the input vectors by a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-74-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1158"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1159">256</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1160">×</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1161">64</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix to project them down to a sequence of 64 dimansional vectors. For every head, we do this 3 times: for the keys, the queries and the values.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Here is the whole process illustrated in one image.
</p>
<p>
<img class="image_resized" style="aspect-ratio:1057/648;width:660px;" src="https://peterbloem.nl/files/transformers/multi-head.svg" alt="A diagram showing the operation of multi-head self-attention." width="1057" height="648">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
The basic idea of multi-head self-attention with 4 heads. To get our <span style="color:rgb(48,102,147);"><span class="bc">keys</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">queries</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">values</span></span>, we project the input down to vector sequences of smaller dimension.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This requires&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-75-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;" id="MathJax-Span-1162"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.11em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1163"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1164">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1165">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrices of size&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-76-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1166"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1167"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1168">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-77-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;" id="MathJax-Span-1169"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.68em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1170"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1171">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1172"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1173"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1174">/</span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1175">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>. In total, this gives us&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-78-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.94em;" id="MathJax-Span-1176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.326em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1005.33em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1177"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1178">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1179">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1180">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1181"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.41em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1182">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.45em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-3.643em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1183">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1000.58em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.575em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1184">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1185">3</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1187">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1188">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.502em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.452em;width:0px;"></span></span></nobr></span></span> parameters to compute the inputs to the multi-head self-attention: the same as we had for the single-head self-attention.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>The only difference is the matrix </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-79-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1189"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1190"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1191"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1192">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1193">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i>, used at the end of the multi-head self attention. This adds&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-80-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.16em;" id="MathJax-Span-1194"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.03em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1195"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1196"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1197">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.626em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.361em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1198">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.09em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i> parameters compared to the single-head version. In most transformers, the first thing that happens after each self attention is a feed-forward layer, so this may not be strictly necessary. I've never seen a proper ablation to test whether&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-81-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1200"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1201"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1202">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1203">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> can be removed.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can even implement this with just three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-82-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-1204"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1205"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1206">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1207">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1208">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix multiplications as in the single-head self-attention. The only extra operation we need is to slice the resulting sequence of vectors into chunks.
</p>
<figure class="narrow centering" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <figure class="image image_resized" style="width:495px;">
<img class="three-quarters" style="aspect-ratio:489/789;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/files/transformers/kqv-computation.svg" alt="A diagram showing the efficient computation of key query and value matrices in multi-head self-attention." width="489" height="789">
    </figure>
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
To compute multi-head attention efficiently, we combine the computation of the projections down to a lower dimensional representation and the computations of the keys, queries and values into three&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-83-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.585em;" id="MathJax-Span-1209"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.318em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1002.32em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1210"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1211">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1212">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1213">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.892em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></span> matrices.
    </figcaption>
</figure>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-complete-self-attention">
In Pytorch: complete self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Let’s now implement a self-attention module with all the bells and whistles. We’ll package it into a Pytorch module, so we can reuse it later.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
from torch import nn
import torch.nn.functional as F
class SelfAttention(nn.Module):
    def __init__(self, k, heads=4, mask=False):
      
    super().__init__()
    
    assert k % heads == 0
    
    self.k, self.heads = k, heads
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note the assert: the embedding dimension needs to be divisible by the number of heads.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we set up some linear transformations with <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> matrices. The <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">nn.Linear</code> module with the bias disabled gives us such a projection, and provides a reasonable initialization for us.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # These compute the queries, keys and values for all
    # heads
    self.tokeys    = nn.Linear(k, k, bias=False)
    self.toqueries = nn.Linear(k, k, bias=False)
    self.tovalues  = nn.Linear(k, k, bias=False)
	# This will be applied after the multi-head self-attention operation.
    self.unifyheads = nn.Linear(k, k)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We can now implement the computation of the self-attention (the module’s <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">forward</code> function). First, we compute the queries, keys and values for all heads:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">  def forward(self, x):
    b, t, k = x.size()
    h = self.heads
    queries = self.toqueries(x)
    keys    = self.tokeys(x)   
    values  = self.tovalues(x)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This gives us three vector sequences of the full embedding dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. As we saw above we can now cut these into <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> chunks. we can do this with a simple view operation:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">
	s = k // h
	keys    = keys.view(b, t, h, s)
	queries = queries.view(b, t, h, s)
	values  = values.view(b, t, h, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This simply reshapes the tensors to add a dimension that iterations over the heads. For a single vector in our sequence you can think of it as reshaping a vector of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code> into a matrix of <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k//h</code>:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:882/519;width:660px;" src="https://peterbloem.nl/files/transformers/reshape.svg" width="882" height="519">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we need to compute the dot products. This is the same operation for every head, so we fold the heads into the batch dimension. This ensures that we can use <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">torch.bmm()</code> as before, and the whole collection of keys, queries and values will just be seen as a slightly larger batch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since the head and batch dimension are not next to each other, we need to transpose before we reshape. (This is costly, but it seems to be unavoidable.)
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # - fold heads into the batch dimension
    keys = keys.transpose(1, 2).contiguous().view(b * h, t, s)
    queries = queries.transpose(1, 2).contiguous().view(b * h, t, s)
    values = values.transpose(1, 2).contiguous().view(b * h, t, s)
</code></pre>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>You can avoid these calls to </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>contiguous()</i></code><i> by using </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>reshape()</i></code><i> instead of </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>view()</i></code><i> but I prefer to make it explicit when we are copying a tensor, and when we are just viewing it. See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/mlvu/worksheets/blob/master/Worksheet%205%2C%20Pytorch.ipynb"><i>this notebook</i></a><i> for an explanation of the difference.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As before, the dot products can be computed in a single matrix multiplication, but now between the queries and the keys.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">   
    # Get dot product of queries and keys, and scale
    dot = torch.bmm(queries, keys.transpose(1, 2))
    # -- dot has size (b*h, t, t) containing raw weights
    # scale the dot product
    dot = dot / (s ** (1/2))
	
    # normalize 
    dot = F.softmax(dot, dim=2)
    # - dot now contains row-wise normalized weights
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We apply the self attention weights <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">dot</code> to the values, giving us the output for each attention head
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # apply the self attention to the values
    out = torch.bmm(dot, values).view(b, h, t, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To unify the attention heads, we transpose again, so that the head dimension and the embedding dimension are next to each other, and reshape to get concatenated vectors of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">e</code>. We then pass these through the <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">unifyheads</code> layer for a final projection.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # swap h, t back, unify heads
    out = out.transpose(1, 2).contiguous().view(b, t, s * h)
    
    return self.unifyheads(out)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And there you have it: multi-head, scaled dot-product self attention. You can see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/b438731ceeaf6c468f8b961bb07c2adde3b54a9f/former/modules.py#L10">the complete implementation here</a>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The implementation can be made more concise using </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://rockt.github.io/2018/04/30/einsum"><i>einsum notation</i></a><i> (see an example </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/4"><i>here</i></a><i>).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="building-transformers">
    Building <i>transformers</i>
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A transformer is not just a self-attention layer, it is an <i>architecture</i>. It’s not quite clear what does and doesn’t qualify as a transformer, but here we’ll use the following definition:
</p>
<blockquote style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, Helvetica, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px 0px 0px 4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        Any architecture designed to process a connected set of units—such as the tokens in a sequence or the pixels in an image—where the only interaction between units is through self-attention.
    </p>
</blockquote>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As with other mechanisms, like convolutions, a more or less standard approach has emerged for how to build self-attention layers up into a larger network. The first step is to wrap the self-attention into a <i>block</i> that we can repeat.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-transformer-block">
    The transformer block
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    There are some variations on how to build a basic transformer block, but most of them are structured roughly like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1090/473;width:660px;" src="https://peterbloem.nl/files/transformers/transformer-block.svg" width="1090" height="473">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    That is, the block applies, in sequence: <span style="color:rgb(103,125,0);"><span class="gc">a self attention layer,</span></span> <span style="color:rgb(177,62,38);"><span class="rc">layer normalization</span></span>, <span style="color:rgb(103,125,0);"><span class="gc">a feed forward layer</span></span> (a single <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="multi-layer perceptron">MLP</abbr> applied independently to each vector), and <span style="color:rgb(177,62,38);"><span class="rc">another layer normalization</span></span>. <span style="color:rgb(48,102,147);"><span class="bc">Residual connections</span></span> are added around both, before the normalization. The order of the various components is not set in stone; the important thing is to combine self-attention with a local feedforward, and to add normalization and residual connections.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Normalization and residual connections are standard tricks used to help deep neural networks train faster and more accurately. The layer normalization is applied over the embedding dimension only.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s what the transformer block looks like in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ruby" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class TransformerBlock(nn.Module):
  def __init__(self, k, heads):
    super().__init__()
    self.attention = SelfAttention(k, heads=heads)
    self.norm1 = nn.LayerNorm(k)
    self.norm2 = nn.LayerNorm(k)
    self.ff = nn.Sequential(
      nn.Linear(k, 4 * k),
      nn.ReLU(),
      nn.Linear(4 * k, k))
  def forward(self, x):
    attended = self.attention(x)
    x = self.norm1(attended + x)
    fedforward = self.ff(x)
    return self.norm2(fedforward + x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve made the relatively arbitrary choice of making the hidden layer of the feedforward 4 times as big as the input and output. Smaller values may work as well, and save memory, but it should be bigger than the input/output layers.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="classification-transformer">
    Classification transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The simplest transformer we can build is a <i>sequence classifier</i>. We’ll use the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Internet Movie Database">IMDb</abbr> sentiment classification dataset: the instances are movie reviews, tokenized into sequences of words, and the classification labels are <span style="color:rgb(48,102,147);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="bc">positive</span></code></span> and <span style="color:rgb(177,62,38);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="rc">negative</span></code></span> (indicating whether the review was positive or negative about the movie).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The heart of the architecture will simply be a large chain of transformer blocks. All we need to do is work out how to feed it the input sequences, and how to transform the final output sequence into a a single classification.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole experiment can be <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/master/experiments/classify.py">found here</a>. We won’t deal with the data wrangling in this blog post. Follow the links in the code to see how the data is loaded and prepared.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="output-producing-a-classification">
    Output: producing a classification
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The most common way to build a sequence classifier out of sequence-to-sequence layers, is to apply global average pooling to the final output sequence, and to map the result to a softmaxed class vector.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1039/460;width:660px;" src="https://peterbloem.nl/files/transformers/classifier.svg" width="1039" height="460">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Overview of a simple sequence classification transformer. The output sequence is <span style="color:rgb(48,102,147);"><span class="bc">averaged</span></span> to produce a single vector representing the whole sequence. This vector is projected down to a vector with one element per class and softmaxed to produce probabilities.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="input-using-the-positions">
    Input: using the positions
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve already discussed the principle of an embedding layer. This is what we’ll use to represent the words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    However, as we’ve also mentioned already, we’re stacking permutation equivariant layers, and the final global average pooling is permutation <i>in</i>variant, so the network as a whole is also permutation invariant. Put more simply: if we shuffle up the words in the sentence, we get the exact same classification, whatever weights we learn. Clearly, we want our state-of-the-art language model to have at least some sensitivity to word order, so this needs to be fixed.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The solution is simple: we create a second vector of equal length, that represents the position of the word in the current sentence, and add this to the word embedding. There are two options.
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position embeddings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            We simply <i>embed</i> the positions like we did the words. Just like we created embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-84-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1214"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1215"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1216"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1217"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1218"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1219">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1220"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1221"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1222"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1223"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1224"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-85-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1225"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1226"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1227"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1228"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1229"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1230">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1231"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1232"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1233"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1234"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1235"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we create embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-86-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;" id="MathJax-Span-1236"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.23em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1237"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1238"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1239"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1240"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1241">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1242"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1243"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1244"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1245"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1246"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">12</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-87-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;" id="MathJax-Span-1247"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.31em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1248"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1249"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1250"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1251"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1252">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1253"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1254"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1255"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1256"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1257"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">25</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>. Up to however long we expect sequences to get. The drawback is that we have to see sequences of every length during training, otherwise the relevant position embeddings don't get trained. The benefit is that it works pretty well, and it's easy to implement.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position encodings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Position encodings work in the same way as embeddings, except that we don't <i>learn</i> the position vectors, we just choose some function&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-88-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.875em;" id="MathJax-Span-1258"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.384em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.985em, 1004.38em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1259"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1260">f<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1261">:</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1262"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1263"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1265"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1266"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℕ</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1267">→</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1268"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1000.62em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1269"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1270"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1271"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1272"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1273"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.543em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1274">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.457em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> to map the positions to real valued vectors, and let the network figure out how to interpret these encodings. The benefit is that for a well chosen function, the network should be able to deal with sequences that are longer than those it's seen during training (it's unlikely to perform well on them, but at least we can check). The drawbacks are that the choice of encoding function is a complicated hyperparameter, and it complicates the implementation a little.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For the sake of simplicity, we’ll use position embeddings in our implementation.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="pytorch">
    Pytorch
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here is the complete text classification transformer in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class Transformer(nn.Module):
    def __init__(self, k, heads, depth, seq_length, num_tokens, num_classes):
        super().__init__()
        self.num_tokens = num_tokens
        self.token_emb = nn.Embedding(num_tokens, k)
        self.pos_emb = nn.Embedding(seq_length, k)
		# The sequence of transformer blocks that does all the
		# heavy lifting
        tblocks = []
        for i in range(depth):
            tblocks.append(TransformerBlock(k=k, heads=heads))
        self.tblocks = nn.Sequential(*tblocks)
		# Maps the final output sequence to class logits
        self.toprobs = nn.Linear(k, num_classes)
    def forward(self, x):
        """
        :param x: A (b, t) tensor of integer values representing
                  words (in some predetermined vocabulary).
        :return: A (b, c) tensor of log-probabilities over the
                 classes (where c is the nr. of classes).
        """
		# generate token embeddings
        tokens = self.token_emb(x)
        b, t, k = tokens.size()
		# generate position embeddings
		positions = torch.arange(t)
        positions = self.pos_emb(positions)[None, :, :].expand(b, t, k)
        x = tokens + positions
        x = self.tblocks(x)
        # Average-pool over the t dimension and project to class
        # probabilities
        x = self.toprobs(x.mean(dim=1))
        return F.log_softmax(x, dim=1)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At depth 6, with a maximum sequence length of 512, this transformer achieves an accuracy of about 85%, competitive with results from RNN models, and much faster to train. To see the real near-human performance of transformers, we’d need to train a much deeper model on much more data. More about how to do that later.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="text-generation-transformer">
    Text generation transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The next trick we’ll try is an <i>autoregressive</i> model. We’ll train a <i>character</i> level transformer to predict the next character in a sequence. The training regime is simple (and has been around <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">for far longer than transformers have</a>). We give the sequence-to-sequence model a sequence, and we ask it to predict the next character at each point in the sequence. In other words, the target output is the same sequence shifted one character to the left:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1122/458;width:660px;" src="https://peterbloem.nl/files/transformers/generator.svg" width="1122" height="458">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    With RNNs this is all we need to do, since they cannot look forward into the input sequence: output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-89-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1275"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1276"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1277">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> depends only on inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-90-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;" id="MathJax-Span-1278"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1279"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1280">0</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-91-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1281"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1282"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1283">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. With a transformer, the output depends on the entire input sequence, so prediction of the next character becomes vacuously easy, just retrieve it from the input.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To use self-attention as an autoregressive model, we’ll need to ensure that it cannot look forward into the sequence. We do this by applying a mask to the matrix of dot products, before the softmax is applied. This mask disables all elements above the diagonal of the matrix.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1014/366;width:660px;" src="https://peterbloem.nl/files/transformers/masked-attention.svg" width="1014" height="366">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Masking the self attention, to ensure that elements can only attend to input elements that precede them in the sequence. Note that the multiplication symbol is slightly misleading: we actually set the masked out elements (the white squares) to&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-92-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.961em;" id="MathJax-Span-1284"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.427em, 1001.69em, 2.362em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1285"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1286">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1287">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.146em;width:0px;"></span></span></nobr></span></span>
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we want these elements to be zero after the softmax, we set them to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-93-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.968em;" id="MathJax-Span-1288"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.763em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.435em, 1001.72em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1289"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1290">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1291">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Here’s how that looks in pytorch:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">dot = torch.bmm(queries, keys.transpose(1, 2))
indices = torch.triu_indices(t, t, offset=1)
dot[:, indices[0], indices[1]] = float('-inf')
dot = F.softmax(dot, dim=2)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After we’ve handicapped the self-attention module like this, the model can no longer look forward in the sequence.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on the standard <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">enwik8</code> dataset (taken from the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://prize.hutter1.net/">Hutter prize</a>), which contains&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-94-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1292"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.026em, 1001.43em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1293"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1295">10</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1296">8</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> characters of Wikipedia text (including markup). During training, we generate batches by randomly sampling subsequences from the data.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on sequences of length 256, using a model of 12 transformer blocks and 256 embedding dimension. After about 24 hours training on an RTX 2080Ti (some 170K batches of size 32), we let the model generate from <span style="color:rgb(115,167,211);"><span class="lbc">a 256-character seed</span></span>: for each character, we feed it the preceding 256 characters, and look what it predicts for the next character (the last output vector). We sample from that with a <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277">temperature</a> of 0.5, and move to the next character.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The output looks like this:
</p>
<div class="sample" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Consolas, monospace;font-size:0.8em;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <span style="color:rgb(115,167,211);"><span class="lbc">1228X Human &amp; Rousseau. Because many of his stories were originally published in long-forgotten magazines and journals, there are a number of [[anthology|anthologies]] by different collators each containing a different selection. His original books ha</span></span>ve been considered an anthologie in the [[Middle Ages]], and were likely to be one of the most common in the [[Indian Ocean]] in the [[1st century]]. As a result of his death, the Bible was recognised as a counter-attack by the [[Gospel of Matthew]] (1177-1133), and the [[Saxony|Saxons]] of the [[Isle of Matthew]] (1100-1138), the third was a topic of the [[Saxony|Saxon]] throne, and the [[Roman Empire|Roman]] troops of [[Antiochia]] (1145-1148). The [[Roman Empire|Romans]] resigned in [[1148]] and [[1148]] began to collapse. The [[Saxony|Saxons]] of the [[Battle of Valasander]] reported the y
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note that the Wikipedia link tag syntax is correctly used, that the text inside the links represents reasonable subjects for links. Most importantly, note that there is a rough thematic consistency; the generated text keeps on the subject of the bible, and the Roman empire, using different related terms at different points. While this is far from the performance of a model like <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>, the benefits over a similar RNN model are clear already: faster training (a similar RNN model would take many days to train) and better long-term coherence.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>In case you're curious, the Battle of Valasander seems to be an invention of the network.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At this point, the model achieves a compression of 1.343 bits per byte on the validation set, which is not too far off the state of the art of 0.93 bits per byte, achieved by the GPT-2 model (described below).
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="design-considerations">
    Design considerations
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To understand why transformers are set up this way, it helps to understand the basic design considerations that went into them. The main point of the transformer was to overcome the problems of the previous state-of-the-art architecture, the RNN (usually an LSTM or a GRU). <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Unrolled</a>, an RNN looks like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:940/301;width:660px;" src="https://peterbloem.nl/files/transformers/recurrent-connection.svg" width="940" height="301">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big weakness here is the <span style="color:rgb(48,102,147);"><span class="bc">recurrent connection</span></span>. while this allows information to propagate along the sequence, it also means that we cannot compute the cell at time step&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-95-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1297"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1299">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> until we’ve computed the cell at timestep <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-96-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;" id="MathJax-Span-1300"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.05em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.85em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1301"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1302">i</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1303">−</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1304">1</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Contrast this with a 1D convolution:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:968/347;width:660px;" src="https://peterbloem.nl/files/transformers/convolutional-connection.svg" width="968" height="347">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In this model, every output vector can be computed in parallel with every other output vector. This makes convolutions much faster. The drawback with convolutions, however, is that they’re severely limited in modeling <i>long range dependencies</i>. In one convolution layer, only words that are closer together than the kernel size can interact with each other. For longer dependence we need to stack many convolutions.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer is an attempt to capture the best of both worlds. They can model dependencies over the whole range of the input sequence just as easily as they can for words that are next to each other (in fact, without the position vectors, they can’t even tell the difference). And yet, there are no recurrent connections, so the whole model can be computed in a very efficient feedforward fashion.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The rest of the design of the transformer is based primarily on one consideration: depth. Most choices follow from the desire to train big stacks of transformer blocks. Note for instance that there are only two places in the transformer where non-linearities occur: the softmax in the self-attention and the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="rectified linear unit">ReLU</abbr> in the feedforward layer. The rest of the model is entirely composed of linear transformations, which perfectly preserve the gradient.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>I suppose the layer normalization is also nonlinear, but that is one nonlinearity that actually helps to keep the gradient stable as it propagates back down the network.</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="historical-baggage">
    Historical baggage
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If you’ve read other introductions to transformers, you may have noticed that they contain some bits I’ve skipped. I think these are not necessary to understand modern transformers. They are, however, helpful to understand some of the terminology and some of the writing <i>about</i> modern transformers. Here are the most important ones.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="why-is-it-called-self-attention">
    Why is it called self-<i>attention</i>?
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before self-attention was first presented, sequence models consisted mostly of recurrent networks or convolutions stacked together. At some point, it was discovered that these models could be helped by adding <i>attention mechanisms</i>: instead of feeding the output sequence of the previous layer directly to the input of the next, an intermediate mechanism was introduced, that decided which elements of the input were relevant for a particular word of the output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The general mechanism was as follows. We call the input the <strong>values</strong>. Some (trainable) mechanism assigns a <strong>key</strong> to each value. Then to each output, some other mechanism assigns a <strong>query</strong>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    These names derive from the datastructure of a key-value store. In that case we expect only one item in our store to have a key that matches the query, which is returned when the query is executed. Attention is a softened version of this: <i>every</i> key in the store matches the query to some extent. All are returned, and we take a sum, weighted by the extent to which each key matches the query.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The great breakthrough of self-attention was that attention by itself is a strong enough mechanism to do all the learning. <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1706.03762">Attention is all you need</a>, as the authors put it. The key, query and value are all the same vectors (with minor linear transformations). They <i>attend to themselves</i> and stacking such self-attention provides sufficient nonlinearity and representational power to learn very complicated functions.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-original-transformer-encoders-and-decoders">
    The original transformer: encoders and decoders
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    But the authors did not dispense with all the complexity of contemporary sequence modeling. The standard structure of sequence-to-sequence models in those days was an encoder-decoder architecture, with <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">teacher forcing</a>.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1036/557;width:660px;" src="https://peterbloem.nl/files/transformers/encoder-decoder.svg" width="1036" height="557">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The <i>encoder</i> takes the input sequence and maps it to a <i>latent</i> representation of the whole sequence. This can be either a sequence of latent vectors, or a single one as in the image above. This vector is then passed to a <i>decoder</i> which unpacks it to the desired target sequence (for instance, the same sentence in another language).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <i>Teacher forcing</i> refers to the technique of also allowing the decoder access to the input sentence, but in an autoregressive fashion. That is, the decoder generates the output sentence word for word based both on the latent vector and the words it has already generated. This takes some of the pressure off the latent representation: the decoder can use word-for-word sampling to take care of the low-level structure like syntax and grammar and use the latent vector to capture more high-level semantic structure. Decoding twice with the same latent representation would, ideally, give you two different sentences with the same meaning.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In later transformers, like BERT and GPT-2, the encoder/decoder configuration was entirely dispensed with. A simple stack of transformer blocks was found to be sufficient to achieve state of the art in many sequence based tasks.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This approach is sometimes called a decoder-only transformer (for an autoregressive model) or an encoder-only transformer (for a model without masking).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="modern-transformers">
    Modern transformers
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s a small selection of some modern transformers and their most characteristic details.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="bert">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1810.04805">BERT</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Bidirectional Encoder Representations from Transformers">BERT</abbr> was one of the first models to show that transformers could reach human-level performance on a variety of language based tasks: question answering, sentiment classification or classifying whether two sentences naturally follow one another.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT consists of a simple stack of transformer blocks, of the type we’ve described above. This stack is <i>pre-trained</i> on a large general-domain corpus consisting of 800M words from English books (modern work, from unpublished authors), and 2.5B words of text from English Wikipedia articles (without markup).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Pretraining is done through two tasks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Masking</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            A certain number of words in the input sequence are: masked out, replaced with a random word or kept as is. The model is then asked to predict, for these words, what the original words were. Note that the model doesn't need to predict the entire denoised sentence, just the modified words. Since the model doesn't know which words it will be asked about, it learns a representation for every word in the sequence.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Next sequence classification</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Two sequences of about 256 words are sampled that either (a) follow each other directly in the corpus, or (b) are both taken from random places. The model must then predict whether a or b is the case.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT uses WordPiece tokenization, which is somewhere in between word-level and character level sequences. It breaks words like <span style="color:rgb(48,102,147);"><span class="bc">walking</span></span> up into the tokens <span style="color:rgb(48,102,147);"><span class="bc">walk</span></span> and <span style="color:rgb(48,102,147);"><span class="bc">##ing</span></span>. This allows the model to make some inferences based on word structure: two verbs ending in -ing have similar grammatical functions, and two verbs starting with walk- have similar semantic function.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The input is prepended with a special <span style="color:rgb(48,102,147);"><span class="bc">&lt;cls&gt;</span></span> token. The output vector corresponding to this token is used as a sentence representation in sequence classification tasks like the next sentence classification (as opposed to the global average pooling over all vectors that we used in our classification model above).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After pretraining, a single task-specific layer is placed after the body of transformer blocks, which maps the general purpose representation to a task specific output. For classification tasks, this simply maps the first output token to softmax probabilities over the classes. For more complex tasks, a final sequence-to-sequence layer is designed specifically for the task.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole model is then re-trained to finetune the model for the specific task at hand.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In an ablation experiment, the authors show that the largest improvement as compared to previous models comes from the bidirectional nature of BERT. That is, previous models like GPT used an autoregressive mask, which allowed attention only over previous tokens. The fact that in BERT all attention is over the whole sequence is the main cause of the improved performance.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This is why the B in BERT stands for "bidirectional".</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The largest BERT model uses 24 transformer blocks, an embedding dimension of 1024 and 16 attention heads, resulting in 340M parameters.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="gpt-2">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="generative pre-trained transformer">GPT</abbr>-2 is the first transformer model that actually made it into <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.bbc.com/news/technology-47249163">the mainstream news</a>, after the controversial decision by OpenAI not to release the full model.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The reason was that GPT-2 could generate sufficiently believable text that large-scale fake news campaigns of the kind seen in the 2016 US presidential election would become effectively a one-person job.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first trick that the authors of GPT-2 employed was to create a new high-quality dataset. While BERT used high-quality data, their sources (lovingly crafted books and well-edited wikipedia articles) had a certain lack of diversity in the writing style. To collect more diverse data without sacrificing quality the authors used links posted on the social media site <i>Reddit</i> to gather a large collection of writing with a certain minimum level of social support (expressed on Reddit as <i>karma</i>).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is fundamentally a language <i>generation</i> model, so it uses masked self-attention like we did in our model above. It uses byte-pair encoding to tokenize the language, which , like the WordPiece encoding breaks words up into tokens that are slightly larger than single characters but less than entire words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is built very much like our text generation model above, with only small differences in layer order and added tricks to train at greater depths. The largest model uses 48 transformer blocks, a sequence length of 1024 and an embedding dimension of 1600, resulting in 1.5B parameters.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    They show state-of-the art performance on many tasks. On the wikipedia compression task that we tried above, they achieve 0.93 bits per byte.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="transformer-xl">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1901.02860">Transformer-XL</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    While the transformer represents a massive leap forward in modeling long-range dependency, the models we have seen so far are still fundamentally limited by the size of the input. Since the size of the dot-product matrix grows quadratically in the sequence length, this quickly becomes the bottleneck as we try to extend the length of the input sequence. Transformer-XL is one of the first succesful transformer models to tackle this problem.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    During training, a long sequence of text (longer than the model could deal with) is broken up into shorter segments. Each segment is processed in sequence, with self-attention computed over the tokens in the curent segment <i>and the previous segment</i>. Gradients are only computed over the current segment, but information still propagates as the segment window moves through the text. In theory at layer <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-97-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1306"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1307">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, information may be used from&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-98-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1308"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1309"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1310">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> segments ago.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>A similar trick in RNN training is called truncated backpropagation through time. We feed the model a very long sequence, but backpropagate only over part of it. The first part of the sequence, for which no gradients are computed, still influences the values of the hidden states in the part for which they are.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To make this work, the authors had to let go of the standard position encoding/embedding scheme. Since the position encoding is <i>absolute</i>, it would change for each segment and not lead to a consistent embedding over the whole sequence. Instead they use a <i>relative</i> encoding. For each output vector, a different sequence of position vectors is used that denotes not the absolute position, but the distance to the current output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This requires moving the position encoding into the attention mechanism (which is detailed in the paper). One benefit is that the resulting transformer will likely generalize much better to sequences of unseen length.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="sparse-transformers">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/sparse-transformer/">Sparse transformers</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Sparse transformers tackle the problem of quadratic memory use head-on. Instead of computing a dense matrix of attention weights (which grows quadratically), they compute the self-attention only for particular pairs of input tokens, resulting in a <i>sparse</i> attention matrix, with only&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-99-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.418em;" id="MathJax-Span-1311"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.172em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1002.17em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1312"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1313">n</span><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1314"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.66em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1315"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1316">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.7em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> explicit elements.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This allows models with very large context sizes, for instance for generative modeling over images, with large dependencies between pixels. The tradeoff is that the sparsity structure is not learned, so by the choice of sparse matrix, we are disabling some interactions between input tokens that might otherwise have been useful. However, two units that are not directly related may still interact in higher layers of the transformer (similar to the way a convolutional net builds up a larger receptive field with more convolutional layers).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Beyond the simple benefit of training transformers with very large sequence lengths, the sparse transformer also allows a very elegant way of designing an inductive bias. We take our input as a collection of units (words, characters, pixels in an image, nodes in a graph) and we specify, through the sparsity of the attention matrix, which units we believe to be related. The rest is just a matter of building the transformer up as deep as it will go and seeing if it trains.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="going-big">
    Going big
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big bottleneck in training transformers is the matrix of dot products in the self attention. For a sequence length <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-100-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-1317"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1318"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1319">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, this is a dense matrix containing&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-101-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1320"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1000.86em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1321"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1322"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.278em, 1000.41em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1323">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.412em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1324">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> elements. At standard 32-bit precision, and with&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-102-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1325"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1326"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1327">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1328">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1329">1000</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> a batch of 16 such matrices takes up about 64Mb of memory. Since we need to store at least four of them for each head of each self-attention operation (before and after softmax, plus their gradients), that limits us to at most twelve 4-head layers in a standard 12Gb GPU. In practice, we get even less, since the inputs and outputs also take up a lot of memory (although the dot product dominates).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And yet models reported in the literature contain much longer sequence lengths, with 48 or more layers, using dense dot product matrices. These models are trained on clusters, of course, but a single GPU is still required to do a single forward/backward pass. How do we fit such humongous transformers into 12Gb of memory? There are three main tricks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Half precision</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            On modern GPUs and on TPUs, tensor computations can be done efficiently on 16-bit float tensors. This isn't quite as simple as just setting the dtype of the tensor to <code style="font-family:Consolas, monospace;font-size:0.8em;">torch.float16</code>. For some parts of the network, like the loss, 32 bit precision is required. But most of this can be handled with relative ease by <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/NVIDIA/apex">existing libraries</a>. Practically, this doubles your effective memory.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient accumulation</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            For a large model, we may only be able to perform a forward/backward pass on a single instance. Batch size 1 is not likely to lead to stable learning. Luckily, we can perform a single forward/backward for each instance in a larger batch, and simply sum the gradients we find (this is a consequence of the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/#slide-024">multivariate chain rule</a>). When we hit the end of the batch, we do a single step of gradient descent, and zero out the gradient. In Pytorch this is particulary easy: you know that <code style="font-family:Consolas, monospace;font-size:0.8em;">optimizer.zero_grad()</code> call in your training loop that seems so superfluous? If you don't make that call, the new gradients are simply added to the old ones.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient checkpointing</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            If your model is so big that even a single forward/backward won't fit in memory, you can trade off even more computation for memory efficiency. In gradient checkpointing, you separate your model into sections. For each section, you do a separate forward/backward to compute the gradients, without retaining the intermediate values for the rest. Pytorch has <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/docs/stable/checkpoint.html">special utilities</a> for gradient checkpointng.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For more information on how to do this, see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://medium.com/huggingface/training-larger-batches-practical-tips-on-1-gpu-multi-gpu-distributed-setups-ec88c3e51255">this blogpost</a>.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="conclusion">
    Conclusion
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer may well be the simplest machine learning architecture to dominate the field in decades. There are good reasons to start paying attention to them if you haven’t been already.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Firstly, <strong>the current performance limit is purely in the hardware</strong>. Unlike convolutions or LSTMs the current limitations to what they can do are entirely determined by how big a model we can fit in GPU memory and how much data we can push through it in a reasonable amount of time. I have no doubt, we will eventually hit the point where more layers and and more data won’t help anymore, but we don’t seem to have reached that point yet.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Second, <strong>transformers are extremely generic</strong>. So far, the big successes have been in language modelling, with some more modest achievements in image and music analysis, but the transformer has a level of generality that is waiting to be exploited. The basic transformer is a <i>set-to-set</i> model. So long as your data is a set of units, you can apply a transformer. Anything else you know about your data (like local structure) you can add by means of position embeddings, or by manipulating the structure of the attention matrix (making it sparse, or masking out parts).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is particularly useful in multi-modal learning. We could easily combine a captioned image into a set of pixels and characters and design some clever embeddings and sparsity structure to help the model figure out how to combine and align the two. If we combine the entirety of our knowledge about our domain into a relational structure like a multi-modal knowledge graph (as discussed in [3]), simple transformer blocks could be employed to propagate information between multimodal units, and to align them with the sparsity structure providing control over which units directly interact.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    So far, transformers are still primarily seen as a language model. I expect that in time, we’ll see them adopted much more in other domains, not just to increase performance, but to simplify existing models, and to allow practitioners more intuitive control over their models’ inductive biases.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="references">
    References
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [1] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://jalammar.github.io/illustrated-transformer/">The illustrated transformer</a>, Jay Allamar.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [2] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://nlp.seas.harvard.edu/2018/04/03/attention.html">The annotated transformer</a>, Alexander Rush.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [3] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://content.iospress.com/articles/data-science/ds007">The knowledge graph as the default data model for learning on heterogeneous knowledge</a> Xander Wilcke, Peter Bloem, Victor de Boer
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [4] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf">Matrix factorization techniques for recommender systems</a> Yehuda Koren et al.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="updates-and-corrections">
    Updates and corrections
</h2>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>19 October 2019</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Added a section on the difference between wide and narrow self-attention. Thanks to <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/sidneyaraujomelo">Sidney Melo</a> for <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/8">spotting the mistake</a> in the original implementation.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>9 December 2022</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Clarified the example in the section on multi-head attention.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>4 March 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a persistent mistake in the definition of multi-head self-attention. Rewrote the final self-attention to be the canonical form (rather than the earlier "wide" variety we used for the sake of simplicity).
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>1 Aug 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed some small mistakes in the section "Going big".
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>7 May 2024</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a mistake in the multi-head self-attention: the rescaling of the parameters should divide by <code style="font-family:Consolas, monospace;font-size:0.8em;">s</code> not <code style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. Thanks to Vivek Harshey for spotting this.
        </p>
    </dd>
</dl>`,
        tags: ["React", "JavaScript", "Frontend"],
        categories: ["Development", "Web"],
        publishedDate: "2024-08-12T10:00:00Z",
        updatedDate: "2024-08-13T12:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"

    },
    {
        postId: "2",
        title: "Understanding Tailwind CSS",
        imgURL: "",
        content: `<nav class="top" style="-webkit-text-stroke-width:0px;color:white;flex:0 0 2em;font-family:Georgia, sans-serif;font-size:0.8em;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:-2px 0px 0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:auto;word-spacing:0px;">
    <ul style="align-items:center;display:flex;flex-direction:row;height:35.1875px;justify-content:flex-start;list-style:none;margin-bottom:0px;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="display:inline;flex:0 0 auto;height:35.1875px;list-style:none;margin-bottom:0px;margin-right:1em;margin-top:0px;padding:0px;width:auto;">
            <p style="margin-left:auto;">
                <a style="border-style:none;color:rgb(153, 153, 153);display:inline;font-family:Georgia, serif;height:100%;line-height:2em;padding:0vh 0px;text-align:center;text-decoration:none;text-transform:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/">home</a>
            </p>
        </li>
        <li style="display:inline;flex:0 0 auto;height:35.1875px;list-style:none;margin-bottom:0px;margin-right:1em;margin-top:0px;padding:0px;width:auto;">
            <p style="margin-left:auto;">
                <a style="border-style:none;color:rgb(153, 153, 153);display:inline;font-family:Georgia, serif;height:100%;line-height:2em;padding:0vh 0px;text-align:center;text-decoration:none;text-transform:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/blog">blog</a>
            </p>
        </li>
    </ul>
</nav>
<article style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);flex:1 1 auto;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto;orphans:2;padding:0px 0px 6vw;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <header style="margin:0px auto 1em;width:660px;">
        <h1 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:3vw auto 2vw;text-align:center;text-transform:uppercase;">
            What design can teach us
        </h1>
    </header>
    <ul class="links" style="display:table;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px 0px 0.3em;width:660px;">
        <li style="display:inline;list-style:none;padding:0px;position:static;">
            <p style="margin-left:auto;text-align:center;">
                16 Apr 2023
            </p>
        </li>
        <li style="display:inline;list-style:none;padding:0px;position:static;">
            <p style="margin-left:auto;text-align:center;">
                <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/files/design-thinking.pdf">slides</a>
            </p>
        </li>
    </ul>
    <figure class="narrow centering vspace" style="margin:2em auto 3em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:330px;">
            <img class="half" style="aspect-ratio:2064/858;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/images/design-thinking/popup.png" alt="A screenshot of a confirmation dialog in Microsoft Word." width="2064" height="858">
        </figure>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        In a previous life I worked for a bit as a designer. I did some graphic design, but my main interest was always <i>interaction</i> design: not so much what things should look like, but how they should function. Which items should you display on the homepage of a website, what should the structure of the menu be, and so.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I left that work behind a long time ago, but it taught me a few important lessons that I still apply every day in my academic life. You might expect that these lessons have to do with building websites, or choosing the layouts for my slides. But they run much deeper than that. They help me run meetings, give feedback and organize courses.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If you’ve never worked with designers before, you’ll be forgiven for thinking of them as a kind of house painters: somebody else builds the house, and they make it look good. It’s an understandable mistake, but it’s also the surest way to piss a designer off. Design is not about how the house looks: it’s about the how and why of the house. If you want to make a designer happy, you don’t give them a finished product to polish up, you put them in the room from day one of the project.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The reason is that every design decision brings you back to the fundamentals. If you want to design a good product, whether it’s a website, or a piece of software, or a research paper, every decision you make about how it should work, how it fits together, is a design decision.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To see what design really looks like in practice, and what lessons we can take from it as academics, let’s start by looking at the structure of a <i>design process</i>.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="the-process">
        The process
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        The first thing a designer will warn you against is what’s called the <i>waterfall model</i>. It’s a name for the idea of a design process that looks like this: first you write a list of requirements, things your product should do, then you make a design for how it’s going to do those things, then the programmers implement the design, verify that it’s doing what the requirements specified, and then your users start using it and you do maintenance to make sure it keeps running.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        That’s waterfall: you plan your process in little blocks, and you start the next block when the previous block is finished.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Waterfall is, as far as I’m concerned, the main reason that all computer and software products were awful throughout the eighties and nineties. It’s falling at the first hurdle of product development. The reason is that you can’t write down your requirements in one go. They’ll be nonsense. You need to figure out what your application needs to do <i>as you build it</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This won’t be news to anybody who has done any software development. It’s a message that was new and radical about 25 years ago. But academia has no problem with being 25 years behind the times in matters like these. So we’ll start with the basics. <i>We don’t do waterfall.</i>
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The alternative is usually captured by the umbrella term <i>agile development</i>. There are many flavors with detailed prescriptions that we don’t need to go into. The key idea is that you don’t design your product in one flash of imagination and then build it, like Mozart writing down the music he heard fully composed in his head. Instead, you build up a <i>concept</i>. Something rough and easy to discard. Like a painter working from a rough sketch to a detailed drawing, to blocking out the light in broad shapes, to finally putting on the highlights.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why is this not waterfall? Because at every step the painter allows herself to <i>go back</i>. Perhaps to the previous step, perhaps to the very beginning. The idea of concepts is to allow yourself to go back to the drawing board when you discover a problem.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This can be nerve-wracking, especially for project managers. With the mindset of waterfall, when you’re at the third stage out of five, you know that you’re halfway. So if you’ve spent half the money, and half the time, you’re perfectly on schedule. The problem is that if a problem crops up with the requirements, you can’t allow your programmers to go back and fix it. So you push on. Your your users get a crappy product, and your developers become miserable because nobody likes building crappy products.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The key to working agile is to allow yourself to go back when you find a problem. Moreover to <i>expect</i> to find problems. Once you’ve accepted that problems will be there, and they will send you back to the drawing board, the game changes. Your goal is no longer to build the perfect thing in one go, terrified all the while that there might be some hidden problem that will force you to start over. The goal is to build something quick and crappy, a <i>prototype</i>: something that will expose the problems with your thinking so that you catch them early, before you’ve invested so much time and energy into building the thing that you can’t bear to chuck it out.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In some areas of academia, this is already how most of us work. When we do experiments, at least in computer science and AI, we start with small-scale proofs-of-concept, and slowly build up.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But not always. How often have you made a slidedeck by starting at the first slide, and moving forward one-by-one, essentially finishing each before starting the next? Have you ever tried sketching out a few different approaches on some scrap paper before moving to the computer to make your slides in detail? Have you ever given yourself 30 minutes to think about the reason why you’re making slides? To consider alternatives like using the whiteboard, or prerecording a video?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        How many project proposals have you seen with perfect Gantt charts of exactly what was going to happen in year one, and how you were going to build on that in year two? And how often had the entire idea of the project changed six months after the starting date?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In all of these areas, design thinking can inspire us. To look at it in more detail, let’s walk through the different stages of a typical design process.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To keep things simple, we’ll break our process up in three phases. <strong>Ideation</strong>, where we decide the details of what we’re going to build and how. <strong>Prototyping</strong>, where we build increasingly detailed versions of our product, and <strong>finishing</strong>, where we put the final touches on.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="ideation">
        Ideation
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        Ideation is where you begin. You’re in a room with a bunch of your collaborators, and you know you’re going to make a thing together, but you have made no decisions yet about how to approach the problem.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is where design starts. What’s more, it’s make-or-break. You can make mistakes in this part of the process that no amount of design prowess will ever allow you to fix. The most important design tools are the ones you apply here.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To make things concrete, let’s say you’re part of the organisation of a large conference and the job of this group is to design and build the conference website. What’s the first question you need to answer?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        When left to their own devices, people will usually gravitate towards questions like <i>What should the website be built in?</i> or <i>Where should it be hosted?</i> Do we use Wordpress, or Github pages? Do we build it ourselves, pay a professional, or just take some theme off the shelf?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Then, two or three people propose solutions, and start arguing for them. These are usually the most confident, and the loudest people in the group. What’s worse, is that each of them will <i>identify</i> with their chosen solution. This is some kind of strange human defect: once you’ve proposed a solution and argued in its favor, it becomes yours. Maybe you’re mature enough to let go of it eventually, but even when you do, it will feel like a defeat.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why is this? Why can’t we just naturally explore the set of all possible options together and dicuss their pros and cons dispassionately? I don’t know. What I do know, is that there are <i>tools</i> that can bring us closer to this platonic ideal. These are the most important tools in design: not Figma or Photoshop but simple tricks that help you structure a discussion.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s start with the most important one.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="asking-questions-in-the-right-order">
        Asking questions in the right order
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        The first thing our group of conference organizers did wrong was to start with the wrong question. Eventually, you’ll need to figure out where you’ll host your website, but not before you figure out a bunch of other things. More importantly, you need to agree on all those other things and really make sure that you all agree on them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        So, what’s the main question? What’s the first thing you should always ask? For my money, it’s this:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Who is this for?
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                What do they want?
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        These are simple questions, and it may seem childish to ask them explicitly, but a clear picture of who you’re actually building for and what you want to help them achieve is the first step in avoiding those nasty shouting matches. The trick to make this useful is to answer them <i>in detail</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        For instance, who is this conference website for? Well, people who might want to visit the conference, duh. Ok, but what do they want? Well, that depends. When they’re thinking about whether to submit a paper, they’ll want to know what the submission deadline is.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s start there. Ask anybody (in computer science) to think of the last time they looked at a conference website, and what they were looking for. In my experience about 80% will say they were looking for the submission date.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Now go to any conference website, and see how many times you need to click to find the submission date. If you’re lucky, there is a menu item called “dates” which will show it in one click, albeit nestled among many other dates. If you’re unlucky, you’ll need to hunt around, and you’ll eventually find it at the bottom of a long list of submission instructions.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But if it’s so important, why still one click in the best circumstances? Why isn’t it on the front page? Why is there a news item telling me that the website is now online, but not a little table telling me whether this conference has a deadline I can make?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why do we build websites where the bit of information that is most crucial to 80% of visitors is hidden three clicks deep at the bottom of a page? I don’t think it’s cruelty or laziness. It’s just that most of us aren’t trained to take the perspective of the user when we build something. Design thinking is nothing more than a set of tools to help you, and the rest of your collaborators, do just that.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Ok, so academics make crappy websites. Maybe that’s one of those things we just learn to live with, like doctors having poor handwriting or trains being late. Maybe that’s not worth a blog post. And it’s not the point of this one. The point is not how to tell you to make better websites, it’s how to make better <i>anything</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s say you have to give a lecture on statistics. What’s the first question you ask yourself? Whether to use Keynote or Google slides? Whether to use bold notation for vectors? A designer will tell us that the first question is <i>Who is it for?</i> and the second question is <i>What do they want?</i> Who are your students? What do they already know? What can you build on? Then, what do they want? Why do they come to your lecture? Because they feel obliged to? If that’s the case, you’d better snap them out of that attitude, and show them what they can do once they master statistics. If they already want to learn statistics, because it’ll let them do thing X, then you need to figure out what X is, and work from there.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Of course, the answer is usually that you have different types of students who want different things. Your job is to craft one lecture for all of them. That's always the heart of the puzzle.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s have another example. Should your research group have a reading club? This is the sort of thing that is easily done for the wrong reasons (for instance, because all groups have reading clubs). A reading club that is poorly organized can drain people’s time and energy and cost much more than it’s worth. So who’s it for? Just the PhD students, or everybody? Why would they <i>want</i> to go to a reading club? We all struggle to keep up with the literature, so it should be an easy win. And yet, every <i>obligatory</i> reading club that I’ve ever attended has felt as lively as a wake.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        How to make reading clubs work is a topic for another blog post. For now, I just want to make the point that you should ask who you’re doing it for and what they want, before you ask who’s going to organize it, how to bound the topic, and how you’re going to enforce the attendence.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="user-stories-or-how-to-stop-arguing-solutions">
        User stories: or how to stop arguing solutions
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        Building up a clear picture of who your user is and what they want, can take a long time. In professional design settings, it’s a process that can require exhaustive research and evaluation. If you’re not building the next iPhone, however, talking it through for 15 minutes can get you most of the way there.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The main thing that takes time is not so much coming up with a picture of your users—or usally a few different types of users—but making sure that everybody in the team has the same picture in their head. The reason that this is important is that this picture will form the basis of most of your decisions going forward. It will <i>inform your choices</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        For instance, what should we put on the front page: a news feed, or the important dates? Well, let’s think about the users, and what they want. The dates, we’ve already established, are an important reason for a user to visit your site. What about the news feed. Can you <i>really</i> think of a realistic scenario in which a user visits a conference website to see if there’s been any news? There may be a few, but this should then inform which items to put in the news feed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Once you start thinking of these examples, a user coming to your site with a particular aim, you can write them down. This is called a <i>user story</i>. A little description of a particular user and what they want to do. People usually write them according to the template:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a [user of a particular type] I want to do [a thing] so that [a result].
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        You don’t have to follow this pattern, you can be a bit more free and easy with it. But the main rule is that <strong>you don’t write down how your product is going to solve the user’s need</strong>. You just answer the first two questions: who the user is and what they want to do.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I love user stories. I think they’re amazing, and if used correctly they have the potential to change the world. I wish they were taught in high school. If I had to choose whether calculus or user stories were taught in high school I’d prefer them to teach user stories (and I really need my students to know calculus).
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why am I so in love with this simple little trick? Because it solves the main trap that people fall into when they collaborate on anything. The trap that is behind all design by committee, and perhaps behind all organizational dysfunction: arguing over solutions.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let me give you a simple example.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        A design team is creating a document editor. The client demands that before the user closes the editor, a dialog appears, asking the user to save their documents. The designer disagrees: confirmation dialogs are bad practice. For various reasons, they don’t really work. The designer suggests saving the document automatically, so that the work is never lost.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The client isn’t sure: she may not want to save her changes, she may want to discard them instead, going back to the last save. This could also be achieved by having a version history, argues the designer, this would allow them to auto-save the changes, and still let the user go back to a previous version of her document.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The programmer notes that the confirmation dialog is the easiest option: it will take one line of code, while a version history will require a redesign of the codebase. At that point the battle is lost, the manager chooses the confirmation dialog. It is only a small problem after all.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is what I mean by arguing over solutions: the designer picks one solution, and the programmer another. In the end, money decides. Because, let’s be realistic, if we were perfectionist about every little thing, the product would never get made. We shouldn’t let the perfect be the enemy of the good, right?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s try the same exercise, but this time with proper use of user stories. The client suggests the pop-up dialog, and the product manager asks her instead of suggesting a solution to come up with the user story behind the solution. She thinks a bit, and suggests:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        Good start, says the designer, but we can break that up into two user stories. First there’s
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work, when I close the application.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This is solved, to some extent, by the pop-up dialog warning, although the user could still lose their work if they click the wrong button by accident. It’s solved much better by auto-saving the document.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But there’s another user story:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work, <span style="color:rgb(177,62,38);"><span class="rc">when the computer crashes</span></span>.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This user story isn’t solved at all by the popup, but it <i>is</i> solved by the auto-save.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        At this point, a good design team wouldn’t make a decision yet on the solution. They might spitball some directions, but they would write down <i>only</i> user stories. Nobody seriously talks solutions yet, and nobody commits to one strategy or another. They just move on to another topic and keep writing user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Here are some other ones that they might come up with
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to go back to previous versions of my document.
        </p>
    </blockquote>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user <span style="color:rgb(177,62,38);"><span class="rc">in a team</span></span>, I want to collaborate on a document with teammates.
        </p>
    </blockquote>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user in a team I want to track what changes others make to a document.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        All of these user stories require a versioning system to solve. Without using user stories, the team quickly locked themselves into not using a versioning system, because it was too expensive to solve one little problem. But they were only looking at one aspect of their application at a time, while every solution you implement affects many different aspects.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is why you need to <strong>hold off on thinking in terms of solutions</strong>. The longer you can spend mapping out the problem without committing to one solution or another, the better placed you’ll be to pick a solution that affects all aspects of your problem positively.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And not just that, the more time your team spends exploring the problem together, the less they are going to fight over solutions. Firstly, because once you have the problem mapped out, it’s much easier to talk about solutions dispassionately, but more importantly, because discussing problems doesn’t invite arguments. User stories never conflict. A user can want to go back to a previous version <i>and</i> not want to lose her work. Two problems can exist side by side and both be important.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        It’s only once we start selecting solutions that we have to close doors. Two solutions can conflict, two problems never will. The longer you put off picking solutions, the more productive your team can be, and the easier it’s going to be to pick solutions when the time comes.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>For many people, this can feel uncomfortable at first. People often feel like so long as there are choices being made, there is progress. By writing user stories you can alleviate this a little bit, because work is being done. You can also set a clear deadline for the team to move on to prototyping. This doesn't mean you're doing waterfall; the problems you come across when you start prototyping can always be used to refine your user stories.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s return to our design team. They write one more user story:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to access a document from different devices.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        The picture begins to emerge that actually, they might be better off with a browser-based application than a desktop application. “In the cloud,” as the kids say. Collaboration seems to be important to their users, and it solves many other problems that they have as well.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And yet, by arguing over whether or not to have a pop-up they were slowly solidifying the implicit assumption that they were building a desktop application. The argument over two solutions was not only forcing them to the wrong choice on this particular solution, it was slowly locking them into a poor choice they had never considered explicitly.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And this is where the business of user stories touches on the problems we have in academia. When an argument arises, in any setting, over competing solutions to a problem, people generally assume that there are only two ways out:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                A weak and feeble comprise that leaves everybody unhappy and feeling unclean.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                A strong, visionary leader comes along who cuts the Gordian knot by picking one of the solutions. Usually the cheapest.
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        These are both dysfunctional, and slightly childish approaches. The better solution is a <strong>synthesis</strong>. Let’s illustrate with user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        We’ll imagine another design team. In this case, they’re building a banking app, so we have both a designer and a security manager on the team. In the unenlightened universe without user stories, the fight that breaks out is over the login. The security manager is in charge of security, so they want all the bells and whistles: two-factor, long passwords, changing the password every week, and so on. The designer is sensitive to the need for security, but they’re in charge of making the app easy and pleasant to use, so they want quick and seamless logins, if any at all. As ever, a fight breaks out and each team-member is prepared to defend their solution like it was their child.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s break this down in user stories. For the designer:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to log in without too much hassle.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        And for the security manager:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want others to access my account.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        Or perhaps:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As the <span style="color:rgb(177,62,38);"><span class="rc">bank manager</span></span>, I don't want our accounts to be insecure.
        </p>
    </blockquote>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>This last one is not from the user's perspective. This is sometimes useful to allow. In most settings there are other </i><em style="font-style:normal;"><i>stakeholders</i></em><i> who have a legitimate claim to see their desires represented. Adding user stories for stakeholders is a good way to make this explicit.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        By drilling down a bit, and discussing the problem without committing to a solution, we might arrive at a more specific user story like
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want others to be able to access the sensitive details in my account, or to be able to transfer money.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This hints at a solution that satisfies both user stories: a <i>synthesis</i>. We can expose certain details without having the user log in. For instance checking their balance. For seeing recent transfers they should log in, and then, whenever they transfer money, we can apply another layer of security, like a two-factor authentication.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        It’s important to note that this isn’t a compromise. A compromise is an average. A compromise would be picking the level of security that is just weak enough that the security manager can stomach it and just enough of a hassle that the designer can stomach it, and then applying that level of security to the whole app.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        A synthesis is something else. It requires going back to the problem and finding another solution that covers all user stories. It requires creativity, intelligence and lateral thinking. And most of all, it requires you to think about exactly what the problem is. This is difficult to do by yourself, but it’s almost impossible to do in a group where everybody has a different background and different ideas about what the product is trying to achieve. Which is why we need tools, like user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I think this particular problem—picking compromise over synthesis—is especially prevalent in academia (or at least science). Moreso than in other domains that haven’t been graced by the divine touch of design thinking. Perhaps this has to do with the substance of our daily activities. In science, we deal in proof. Where there is disagreement about what the truth is, we find the evidence and we argue about it. That is our method, and that is what you’ll see when scientists need to make a decision: they’ll propose a solution and argue its benefits.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What we tend to forget is that when you build something, there is never one best path. There are multiple good solutions, and more importantly, many solutions that haven’t been thought of yet. In order to let those solutions be found, you need a more gentle atmosphere. You need to study the problem without committing to a solution.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I’m not arguing for the use of user stories in scientific life. It’s a good method to try when you find yourself building something concrete like a website, but most of the arguments I’ve witnessed in academic circles aren’t that closely related to building things that user stories would help with.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What I’m trying to get at is the more transferable heart of the user story method. I think it’s three-fold:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Stop arguing in solutions.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Make room to study the problem.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Look for a synthesis.
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        This can be difficult to do. The person arguing most vehemently for their solution is probably the most difficult to convince of a change in mode, and what’s more they’ll usually be a professor, used to being in charge of the rules of engagement. This is a problem with user stories as well: they only work if everybody is on board with using them and if everybody understands how they’re supposed to work.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="prototyping">
        Prototyping
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        So, we have some user stories written, or our problem otherwise mapped out. We’ve spent a bit of time and people are getting nervous that nothing “real” is happening. How do we proceed to something more substantial?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The important thing to realize is that all we’ve done is come up with <i>assumptions</i>. We haven’t tested or validated any of our ideas. We could be totally wrong about what our users want, and we could have missed many of the most important things they want. The simplest way to start testing your assumptions is to start building. Once you’ve built (part of) a website, all you need to do is watch three to five users use it for 30 minutes each and you’ll find all the problems you can handle.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>This is called a hallway user test. No large samples required we're not trying to prove anything here, just finding potential problems.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Even before you test the website on users, the act of building it will confront you with so many details you hadn’t thought about that you’ll inevitably find yourself rethinking most of your ideas.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The problem is that it’s a lot of work to build a website just to find out the problems with it. For that reason we need a way to build it without building it. This is called <strong>prototyping</strong>. In the case of websites and applications, a prototype usually takes the form of a wireframe.
    </p>
</article>
<p>
    <img class="image_resized half" style="aspect-ratio:1648/1648;min-width:150px;width:700px;" src="https://peterbloem.nl/images/design-thinking/wireframe.png" alt="An example of a wireframe." width="1648" height="1648">
</p>
<p>
    <img class="image_resized half" style="aspect-ratio:1200/1200;min-width:150px;width:700px;" src="https://peterbloem.nl/images/design-thinking/mockup.png" alt="An example of a design mockup." width="1200" height="1200">
</p>
<article style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);flex:1 1 auto;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto;orphans:2;padding:0px 0px 6vw;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figure class="wide" style="margin:1em auto;max-width:1400px;padding:0px;">
        <figcaption style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:2em;width:660px;">
            A wireframe (left) and a mockup (right). The mockup is is a detailed, pixel-precise representation of what the website is supposed to look like. The wireframe details only its <i>functionality</i>. The style is purposely rough looking.
        </figcaption>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        A wireframe is a kind of low-fidelity mockup of the structure of a website. It can be hand-drawn, but even when they’re made on a computer, they are often given a kind of handdrawn look (it’s the only place where you might see a designer using Comic Sans).
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Drawing wireframes has several benefits.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It forces people to focus on the functionality</strong> If I show somebody a polished-looking mockup of a website, they will invariably focus on the details. Is that the right shade of blue? Should the photograph on the main page show a sunset, is that sending the right message? These are details that you don’t want to talk about in the early stages of the process. You want to focus on the menu structure. Can people find what they need to find? If the style of the mockup is rough to the point of <span style="font-family:&quot;Comic Sans MS&quot;, &quot;Comic Sans&quot;, serif;"><span class="silly">being silly</span></span>, you can be sure that people won’t be distracted by such details.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It looks discardable.</strong> If you show somebody a polished design, the other thing that might happen is that they will pull their punches. They won’t want to point out problems, because you’ve clearly put so much time into the thing. With the dopey-looking wireframe, there’s no risk of this. You are obviously going to redo this anyway, so they might as well give their opinion.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It creates a two-way conversation.</strong> With a polished design, you show the client or user something they probably couldn’t make themselves. This makes the conversation asymmetric. They can sort of tell you what to change, but in all likelihood they probably don’t even know the right design jargon to express themselves very well. Moreover, the conversation always devolves into the kinds of details that should be up to the designers (and designers don’t like to be micro-managed). With a wireframe, the language is that of crayons and scrap paper. Everyone can have a go. Making wireframes is a much more inclusive process than making design mockups, and nobody needs to be a prima-donna about their precious design being changed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In general, we start with crude wireframes and slowly, step-by-step increase the detail. At every step the project becomes more concrete, and we can start evaluating our chosen solutions against our user stories. What’s more, we start mining further user stories. The more we fill in the details, the clearer the picture of what we’re building becomes.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And, perhaps most importantly, <strong>we can start testing</strong>. You can grab a user and ask them to pretend that the wireframe is a website. You give them a task, and you ask them how they would proceed.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Don't ask them for their opinion on the design. That's a focus group, and they're useless. It's not the user's job to design the website for you. They don't know how to design websites. Ask them what they would do.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        So that’s how it’s done in design land. How much of this transfers to academia? Let’s start with a simple example: designing a lecture. Here’s a picture of one of my early lecture designs.
    </p>
    <figure class="narrow centering" style="margin:0px auto 1em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:330px;">
            <img class="half" style="aspect-ratio:1728/2592;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/images/design-thinking/lecture-planning.jpg" alt="A photograph of a lecture planned out in cardboard cards." width="1728" height="2592">
        </figure>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        Instead of sitting down at the laptop and drawing my slides one by one, I started with a low-fi prototype: hand drawn sketches on bits of cardboard. First crudely drawn, to see if the larger structure made sense, and then slowly more and more detailed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If I had wanted to go the extra mile, I could have grabbed a (proxy) student, and tried the lecture on them at this stage to see if worked for them. I confess that I didn’t. Probably because such testing is more unconventional in academic settings than in design settings. But it’s something we could probably benefit from.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Just remember the difference between asking feedback and testing.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Another example is writing papers. Every supervisor will know the sinking feeling of getting a fully written paper from a student that doesn’t make any sense. Suddenly you realize it’s your job to tell the student how to get from this thing to a working story. It’s difficult enough to write a readable paper, but having to do it by starting from a poorly structured one and outlining all the changes that will turn it into a good one is postively alchemy.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The solution is to work from prototypes. Have the student write an outline. Have them write the introduction of their paper as a series of topic sentences for each paragraph. Give them feedback after they’ve written a few paragraphs. Have them <i>test</i> their writing. Get a fellow student to read it and answer some questions about the text or provide a summary.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Again, the key is to come up with a way to test them instead of asking them for feedback.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        For a final example, consider grant proposal writing. If you’re writing a big grant, it’s risky to do the whole thing in one go. What if your ideas don’t work? What if the writing isn’t convincing? A good tactic is to build up step by step. Start with a student project to collect the literature and do some proof-of-concept experiments. Use these in smaller grants to hire one researcher for a year or two to help work up to the bigger proposal.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The result of these kinds of prototypes is not just that they help you troubleshoot your own ideas, but also that they can make a product feel <i>well-developed</i>. People have a kind of sixth sense for products that were rushed. We may not know how we’re doing it, but we can tell that a paper is a first draft. Going through the motions with wireframes and other prototype can help you build up that level of development, without having to write six complete drafts of the same paper.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="finishing">
        Finishing
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        The final stage of our process is <i>finishing</i>. This is where you finally get to put all the details on. This is the final, slick-looking version of your webdesign, the final version of your paper with all the bells and whistles, or just the actual run of the conference that you’ve organized.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is the most medium-specific part of the process. How you polish up a product depends a lot on what the product is, and most of the skills don’t transfer from one medium to the next. Still, there are a few general principles that commonly apply.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>Form follows function.</strong> Old advice, but still a sound place to start. When in doubt, go back to what you’re trying to achieve. After all the user stories and the prototyping you should have a pretty good idea. Choose the simplest, most direct form that achieves your purpose. Don’t plot your data in a pie chart, when a bar chart suffices, and expresses the goal better.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>Remove unnecessary ink.</strong> This is based on information visualization <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://infovis-wiki.net/wiki/Data-Ink_Ratio">advice by Edward Tufte</a>, but it applies more generally. Our papers, our slides and anything else that we produce is is always filled up with dense notation, complicated diagrams, and imprenetrable jargon. Exactly how to simplify all this is a topic for another post, but here’s one simple rule to start with: if you can remove it and the meaning of the thing doesn’t change, ditch it. This works wonders for formulas, text, plots, and slides.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>God is in the details.</strong> This is a companion to the phrase <i>The devil is in the details</i>, which is probably more familiar to academics. The latter means that the details can trip you up. A paper-sinking bug can hide in one or two characters of code. As a result, we learn to check the details obsessively, out of fear.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <i>God is in the details</i> is its more positive counterpart, which should make this agony more bearable. Sweating the details is not just the way avoid catastrophy, it’s also the way to achieve something special. It’s attention to detail that elevates a thing from passable to great.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Here’s an example from interaction design. In an old credit card form widget. When you click on the CVC field, the credit card icon in the top right shows the reverse of the credit card, marking the place on the back of your card where you can find the CV code.
    </p>
    <figure class="narrow centering" style="margin:0px auto 1em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:660px;">
            <img style="aspect-ratio:1835/778;display:block;margin:0px auto;" src="https://peterbloem.nl/images/design-thinking/credit-card.png" alt="A screenshot of a credit card part of a payment form. It shows the credit card icon flipping over when focus shofts to the CVC field. " width="1835" height="778">
        </figure>
        <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
            I think this comes from an old version of the Apple website, but I've lost the source.
        </figcaption>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        This is a perfect example of attention to detail: it’s helpful, it will delight those who notice, but it was absolutely not necessary. Nobody would have minded or even noticed if this feature had been absent. In a paper, the equivalent would be the extra effort of removing the top and right bar from the frame around your plot, or making sure that the axis labels are in the same typeface as your body text. In a slide deck, it could be making the effort to use a uniform color scheme for all your figures.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If you have a supervisor, they will often steer you away from spending too much time on things like this. To a certain extent, that’s the right thing to do. You can only focus on the details if the big picture is right, and that usually takes up more than enough time. But we should not forget, in our own work or as supervisors, that it’s the details that elevate things.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="giving-feedback">
        Giving feedback
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        There is one more thing in the finishing phase that we can learn from the design world and that is the business of inteligently giving feedback, of <i>critiquing design work</i>. This is not troubleshooting a prototype, but taking something that’s <i>finished</i>, that is the end of a long and arduous journey, and providing feedback on it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is a different business than being in the room during the design process. When you’re brought in at the end and you get to see only the final product, you need to be <i>extremely</i> careful about what you do and do not focus on. The designers you are critiquing have been through a process that you’re not aware of. They have been through a hundred blind alleys and juggled a thousand conflicting concerns that you have no idea about. In short, you have to respect their process, and the fact that you’re an outsider to that process.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        That doesn’t mean, however, that there is nothing you can say. To illustrate, here is one of my favorite quotes. It’s by Neil Gaiman, and he’s talking about creative writing, but it really applies to any creative pursuit.
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p style="margin:0px auto 1em;width:660px;">
            Remember: when people tell you something's wrong or doesn't work for them, they are almost always right.
        </p>
        <p style="margin:0px auto 1em;width:660px;">
            When they tell you exactly what they think is wrong and how to fix it, they are almost always wrong.
        </p>
        <p style="margin:0px auto 1em;width:660px;">
            —Neil Gaiman
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        I’ve talked a bit, in the previous section, about how to test rather than ask for feedback. It’s much more important to observe your users using your product than it is to ask them what they think. Making something, designing it, takes skill. The user, more often than not, doesn’t have that skill, and so they will have no idea how to change the thing to make it better. That’s your job.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What they can do, however, is tell you whether it works or not. They’re the user, it’s their experience that counts, and if it sucks, it’s not for you to say it doesn’t. It’s not for <i>them</i> to say how you should improve it, but you do have to improve it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In an ideal world, this would be the universally understood contract between those giving feedback and those receiving it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Consider the business of getting reviews. How often have you sent a paper to a journal, received a blistering review, done everything the reviewer asked and still been rejected? It’s because feedback can’t work like this. The reviewer doesn’t have the full picture. They don’t know everything you tried that didn’t work. They don’t have your motivation and your larger research agenda.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If your paper stinks, there is nobody that can give you a step-by-step roadmap for fixing it. You’re the only one that understands the thing well enough to know how to take it apart and put it back together again. The reviewer can only point to parts of it and say that they’re wrong. Maybe, because they’re not entirely unskilled themselves, they can give some hints as to what might work, but ideally, these should always be taken as <i>suggestions</i>, and as secondary to the main point: something is off.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I’m not sure that this would entirely take the sting out of the whole reviewing process. I suspect it’s just one of many problems with the whole business. But it would at least make the contract a more healthy one: the reviewer’s job is to point to potential problems, and the author’s job is to find ways to fix them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In general, this is good to keep in mind when giving feedback on anything that someone has made, when you weren’t part of making it. You have to respect the author’s process. They own the thing they made, and they made it in a way that made sense to them. If you are brought in at the end, respect that they’ve been through every aspect of its construction back and forth. They are the experts, and they will have struggled with problems that you have no idea about.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>There are other tips for giving feedback like starting and ending with some compliments, the proverbial "shit sandwich", but in general this can quickly start to feel hollow. When you give someone a shit sandwich, they rarely focus on the bread. I think the more honest alternative is just to respect people's ownership of the product, and to limit your feedback to your experience of it.</i>
        </p>
    </aside>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="why-are-we-so-bad-at-this">
        Why are we so bad at this?
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        That’s design thinking. None of this is new. I started learning this stuff twenty years ago, and every designer I talked to when I started teaching it, agreed on these same basic principles I have spelled out above.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        So why then, is all of this stuff still so alien to so many scientists? Why do so many of our decisions devolve into in-fighting and slinging back-and-forth of arguments? As I noted before, I suspect it’s partly to do with the fact that science itself is usually structured as an argument. However, I don’t think this naturally forces people to be argumentative beyond the remit of science. Most people I’ve met in academia are naturally conflict-averse, and generally take quite well to more of a design-thinking approach to building things.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I also don’t want it to sound like my work environment is some kind of toxic mess. Everybody I work with is very nice, and even the most solution-focused arguments are always very polite. The issue is more that the habit of design thinking and collaboration is not even on the radar of most people in academia. I suspect many of us have never even considered that our production meetings could benefit from tools and structures.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        One part of this problem may be that we’re used to coming up with our own cognitive tools and methods. We’re academics: we’re the ones who come up with the ways in which people think. It’s not an academic instinct to look outside the walls of the university to see how other people solve problems, and what we can learn from them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Perhaps another, sadder part of the equation is that academia draws in people that are argumentative by nature, and rewards them for it. Certainly, the closer you get to the top of the pyramid, the worse people seem to be at reaching an amicable agreements, and finding synthesis. This could be because the stakes are higher, but it could also be that academia rewards those who are good at arguing their corner, rather than those who collaborate well toward a shared solution.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Again, this isn’t necessarily done in a bad spirit, and these are not bad people. It seems to be just a matter of habit and a lack of reflection on our own methods.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I hope this small window on the life of designers can provide some inspiration. Most of these are tips about how to <i>collaborate</i>. It’s easy enough to sprinkle some design thinking on your own work, but for a collaboration to make effective use of it, all people involved need to understand the idea and apply it effectively. That means we suffer from a network effect: the fewer people think this way, the less useful it’s going to be to those that do.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Still, product design eventually managed to leave behind the dark days of the waterfall methods and solution-focused arguments, and to embrace the various principles of design thinking. Perhaps, in time, academia can catch up.
    </p>
</article>
<nav class="title" style="-webkit-text-stroke-width:0px;align-items:center;background-color:rgb(103, 125, 0);color:white;display:flex;flex:0 0 2em;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;justify-content:center;letter-spacing:normal;margin:auto 0px 0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:1897px;word-spacing:0px;">
    <p>
        <a style="border-style:none;bottom:0px;color:white;display:block;font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;height:2em;left:0px;margin-right:0.8em;overflow:hidden;padding:0vh 0px;position:relative;text-align:center;text-decoration:none;text-indent:200%;text-transform:uppercase;white-space:nowrap;width:2em;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/blog/">back</a>
    </p>
    <h1 style="color:rgb(172, 211, 115);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1em;font-weight:normal;line-height:2em;margin:0px;max-height:2em;max-width:80%;overflow:hidden;text-align:center;text-overflow:ellipsis;text-transform:uppercase;white-space:nowrap;">
        What design can teach us
    </h1>
</nav>`,
        tags: ["Tailwind CSS", "CSS", "Design"],
        categories: ["Design", "Frontend"],
        publishedDate: "2024-08-10T09:00:00Z",
        updatedDate: "2024-08-11T15:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "3",
        title: "Mastering JavaScript ES6",
        imgURL: "",
        content: `<nav class="top" style="-webkit-text-stroke-width:0px;color:white;flex:0 0 2em;font-family:Georgia, sans-serif;font-size:0.8em;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:-2px 0px 0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:auto;word-spacing:0px;">
    <ul style="align-items:center;display:flex;flex-direction:row;height:35.1875px;justify-content:flex-start;list-style:none;margin-bottom:0px;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="display:inline;flex:0 0 auto;height:35.1875px;list-style:none;margin-bottom:0px;margin-right:1em;margin-top:0px;padding:0px;width:auto;">
            <p style="margin-left:auto;">
                <a style="border-style:none;color:rgb(153, 153, 153);display:inline;font-family:Georgia, serif;height:100%;line-height:2em;padding:0vh 0px;text-align:center;text-decoration:none;text-transform:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/">home</a>
            </p>
        </li>
        <li style="display:inline;flex:0 0 auto;height:35.1875px;list-style:none;margin-bottom:0px;margin-right:1em;margin-top:0px;padding:0px;width:auto;">
            <p style="margin-left:auto;">
                <a style="border-style:none;color:rgb(153, 153, 153);display:inline;font-family:Georgia, serif;height:100%;line-height:2em;padding:0vh 0px;text-align:center;text-decoration:none;text-transform:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/blog">blog</a>
            </p>
        </li>
    </ul>
</nav>
<article style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);flex:1 1 auto;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto;orphans:2;padding:0px 0px 6vw;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <header style="margin:0px auto 1em;width:660px;">
        <h1 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:3vw auto 2vw;text-align:center;text-transform:uppercase;">
            What design can teach us
        </h1>
    </header>
    <ul class="links" style="display:table;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px 0px 0.3em;width:660px;">
        <li style="display:inline;list-style:none;padding:0px;position:static;">
            <p style="margin-left:auto;text-align:center;">
                16 Apr 2023
            </p>
        </li>
        <li style="display:inline;list-style:none;padding:0px;position:static;">
            <p style="margin-left:auto;text-align:center;">
                <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/files/design-thinking.pdf">slides</a>
            </p>
        </li>
    </ul>
    <figure class="narrow centering vspace" style="margin:2em auto 3em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:330px;">
            <img class="half" style="aspect-ratio:2064/858;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/images/design-thinking/popup.png" alt="A screenshot of a confirmation dialog in Microsoft Word." width="2064" height="858">
        </figure>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        In a previous life I worked for a bit as a designer. I did some graphic design, but my main interest was always <i>interaction</i> design: not so much what things should look like, but how they should function. Which items should you display on the homepage of a website, what should the structure of the menu be, and so.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I left that work behind a long time ago, but it taught me a few important lessons that I still apply every day in my academic life. You might expect that these lessons have to do with building websites, or choosing the layouts for my slides. But they run much deeper than that. They help me run meetings, give feedback and organize courses.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If you’ve never worked with designers before, you’ll be forgiven for thinking of them as a kind of house painters: somebody else builds the house, and they make it look good. It’s an understandable mistake, but it’s also the surest way to piss a designer off. Design is not about how the house looks: it’s about the how and why of the house. If you want to make a designer happy, you don’t give them a finished product to polish up, you put them in the room from day one of the project.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The reason is that every design decision brings you back to the fundamentals. If you want to design a good product, whether it’s a website, or a piece of software, or a research paper, every decision you make about how it should work, how it fits together, is a design decision.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To see what design really looks like in practice, and what lessons we can take from it as academics, let’s start by looking at the structure of a <i>design process</i>.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="the-process">
        The process
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        The first thing a designer will warn you against is what’s called the <i>waterfall model</i>. It’s a name for the idea of a design process that looks like this: first you write a list of requirements, things your product should do, then you make a design for how it’s going to do those things, then the programmers implement the design, verify that it’s doing what the requirements specified, and then your users start using it and you do maintenance to make sure it keeps running.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        That’s waterfall: you plan your process in little blocks, and you start the next block when the previous block is finished.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Waterfall is, as far as I’m concerned, the main reason that all computer and software products were awful throughout the eighties and nineties. It’s falling at the first hurdle of product development. The reason is that you can’t write down your requirements in one go. They’ll be nonsense. You need to figure out what your application needs to do <i>as you build it</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This won’t be news to anybody who has done any software development. It’s a message that was new and radical about 25 years ago. But academia has no problem with being 25 years behind the times in matters like these. So we’ll start with the basics. <i>We don’t do waterfall.</i>
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The alternative is usually captured by the umbrella term <i>agile development</i>. There are many flavors with detailed prescriptions that we don’t need to go into. The key idea is that you don’t design your product in one flash of imagination and then build it, like Mozart writing down the music he heard fully composed in his head. Instead, you build up a <i>concept</i>. Something rough and easy to discard. Like a painter working from a rough sketch to a detailed drawing, to blocking out the light in broad shapes, to finally putting on the highlights.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why is this not waterfall? Because at every step the painter allows herself to <i>go back</i>. Perhaps to the previous step, perhaps to the very beginning. The idea of concepts is to allow yourself to go back to the drawing board when you discover a problem.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This can be nerve-wracking, especially for project managers. With the mindset of waterfall, when you’re at the third stage out of five, you know that you’re halfway. So if you’ve spent half the money, and half the time, you’re perfectly on schedule. The problem is that if a problem crops up with the requirements, you can’t allow your programmers to go back and fix it. So you push on. Your your users get a crappy product, and your developers become miserable because nobody likes building crappy products.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The key to working agile is to allow yourself to go back when you find a problem. Moreover to <i>expect</i> to find problems. Once you’ve accepted that problems will be there, and they will send you back to the drawing board, the game changes. Your goal is no longer to build the perfect thing in one go, terrified all the while that there might be some hidden problem that will force you to start over. The goal is to build something quick and crappy, a <i>prototype</i>: something that will expose the problems with your thinking so that you catch them early, before you’ve invested so much time and energy into building the thing that you can’t bear to chuck it out.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In some areas of academia, this is already how most of us work. When we do experiments, at least in computer science and AI, we start with small-scale proofs-of-concept, and slowly build up.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But not always. How often have you made a slidedeck by starting at the first slide, and moving forward one-by-one, essentially finishing each before starting the next? Have you ever tried sketching out a few different approaches on some scrap paper before moving to the computer to make your slides in detail? Have you ever given yourself 30 minutes to think about the reason why you’re making slides? To consider alternatives like using the whiteboard, or prerecording a video?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        How many project proposals have you seen with perfect Gantt charts of exactly what was going to happen in year one, and how you were going to build on that in year two? And how often had the entire idea of the project changed six months after the starting date?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In all of these areas, design thinking can inspire us. To look at it in more detail, let’s walk through the different stages of a typical design process.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To keep things simple, we’ll break our process up in three phases. <strong>Ideation</strong>, where we decide the details of what we’re going to build and how. <strong>Prototyping</strong>, where we build increasingly detailed versions of our product, and <strong>finishing</strong>, where we put the final touches on.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="ideation">
        Ideation
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        Ideation is where you begin. You’re in a room with a bunch of your collaborators, and you know you’re going to make a thing together, but you have made no decisions yet about how to approach the problem.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is where design starts. What’s more, it’s make-or-break. You can make mistakes in this part of the process that no amount of design prowess will ever allow you to fix. The most important design tools are the ones you apply here.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        To make things concrete, let’s say you’re part of the organisation of a large conference and the job of this group is to design and build the conference website. What’s the first question you need to answer?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        When left to their own devices, people will usually gravitate towards questions like <i>What should the website be built in?</i> or <i>Where should it be hosted?</i> Do we use Wordpress, or Github pages? Do we build it ourselves, pay a professional, or just take some theme off the shelf?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Then, two or three people propose solutions, and start arguing for them. These are usually the most confident, and the loudest people in the group. What’s worse, is that each of them will <i>identify</i> with their chosen solution. This is some kind of strange human defect: once you’ve proposed a solution and argued in its favor, it becomes yours. Maybe you’re mature enough to let go of it eventually, but even when you do, it will feel like a defeat.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why is this? Why can’t we just naturally explore the set of all possible options together and dicuss their pros and cons dispassionately? I don’t know. What I do know, is that there are <i>tools</i> that can bring us closer to this platonic ideal. These are the most important tools in design: not Figma or Photoshop but simple tricks that help you structure a discussion.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s start with the most important one.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="asking-questions-in-the-right-order">
        Asking questions in the right order
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        The first thing our group of conference organizers did wrong was to start with the wrong question. Eventually, you’ll need to figure out where you’ll host your website, but not before you figure out a bunch of other things. More importantly, you need to agree on all those other things and really make sure that you all agree on them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        So, what’s the main question? What’s the first thing you should always ask? For my money, it’s this:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Who is this for?
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                What do they want?
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        These are simple questions, and it may seem childish to ask them explicitly, but a clear picture of who you’re actually building for and what you want to help them achieve is the first step in avoiding those nasty shouting matches. The trick to make this useful is to answer them <i>in detail</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        For instance, who is this conference website for? Well, people who might want to visit the conference, duh. Ok, but what do they want? Well, that depends. When they’re thinking about whether to submit a paper, they’ll want to know what the submission deadline is.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s start there. Ask anybody (in computer science) to think of the last time they looked at a conference website, and what they were looking for. In my experience about 80% will say they were looking for the submission date.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Now go to any conference website, and see how many times you need to click to find the submission date. If you’re lucky, there is a menu item called “dates” which will show it in one click, albeit nestled among many other dates. If you’re unlucky, you’ll need to hunt around, and you’ll eventually find it at the bottom of a long list of submission instructions.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But if it’s so important, why still one click in the best circumstances? Why isn’t it on the front page? Why is there a news item telling me that the website is now online, but not a little table telling me whether this conference has a deadline I can make?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why do we build websites where the bit of information that is most crucial to 80% of visitors is hidden three clicks deep at the bottom of a page? I don’t think it’s cruelty or laziness. It’s just that most of us aren’t trained to take the perspective of the user when we build something. Design thinking is nothing more than a set of tools to help you, and the rest of your collaborators, do just that.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Ok, so academics make crappy websites. Maybe that’s one of those things we just learn to live with, like doctors having poor handwriting or trains being late. Maybe that’s not worth a blog post. And it’s not the point of this one. The point is not how to tell you to make better websites, it’s how to make better <i>anything</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s say you have to give a lecture on statistics. What’s the first question you ask yourself? Whether to use Keynote or Google slides? Whether to use bold notation for vectors? A designer will tell us that the first question is <i>Who is it for?</i> and the second question is <i>What do they want?</i> Who are your students? What do they already know? What can you build on? Then, what do they want? Why do they come to your lecture? Because they feel obliged to? If that’s the case, you’d better snap them out of that attitude, and show them what they can do once they master statistics. If they already want to learn statistics, because it’ll let them do thing X, then you need to figure out what X is, and work from there.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Of course, the answer is usually that you have different types of students who want different things. Your job is to craft one lecture for all of them. That's always the heart of the puzzle.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s have another example. Should your research group have a reading club? This is the sort of thing that is easily done for the wrong reasons (for instance, because all groups have reading clubs). A reading club that is poorly organized can drain people’s time and energy and cost much more than it’s worth. So who’s it for? Just the PhD students, or everybody? Why would they <i>want</i> to go to a reading club? We all struggle to keep up with the literature, so it should be an easy win. And yet, every <i>obligatory</i> reading club that I’ve ever attended has felt as lively as a wake.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        How to make reading clubs work is a topic for another blog post. For now, I just want to make the point that you should ask who you’re doing it for and what they want, before you ask who’s going to organize it, how to bound the topic, and how you’re going to enforce the attendence.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="user-stories-or-how-to-stop-arguing-solutions">
        User stories: or how to stop arguing solutions
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        Building up a clear picture of who your user is and what they want, can take a long time. In professional design settings, it’s a process that can require exhaustive research and evaluation. If you’re not building the next iPhone, however, talking it through for 15 minutes can get you most of the way there.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The main thing that takes time is not so much coming up with a picture of your users—or usally a few different types of users—but making sure that everybody in the team has the same picture in their head. The reason that this is important is that this picture will form the basis of most of your decisions going forward. It will <i>inform your choices</i>.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        For instance, what should we put on the front page: a news feed, or the important dates? Well, let’s think about the users, and what they want. The dates, we’ve already established, are an important reason for a user to visit your site. What about the news feed. Can you <i>really</i> think of a realistic scenario in which a user visits a conference website to see if there’s been any news? There may be a few, but this should then inform which items to put in the news feed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Once you start thinking of these examples, a user coming to your site with a particular aim, you can write them down. This is called a <i>user story</i>. A little description of a particular user and what they want to do. People usually write them according to the template:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a [user of a particular type] I want to do [a thing] so that [a result].
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        You don’t have to follow this pattern, you can be a bit more free and easy with it. But the main rule is that <strong>you don’t write down how your product is going to solve the user’s need</strong>. You just answer the first two questions: who the user is and what they want to do.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I love user stories. I think they’re amazing, and if used correctly they have the potential to change the world. I wish they were taught in high school. If I had to choose whether calculus or user stories were taught in high school I’d prefer them to teach user stories (and I really need my students to know calculus).
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Why am I so in love with this simple little trick? Because it solves the main trap that people fall into when they collaborate on anything. The trap that is behind all design by committee, and perhaps behind all organizational dysfunction: arguing over solutions.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let me give you a simple example.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        A design team is creating a document editor. The client demands that before the user closes the editor, a dialog appears, asking the user to save their documents. The designer disagrees: confirmation dialogs are bad practice. For various reasons, they don’t really work. The designer suggests saving the document automatically, so that the work is never lost.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The client isn’t sure: she may not want to save her changes, she may want to discard them instead, going back to the last save. This could also be achieved by having a version history, argues the designer, this would allow them to auto-save the changes, and still let the user go back to a previous version of her document.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The programmer notes that the confirmation dialog is the easiest option: it will take one line of code, while a version history will require a redesign of the codebase. At that point the battle is lost, the manager chooses the confirmation dialog. It is only a small problem after all.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is what I mean by arguing over solutions: the designer picks one solution, and the programmer another. In the end, money decides. Because, let’s be realistic, if we were perfectionist about every little thing, the product would never get made. We shouldn’t let the perfect be the enemy of the good, right?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s try the same exercise, but this time with proper use of user stories. The client suggests the pop-up dialog, and the product manager asks her instead of suggesting a solution to come up with the user story behind the solution. She thinks a bit, and suggests:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        Good start, says the designer, but we can break that up into two user stories. First there’s
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work, when I close the application.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This is solved, to some extent, by the pop-up dialog warning, although the user could still lose their work if they click the wrong button by accident. It’s solved much better by auto-saving the document.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        But there’s another user story:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want to lose any unsaved work, <span style="color:rgb(177,62,38);"><span class="rc">when the computer crashes</span></span>.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This user story isn’t solved at all by the popup, but it <i>is</i> solved by the auto-save.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        At this point, a good design team wouldn’t make a decision yet on the solution. They might spitball some directions, but they would write down <i>only</i> user stories. Nobody seriously talks solutions yet, and nobody commits to one strategy or another. They just move on to another topic and keep writing user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Here are some other ones that they might come up with
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to go back to previous versions of my document.
        </p>
    </blockquote>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user <span style="color:rgb(177,62,38);"><span class="rc">in a team</span></span>, I want to collaborate on a document with teammates.
        </p>
    </blockquote>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user in a team I want to track what changes others make to a document.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        All of these user stories require a versioning system to solve. Without using user stories, the team quickly locked themselves into not using a versioning system, because it was too expensive to solve one little problem. But they were only looking at one aspect of their application at a time, while every solution you implement affects many different aspects.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is why you need to <strong>hold off on thinking in terms of solutions</strong>. The longer you can spend mapping out the problem without committing to one solution or another, the better placed you’ll be to pick a solution that affects all aspects of your problem positively.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And not just that, the more time your team spends exploring the problem together, the less they are going to fight over solutions. Firstly, because once you have the problem mapped out, it’s much easier to talk about solutions dispassionately, but more importantly, because discussing problems doesn’t invite arguments. User stories never conflict. A user can want to go back to a previous version <i>and</i> not want to lose her work. Two problems can exist side by side and both be important.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        It’s only once we start selecting solutions that we have to close doors. Two solutions can conflict, two problems never will. The longer you put off picking solutions, the more productive your team can be, and the easier it’s going to be to pick solutions when the time comes.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>For many people, this can feel uncomfortable at first. People often feel like so long as there are choices being made, there is progress. By writing user stories you can alleviate this a little bit, because work is being done. You can also set a clear deadline for the team to move on to prototyping. This doesn't mean you're doing waterfall; the problems you come across when you start prototyping can always be used to refine your user stories.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s return to our design team. They write one more user story:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to access a document from different devices.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        The picture begins to emerge that actually, they might be better off with a browser-based application than a desktop application. “In the cloud,” as the kids say. Collaboration seems to be important to their users, and it solves many other problems that they have as well.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And yet, by arguing over whether or not to have a pop-up they were slowly solidifying the implicit assumption that they were building a desktop application. The argument over two solutions was not only forcing them to the wrong choice on this particular solution, it was slowly locking them into a poor choice they had never considered explicitly.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And this is where the business of user stories touches on the problems we have in academia. When an argument arises, in any setting, over competing solutions to a problem, people generally assume that there are only two ways out:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                A weak and feeble comprise that leaves everybody unhappy and feeling unclean.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                A strong, visionary leader comes along who cuts the Gordian knot by picking one of the solutions. Usually the cheapest.
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        These are both dysfunctional, and slightly childish approaches. The better solution is a <strong>synthesis</strong>. Let’s illustrate with user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        We’ll imagine another design team. In this case, they’re building a banking app, so we have both a designer and a security manager on the team. In the unenlightened universe without user stories, the fight that breaks out is over the login. The security manager is in charge of security, so they want all the bells and whistles: two-factor, long passwords, changing the password every week, and so on. The designer is sensitive to the need for security, but they’re in charge of making the app easy and pleasant to use, so they want quick and seamless logins, if any at all. As ever, a fight breaks out and each team-member is prepared to defend their solution like it was their child.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Let’s break this down in user stories. For the designer:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I want to log in without too much hassle.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        And for the security manager:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want others to access my account.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        Or perhaps:
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As the <span style="color:rgb(177,62,38);"><span class="rc">bank manager</span></span>, I don't want our accounts to be insecure.
        </p>
    </blockquote>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>This last one is not from the user's perspective. This is sometimes useful to allow. In most settings there are other </i><em style="font-style:normal;"><i>stakeholders</i></em><i> who have a legitimate claim to see their desires represented. Adding user stories for stakeholders is a good way to make this explicit.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        By drilling down a bit, and discussing the problem without committing to a solution, we might arrive at a more specific user story like
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p>
            As a user, I don't want others to be able to access the sensitive details in my account, or to be able to transfer money.
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        This hints at a solution that satisfies both user stories: a <i>synthesis</i>. We can expose certain details without having the user log in. For instance checking their balance. For seeing recent transfers they should log in, and then, whenever they transfer money, we can apply another layer of security, like a two-factor authentication.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        It’s important to note that this isn’t a compromise. A compromise is an average. A compromise would be picking the level of security that is just weak enough that the security manager can stomach it and just enough of a hassle that the designer can stomach it, and then applying that level of security to the whole app.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        A synthesis is something else. It requires going back to the problem and finding another solution that covers all user stories. It requires creativity, intelligence and lateral thinking. And most of all, it requires you to think about exactly what the problem is. This is difficult to do by yourself, but it’s almost impossible to do in a group where everybody has a different background and different ideas about what the product is trying to achieve. Which is why we need tools, like user stories.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I think this particular problem—picking compromise over synthesis—is especially prevalent in academia (or at least science). Moreso than in other domains that haven’t been graced by the divine touch of design thinking. Perhaps this has to do with the substance of our daily activities. In science, we deal in proof. Where there is disagreement about what the truth is, we find the evidence and we argue about it. That is our method, and that is what you’ll see when scientists need to make a decision: they’ll propose a solution and argue its benefits.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What we tend to forget is that when you build something, there is never one best path. There are multiple good solutions, and more importantly, many solutions that haven’t been thought of yet. In order to let those solutions be found, you need a more gentle atmosphere. You need to study the problem without committing to a solution.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I’m not arguing for the use of user stories in scientific life. It’s a good method to try when you find yourself building something concrete like a website, but most of the arguments I’ve witnessed in academic circles aren’t that closely related to building things that user stories would help with.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What I’m trying to get at is the more transferable heart of the user story method. I think it’s three-fold:
    </p>
    <ul style="list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;padding:0px;width:660px;">
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Stop arguing in solutions.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Make room to study the problem.
            </p>
        </li>
        <li style="list-style:none;padding-left:3em;position:relative;">
            <p style="margin-left:auto;">
                Look for a synthesis.
            </p>
        </li>
    </ul>
    <p style="margin:0px auto 1em;width:660px;">
        This can be difficult to do. The person arguing most vehemently for their solution is probably the most difficult to convince of a change in mode, and what’s more they’ll usually be a professor, used to being in charge of the rules of engagement. This is a problem with user stories as well: they only work if everybody is on board with using them and if everybody understands how they’re supposed to work.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="prototyping">
        Prototyping
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        So, we have some user stories written, or our problem otherwise mapped out. We’ve spent a bit of time and people are getting nervous that nothing “real” is happening. How do we proceed to something more substantial?
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The important thing to realize is that all we’ve done is come up with <i>assumptions</i>. We haven’t tested or validated any of our ideas. We could be totally wrong about what our users want, and we could have missed many of the most important things they want. The simplest way to start testing your assumptions is to start building. Once you’ve built (part of) a website, all you need to do is watch three to five users use it for 30 minutes each and you’ll find all the problems you can handle.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>This is called a hallway user test. No large samples required we're not trying to prove anything here, just finding potential problems.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Even before you test the website on users, the act of building it will confront you with so many details you hadn’t thought about that you’ll inevitably find yourself rethinking most of your ideas.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The problem is that it’s a lot of work to build a website just to find out the problems with it. For that reason we need a way to build it without building it. This is called <strong>prototyping</strong>. In the case of websites and applications, a prototype usually takes the form of a wireframe.
    </p>
</article>
<p>
    <img class="image_resized half" style="aspect-ratio:1648/1648;min-width:150px;width:700px;" src="https://peterbloem.nl/images/design-thinking/wireframe.png" alt="An example of a wireframe." width="1648" height="1648">
</p>
<p>
    <img class="image_resized half" style="aspect-ratio:1200/1200;min-width:150px;width:700px;" src="https://peterbloem.nl/images/design-thinking/mockup.png" alt="An example of a design mockup." width="1200" height="1200">
</p>
<article style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);flex:1 1 auto;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto;orphans:2;padding:0px 0px 6vw;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figure class="wide" style="margin:1em auto;max-width:1400px;padding:0px;">
        <figcaption style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:2em;width:660px;">
            A wireframe (left) and a mockup (right). The mockup is is a detailed, pixel-precise representation of what the website is supposed to look like. The wireframe details only its <i>functionality</i>. The style is purposely rough looking.
        </figcaption>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        A wireframe is a kind of low-fidelity mockup of the structure of a website. It can be hand-drawn, but even when they’re made on a computer, they are often given a kind of handdrawn look (it’s the only place where you might see a designer using Comic Sans).
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Drawing wireframes has several benefits.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It forces people to focus on the functionality</strong> If I show somebody a polished-looking mockup of a website, they will invariably focus on the details. Is that the right shade of blue? Should the photograph on the main page show a sunset, is that sending the right message? These are details that you don’t want to talk about in the early stages of the process. You want to focus on the menu structure. Can people find what they need to find? If the style of the mockup is rough to the point of <span style="font-family:&quot;Comic Sans MS&quot;, &quot;Comic Sans&quot;, serif;"><span class="silly">being silly</span></span>, you can be sure that people won’t be distracted by such details.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It looks discardable.</strong> If you show somebody a polished design, the other thing that might happen is that they will pull their punches. They won’t want to point out problems, because you’ve clearly put so much time into the thing. With the dopey-looking wireframe, there’s no risk of this. You are obviously going to redo this anyway, so they might as well give their opinion.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>It creates a two-way conversation.</strong> With a polished design, you show the client or user something they probably couldn’t make themselves. This makes the conversation asymmetric. They can sort of tell you what to change, but in all likelihood they probably don’t even know the right design jargon to express themselves very well. Moreover, the conversation always devolves into the kinds of details that should be up to the designers (and designers don’t like to be micro-managed). With a wireframe, the language is that of crayons and scrap paper. Everyone can have a go. Making wireframes is a much more inclusive process than making design mockups, and nobody needs to be a prima-donna about their precious design being changed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In general, we start with crude wireframes and slowly, step-by-step increase the detail. At every step the project becomes more concrete, and we can start evaluating our chosen solutions against our user stories. What’s more, we start mining further user stories. The more we fill in the details, the clearer the picture of what we’re building becomes.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        And, perhaps most importantly, <strong>we can start testing</strong>. You can grab a user and ask them to pretend that the wireframe is a website. You give them a task, and you ask them how they would proceed.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Don't ask them for their opinion on the design. That's a focus group, and they're useless. It's not the user's job to design the website for you. They don't know how to design websites. Ask them what they would do.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        So that’s how it’s done in design land. How much of this transfers to academia? Let’s start with a simple example: designing a lecture. Here’s a picture of one of my early lecture designs.
    </p>
    <figure class="narrow centering" style="margin:0px auto 1em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:330px;">
            <img class="half" style="aspect-ratio:1728/2592;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/images/design-thinking/lecture-planning.jpg" alt="A photograph of a lecture planned out in cardboard cards." width="1728" height="2592">
        </figure>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        Instead of sitting down at the laptop and drawing my slides one by one, I started with a low-fi prototype: hand drawn sketches on bits of cardboard. First crudely drawn, to see if the larger structure made sense, and then slowly more and more detailed.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If I had wanted to go the extra mile, I could have grabbed a (proxy) student, and tried the lecture on them at this stage to see if worked for them. I confess that I didn’t. Probably because such testing is more unconventional in academic settings than in design settings. But it’s something we could probably benefit from.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Just remember the difference between asking feedback and testing.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        Another example is writing papers. Every supervisor will know the sinking feeling of getting a fully written paper from a student that doesn’t make any sense. Suddenly you realize it’s your job to tell the student how to get from this thing to a working story. It’s difficult enough to write a readable paper, but having to do it by starting from a poorly structured one and outlining all the changes that will turn it into a good one is postively alchemy.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The solution is to work from prototypes. Have the student write an outline. Have them write the introduction of their paper as a series of topic sentences for each paragraph. Give them feedback after they’ve written a few paragraphs. Have them <i>test</i> their writing. Get a fellow student to read it and answer some questions about the text or provide a summary.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>Again, the key is to come up with a way to test them instead of asking them for feedback.</i>
        </p>
    </aside>
    <p style="margin:0px auto 1em;width:660px;">
        For a final example, consider grant proposal writing. If you’re writing a big grant, it’s risky to do the whole thing in one go. What if your ideas don’t work? What if the writing isn’t convincing? A good tactic is to build up step by step. Start with a student project to collect the literature and do some proof-of-concept experiments. Use these in smaller grants to hire one researcher for a year or two to help work up to the bigger proposal.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        The result of these kinds of prototypes is not just that they help you troubleshoot your own ideas, but also that they can make a product feel <i>well-developed</i>. People have a kind of sixth sense for products that were rushed. We may not know how we’re doing it, but we can tell that a paper is a first draft. Going through the motions with wireframes and other prototype can help you build up that level of development, without having to write six complete drafts of the same paper.
    </p>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="finishing">
        Finishing
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        The final stage of our process is <i>finishing</i>. This is where you finally get to put all the details on. This is the final, slick-looking version of your webdesign, the final version of your paper with all the bells and whistles, or just the actual run of the conference that you’ve organized.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is the most medium-specific part of the process. How you polish up a product depends a lot on what the product is, and most of the skills don’t transfer from one medium to the next. Still, there are a few general principles that commonly apply.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>Form follows function.</strong> Old advice, but still a sound place to start. When in doubt, go back to what you’re trying to achieve. After all the user stories and the prototyping you should have a pretty good idea. Choose the simplest, most direct form that achieves your purpose. Don’t plot your data in a pie chart, when a bar chart suffices, and expresses the goal better.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>Remove unnecessary ink.</strong> This is based on information visualization <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://infovis-wiki.net/wiki/Data-Ink_Ratio">advice by Edward Tufte</a>, but it applies more generally. Our papers, our slides and anything else that we produce is is always filled up with dense notation, complicated diagrams, and imprenetrable jargon. Exactly how to simplify all this is a topic for another post, but here’s one simple rule to start with: if you can remove it and the meaning of the thing doesn’t change, ditch it. This works wonders for formulas, text, plots, and slides.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <strong>God is in the details.</strong> This is a companion to the phrase <i>The devil is in the details</i>, which is probably more familiar to academics. The latter means that the details can trip you up. A paper-sinking bug can hide in one or two characters of code. As a result, we learn to check the details obsessively, out of fear.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        <i>God is in the details</i> is its more positive counterpart, which should make this agony more bearable. Sweating the details is not just the way avoid catastrophy, it’s also the way to achieve something special. It’s attention to detail that elevates a thing from passable to great.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Here’s an example from interaction design. In an old credit card form widget. When you click on the CVC field, the credit card icon in the top right shows the reverse of the credit card, marking the place on the back of your card where you can find the CV code.
    </p>
    <figure class="narrow centering" style="margin:0px auto 1em;padding:0px;width:660px;">
        <figure class="image image_resized" style="width:660px;">
            <img style="aspect-ratio:1835/778;display:block;margin:0px auto;" src="https://peterbloem.nl/images/design-thinking/credit-card.png" alt="A screenshot of a credit card part of a payment form. It shows the credit card icon flipping over when focus shofts to the CVC field. " width="1835" height="778">
        </figure>
        <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
            I think this comes from an old version of the Apple website, but I've lost the source.
        </figcaption>
    </figure>
    <p style="margin:0px auto 1em;width:660px;">
        This is a perfect example of attention to detail: it’s helpful, it will delight those who notice, but it was absolutely not necessary. Nobody would have minded or even noticed if this feature had been absent. In a paper, the equivalent would be the extra effort of removing the top and right bar from the frame around your plot, or making sure that the axis labels are in the same typeface as your body text. In a slide deck, it could be making the effort to use a uniform color scheme for all your figures.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If you have a supervisor, they will often steer you away from spending too much time on things like this. To a certain extent, that’s the right thing to do. You can only focus on the details if the big picture is right, and that usually takes up more than enough time. But we should not forget, in our own work or as supervisors, that it’s the details that elevate things.
    </p>
    <h3 style="margin:0px auto 1em;width:660px;" id="giving-feedback">
        Giving feedback
    </h3>
    <p style="margin:0px auto 1em;width:660px;">
        There is one more thing in the finishing phase that we can learn from the design world and that is the business of inteligently giving feedback, of <i>critiquing design work</i>. This is not troubleshooting a prototype, but taking something that’s <i>finished</i>, that is the end of a long and arduous journey, and providing feedback on it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        This is a different business than being in the room during the design process. When you’re brought in at the end and you get to see only the final product, you need to be <i>extremely</i> careful about what you do and do not focus on. The designers you are critiquing have been through a process that you’re not aware of. They have been through a hundred blind alleys and juggled a thousand conflicting concerns that you have no idea about. In short, you have to respect their process, and the fact that you’re an outsider to that process.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        That doesn’t mean, however, that there is nothing you can say. To illustrate, here is one of my favorite quotes. It’s by Neil Gaiman, and he’s talking about creative writing, but it really applies to any creative pursuit.
    </p>
    <blockquote style="font-family:GillSansMTStd-Medium, Helvetica, sans-serif;margin:0px auto 1em;padding:0px 0px 0px 4em;width:660px;">
        <p style="margin:0px auto 1em;width:660px;">
            Remember: when people tell you something's wrong or doesn't work for them, they are almost always right.
        </p>
        <p style="margin:0px auto 1em;width:660px;">
            When they tell you exactly what they think is wrong and how to fix it, they are almost always wrong.
        </p>
        <p style="margin:0px auto 1em;width:660px;">
            —Neil Gaiman
        </p>
    </blockquote>
    <p style="margin:0px auto 1em;width:660px;">
        I’ve talked a bit, in the previous section, about how to test rather than ask for feedback. It’s much more important to observe your users using your product than it is to ask them what they think. Making something, designing it, takes skill. The user, more often than not, doesn’t have that skill, and so they will have no idea how to change the thing to make it better. That’s your job.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        What they can do, however, is tell you whether it works or not. They’re the user, it’s their experience that counts, and if it sucks, it’s not for you to say it doesn’t. It’s not for <i>them</i> to say how you should improve it, but you do have to improve it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In an ideal world, this would be the universally understood contract between those giving feedback and those receiving it.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Consider the business of getting reviews. How often have you sent a paper to a journal, received a blistering review, done everything the reviewer asked and still been rejected? It’s because feedback can’t work like this. The reviewer doesn’t have the full picture. They don’t know everything you tried that didn’t work. They don’t have your motivation and your larger research agenda.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        If your paper stinks, there is nobody that can give you a step-by-step roadmap for fixing it. You’re the only one that understands the thing well enough to know how to take it apart and put it back together again. The reviewer can only point to parts of it and say that they’re wrong. Maybe, because they’re not entirely unskilled themselves, they can give some hints as to what might work, but ideally, these should always be taken as <i>suggestions</i>, and as secondary to the main point: something is off.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I’m not sure that this would entirely take the sting out of the whole reviewing process. I suspect it’s just one of many problems with the whole business. But it would at least make the contract a more healthy one: the reviewer’s job is to point to potential problems, and the author’s job is to find ways to fix them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        In general, this is good to keep in mind when giving feedback on anything that someone has made, when you weren’t part of making it. You have to respect the author’s process. They own the thing they made, and they made it in a way that made sense to them. If you are brought in at the end, respect that they’ve been through every aspect of its construction back and forth. They are the experts, and they will have struggled with problems that you have no idea about.
    </p>
    <aside style="font-size:0.92em;line-height:1.875em;margin:0px auto 1em;padding-left:4em;width:660px;">
        <p>
            <i>There are other tips for giving feedback like starting and ending with some compliments, the proverbial "shit sandwich", but in general this can quickly start to feel hollow. When you give someone a shit sandwich, they rarely focus on the bread. I think the more honest alternative is just to respect people's ownership of the product, and to limit your feedback to your experience of it.</i>
        </p>
    </aside>
    <h2 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:6vw auto 2vw;text-align:center;width:660px;" id="why-are-we-so-bad-at-this">
        Why are we so bad at this?
    </h2>
    <p style="margin:0px auto 1em;width:660px;">
        That’s design thinking. None of this is new. I started learning this stuff twenty years ago, and every designer I talked to when I started teaching it, agreed on these same basic principles I have spelled out above.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        So why then, is all of this stuff still so alien to so many scientists? Why do so many of our decisions devolve into in-fighting and slinging back-and-forth of arguments? As I noted before, I suspect it’s partly to do with the fact that science itself is usually structured as an argument. However, I don’t think this naturally forces people to be argumentative beyond the remit of science. Most people I’ve met in academia are naturally conflict-averse, and generally take quite well to more of a design-thinking approach to building things.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I also don’t want it to sound like my work environment is some kind of toxic mess. Everybody I work with is very nice, and even the most solution-focused arguments are always very polite. The issue is more that the habit of design thinking and collaboration is not even on the radar of most people in academia. I suspect many of us have never even considered that our production meetings could benefit from tools and structures.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        One part of this problem may be that we’re used to coming up with our own cognitive tools and methods. We’re academics: we’re the ones who come up with the ways in which people think. It’s not an academic instinct to look outside the walls of the university to see how other people solve problems, and what we can learn from them.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Perhaps another, sadder part of the equation is that academia draws in people that are argumentative by nature, and rewards them for it. Certainly, the closer you get to the top of the pyramid, the worse people seem to be at reaching an amicable agreements, and finding synthesis. This could be because the stakes are higher, but it could also be that academia rewards those who are good at arguing their corner, rather than those who collaborate well toward a shared solution.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Again, this isn’t necessarily done in a bad spirit, and these are not bad people. It seems to be just a matter of habit and a lack of reflection on our own methods.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        I hope this small window on the life of designers can provide some inspiration. Most of these are tips about how to <i>collaborate</i>. It’s easy enough to sprinkle some design thinking on your own work, but for a collaboration to make effective use of it, all people involved need to understand the idea and apply it effectively. That means we suffer from a network effect: the fewer people think this way, the less useful it’s going to be to those that do.
    </p>
    <p style="margin:0px auto 1em;width:660px;">
        Still, product design eventually managed to leave behind the dark days of the waterfall methods and solution-focused arguments, and to embrace the various principles of design thinking. Perhaps, in time, academia can catch up.
    </p>
</article>
<nav class="title" style="-webkit-text-stroke-width:0px;align-items:center;background-color:rgb(103, 125, 0);color:white;display:flex;flex:0 0 2em;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;justify-content:center;letter-spacing:normal;margin:auto 0px 0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:1897px;word-spacing:0px;">
    <p>
        <a style="border-style:none;bottom:0px;color:white;display:block;font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;height:2em;left:0px;margin-right:0.8em;overflow:hidden;padding:0vh 0px;position:relative;text-align:center;text-decoration:none;text-indent:200%;text-transform:uppercase;white-space:nowrap;width:2em;" target="_blank" rel="noopener noreferrer" href="https://peterbloem.nl/blog/">back</a>
    </p>
    <h1 style="color:rgb(172, 211, 115);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1em;font-weight:normal;line-height:2em;margin:0px;max-height:2em;max-width:80%;overflow:hidden;text-align:center;text-overflow:ellipsis;text-transform:uppercase;white-space:nowrap;">
        What design can teach us
    </h1>
</nav>`,
        tags: ["JavaScript", "ES6", "Programming"],
        categories: ["Development", "Web"],
        publishedDate: "2024-07-15T08:00:00Z",
        updatedDate: "2024-07-16T09:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "4",
        title: "Getting Started with Node.js",
        imgURL: "",
        content: `<header style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <h1 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:3vw auto 2vw;text-align:center;text-transform:uppercase;">
        Transformers from scratch
    </h1>
</header>
<ul class="links" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:table;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px 0px 0.3em;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            18 Aug 2019
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former">code on github</a>
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/playlist?list=PLIXJ-Sacf8u60G1TwcznBmK6rEL3gmZmV">video lecture</a>
        </p>
    </li>
</ul>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Transformers are a very exciting family of machine learning architectures. Many good tutorials exist (e.g. [1, 2]) but in the last few years, transformers have mostly become simpler, so that it is now much more straightforward to explain how modern architectures work. This post is an attempt to explain directly how modern transformers work, and why, without some of the historical baggage.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    I will assume a basic understanding of neural networks and backpropagation. If you’d like to brush up, <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture06/">this lecture</a> will give you the basics of neural networks and <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/">this one</a> will explain how these principles are applied in modern deep learning systems.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html">working knowledge of Pytorch</a> is required to understand the programming examples, but these can also be safely skipped.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="self-attention">
    Self-attention
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The fundamental operation of any transformer architecture is the <i>self-attention operation</i>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>We'll explain where the name "self-attention" comes from later. For now, don't read too much in to it.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Self-attention is a sequence-to-sequence operation: a sequence of vectors goes in, and a sequence of vectors comes out. Let’s call the input vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-1-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.694em;" id="MathJax-Span-1"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.121em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.12em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-2"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-3"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-4"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-5"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-6">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-7">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-8">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-9"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-10"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-11"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-12">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-13">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-14">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-15">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-16">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-17"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-18"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-19"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-20">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-21">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and the corresponding output vectors <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-2-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.104em;" id="MathJax-Span-22"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.489em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.49em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-23"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-24"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-25"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-26"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-27">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-28">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-29">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-30"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-31"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-32"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-33">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-34">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-35">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-36">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-37">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-38"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-39"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-40"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-41">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-42">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>. The vectors all have dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-3-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-43"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-44"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-45">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To produce output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-4-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-46"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-47"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-48"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-49"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-50"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-51">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-52"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-53"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-54"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-55"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-56">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>, the self attention operation simply takes <i>a weighted average over all the input vectors</i>
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-5-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:7.25em;" id="MathJax-Span-57"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.513em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.067em, 1006.51em, 3.606em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-58"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-59"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-60"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-61"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-62">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-63"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-64"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-65"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-66"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-67">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-68">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-69"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-70">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-71"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-72"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-73"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-74"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-75"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-76"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-77">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-78"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-79">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-80"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-81"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-82"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-83"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-84"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-85"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-86">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-87"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-88"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-89"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-90"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-91">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-92"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-93"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-94"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-95">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-96"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-97"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-98"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-99"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-100">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-101"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-102"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.543em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-6-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-103"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-104"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-109">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> indexes over the whole sequence and the weights sum to one over all <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-7-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-110"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-111"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-112"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-113"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-114"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-115"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-116">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. The weight&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-8-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-117"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1001.39em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-118"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-119"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-120">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-121"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-122"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-123"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-124"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-125"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-126"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-127">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-132">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span> is not a parameter, as in a normal neural net, but it is <i>derived</i> from a function over&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-9-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-133"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-134"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-135"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-136"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-137"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-138">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-139"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-140"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-141"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-142"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-143">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-10-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-145"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-146"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-147"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-149">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-150"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-151"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-152"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-153"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-154">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.002em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. The simplest option for this function is the dot product:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-11-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.858em;" id="MathJax-Span-155"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.285em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1005.28em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-156"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-158">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-159">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-160"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-161"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-162"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-163"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-164"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-165"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-166">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-167"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-168"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-169"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-170"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-171">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-172">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-173"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-174"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-175"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-177"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-178"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-179">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-180"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-181"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-182"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-183"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-184">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.862em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-185">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-187"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-188"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-189">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-190"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-191"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-192"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-193"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-194">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-195"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-196"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Note that&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-12-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;" id="MathJax-Span-197"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.89em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-198"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-200"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-201"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-202">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.537em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-203"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-204"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-205"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-206"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-207">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i> is the input vector at the same position as the current output vector </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-13-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.115em;" id="MathJax-Span-208"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.98em, 2.54em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-209"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-210"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.366em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-211"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-212"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-213">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.67em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.738em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-214"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-215"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-216"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-217"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-218">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.942em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.343em;width:0px;"></span></span></nobr></span></i></span><i>. For the next output vector, we get an entirely new series of dot products, and a different weighted sum.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The dot product gives us a value anywhere between negative and positive infinity, so we apply a softmax to map the values to&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-14-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-219"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.89em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-220"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-221">[</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-222">0</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-223">,</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-224">1</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-225">]</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and to ensure that they sum to 1 over the whole sequence:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-15-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:8.888em;" id="MathJax-Span-226"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.166em, 1007.99em, 3.565em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-227"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-228"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-229">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-230"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-231"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-232"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-233"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-234"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-235"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-236">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-237"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-238"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-239"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-240"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-241">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-242">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-243"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.67em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.03em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -1.513em;padding:0px;position:absolute;text-decoration:none;top:-4.953em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-244"><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-245"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-246"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-247">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-248">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-249"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-250"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-251"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-252"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-253"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-254"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-255">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-256"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-257"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-258"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-259"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-260">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1004.55em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -2.25em;padding:0px;position:absolute;text-decoration:none;top:-3.151em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-261"><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-262"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.155em, 1000.99em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Operators;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.203em;" id="MathJax-Span-263">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.067em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-265"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-266"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-267"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-268">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-269"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-270"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-271">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-272">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-273"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-274"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-275"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-276"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-277"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-278"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-279">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-280"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-281"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-282"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-283"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-284">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1004.67em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:4.67em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-285"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-286"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:3.593em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.498em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And that’s the basic operation of self attention.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1092/697;width:660px;" src="https://peterbloem.nl/files/transformers/self-attention.svg" width="1092" height="697">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        A visual illustration of basic self-attention. Note that the softmax operation over the <span style="color:rgb(177,62,38);"><span class="rc">weights</span></span> is not illustrated.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A few other ingredients are needed for a complete transformer, which we’ll discuss later, but this is the fundamental operation. More importantly, this is the only operation in the whole architecture that propagates information <i>between</i> vectors. Every other operation in the transformer is applied to each vector in the input sequence without interactions between vectors.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="understanding-why-self-attention-works">
    Understanding why self-attention works
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Despite its simplicity, it’s not immediately obvious why self-attention should work so well. To build up some intuition, let’s look first at the standard approach to <i>movie recommendation</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Let’s say you run a movie rental business and you have some movies, and some users, and you would like to recommend movies to your users that they are likely to enjoy.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    One way to go about this, is to create manual features for your movies, such as how much romance there is in the movie, and how much action, and then to design corresponding features for your users: how much they enjoy romantic movies and how much they enjoy action-based movies. If you did this, the dot product between the two feature vectors would give you a score for how well the attributes of the movie match what the user enjoys.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1011/410;width:660px;" src="https://peterbloem.nl/files/transformers/dot-product.svg" width="1011" height="410">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If the signs of a feature match for the user and the movie—the movie is romantic and the user loves romance or the movie is <i>unromantic</i> and the user hates romance—then the resulting dot product gets a positive term for that feature. If the signs don’t match—the movie is romantic and the user hates romance or vice versa—the corresponding term is negative.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Furthermore, the <i>magnitudes</i> of the features indicate how much the feature should contribute to the total score: a movie may be a little romantic, but not in a noticeable way, or a user may simply prefer no romance, but be largely ambivalent.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Of course, gathering such features is not practical. Annotating a database of millions of movies is very costly, and annotating users with their likes and dislikes is pretty much impossible.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What happens instead is that we make the movie features and user features <i>parameters</i> of the model. We then ask users for a small number of movies that they like and we optimize the user features and movie features so that their dot product matches the known likes.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Even though we don’t tell the model what any of the features should mean, in practice, it turns out that after training the features do actually reflect meaningful semantics about the movie content.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:431/333;width:660px;" src="https://peterbloem.nl/files/transformers/movie-features.svg" width="431" height="333">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        The first two learned features from a basic matrix factorization model. The model had no access to any information about the content of the movies, only which users liked them. Note that movies are arranged from low-brow to high-brow horizontally, and from mainstream to quirky vertically. From [4].
    </figcaption>
</figure>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture12/"><i>this lecture</i></a><i> for more details on recommender systems. For now, this suffices as an explanation of how the dot product helps us to represent objects and their relations.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic principle at work in the self-attention. Let’s say we are faced with a sequence of words. To apply self-attention, we simply assign each word&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-16-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-287"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-288"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-289"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-290"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-291"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-292"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-293">t</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> in our vocabulary an <i>embedding vector</i>&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-17-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-295"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-296"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-297"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-299">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-300"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-301"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-302"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-303"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-304">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> (the values of which we’ll learn). This is what’s known as an <i>embedding layer</i> in sequence modeling. It turns the word sequence&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-18-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:12.697em;" id="MathJax-Span-305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:11.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1011.43em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-306"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-307"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-308"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-309"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-310"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-311"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-312">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-313"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-314"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-315"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-316"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-317"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-318">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-319"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-320"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-321"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-322"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-323"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-324">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-325"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-326"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-327"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-328"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-329"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-330">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-331"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-332"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-333"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-334"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-335"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-336">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-337"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-338"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-339"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-340"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-341"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> into the vector sequence
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-19-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.294em;" id="MathJax-Span-342"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:12.86em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1012.86em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-343"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-344"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-345"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-346"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-347">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-348"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-349"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-350"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-351"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-352"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-353">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-354"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-355"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-356"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-357">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-358"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-359"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-360"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-361"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-362"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-363">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-364"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-365"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-366"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-367">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-368"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-369"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-370"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-371"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-372"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-373">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-374"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-375"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-376"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-377">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-378"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-379"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-380"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-381"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-382"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-383">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-384"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-385"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-386"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-387">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-388"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-389"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-390"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-391"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-392"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-393">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-394"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-395"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-396"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-397">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-398"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-399"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-400"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-401"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-402"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-403"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-404"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If we feed this sequence into a self-attention layer, the output is another sequence of vectors
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-20-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.662em;" id="MathJax-Span-405"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:13.188em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1013.19em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-406"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-407"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-408"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-409"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-410">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-411"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-412"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-413"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-414"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-415"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-416">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-417"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-418"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-419"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-420">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-421"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-422"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-423"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-424"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-425"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-426">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-427"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-428"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-429"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-430">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-431"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-432"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-433"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-434"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-435"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-436">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-437"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-438"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-439"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-440">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-441"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-442"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-443"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-444"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-445"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-446">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-447"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-448"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-449"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-450">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-451"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-452"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-453"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-454"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-455"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-456">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-457"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-458"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-459"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-460">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-461"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-462"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-463"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-464"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-465"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-21-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-466"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.56em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-467"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-468"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-469"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-470"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-471">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-472"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-473"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-474"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-475"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-476"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> is a weighted sum over all the embedding vectors in the first sequence, weighted by their (normalized) dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-22-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-477"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-478"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-479"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-480"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-481"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-482">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-483"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-484"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-485"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-486"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-487"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>.
</p>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we are <i>learning</i> what the values in&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-23-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-488"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-489"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-490"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-491"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-492"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-493">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-494"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-495"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-496"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-497"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-498">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> should be, how "related" two words are is entirely determined by the task. In most cases, the definite article <span style="color:rgb(48,102,147);"><span class="bc">the</span></span> is not very relevant to the interpretation of the other words in the sentence; therefore, we will likely end up with an embedding&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-24-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;" id="MathJax-Span-499"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.52em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-500"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-501"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-502"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-503"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-504">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-505"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-506"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-507"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-508"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-509"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that has a low or negative dot product with all other words. On the other hand, to interpret what <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span> means in this sentence, it's very helpful to work out <i>who</i> is doing the walking. This is likely expressed by a noun, so for nouns like <span style="color:rgb(48,102,147);"><span class="bc">cat</span></span> and verbs like <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span>, we will likely learn embeddings&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-25-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-510"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-511"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-512"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-513"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-514"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-515">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-516"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-517"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-518"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-519"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-520"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-26-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-521"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-522"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-523"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-524"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-525"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-526">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-527"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-528"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-529"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-530"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-531"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that have a high, positive dot product together.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic intuition behind self-attention. The dot product expresses how related two vectors in the input sequence are, with “related” defined by the learning task, and the output vectors are weighted sums over the whole input sequence, with the weights determined by these dot products.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before we move on, it’s worthwhile to note the following properties, which are unusual for a sequence-to-sequence operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            There are no parameters (yet). What the basic self-attention actually does is entirely determined by whatever mechanism creates the input sequence. Upstream mechanisms, like an embedding layer, drive the self-attention by learning representations with particular dot products (although we’ll add a few parameters later).
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            Self attention sees its input as a <i>set</i>, not a sequence. If we permute the input sequence, the output sequence will be exactly the same, except permuted also (i.e. self-attention is <i>permutation equivariant</i>). We will mitigate this somewhat when we build the full transformer, but the self-attention by itself actually <i>ignores</i> the sequential nature of the input.
        </p>
    </li>
</ul>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-basic-self-attention">
    In Pytorch: basic self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What I cannot create, I do not understand, as Feynman said. So we’ll build a simple transformer as we go along. We’ll start by implementing this basic self-attention operation in Pytorch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first thing we should do is work out how to express the self attention in matrix multiplications. A naive implementation that loops over all vectors to compute the weights and outputs would be much too slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ll represent the input, a sequence of&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-27-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-532"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-533"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-534">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> vectors of dimension&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-28-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-535"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-536"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-537">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> as a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-29-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-538"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-539"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-540">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-30-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-541"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-542"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-543">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-31-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-544"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-545"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-546"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-547"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-548">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. Including a minibatch dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-32-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-549"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.49em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-550"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-551">b</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, gives us an input tensor of size <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-33-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.606em;" id="MathJax-Span-552"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.237em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1003.11em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-553"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-554">(</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-555">b</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-556">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-557">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-558">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-559">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-560">)</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The set of all raw dot products&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-34-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-561"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-562"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-563"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-564">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-565">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-566"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-567"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-568"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-569"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-570"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-571"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-572">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-573"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-574"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-575"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-576"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-577">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> forms a matrix, which we can compute simply by multiplying&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-35-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-578"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-579"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-580"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-581"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-582">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by its transpose:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs makefile" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
import torch.nn.functional as F
# assume we have some tensor x with size (b, t, k)
x = ...
raw_weights = torch.bmm(x, x.transpose(1, 2))
# - torch.bmm is a batched matrix multiplication. It
#   applies matrix multiplication over batches of
#   matrices.</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Then, to turn the raw weights&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-36-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-583"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-584"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-585"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-586">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-587">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-588"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-589"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-590"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-591"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-592"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-593"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-594">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-595"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-596"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-597"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-598"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-599">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> into positive values that sum to one, we apply a <i>row-wise</i> softmax:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">weights = F.softmax(raw_weights, dim=2)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, to compute the output sequence, we just multiply the weight matrix by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-37-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-600"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-601"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-602"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-603"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-604">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. This results in a batch of output matrices&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-38-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-605"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-606"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-607"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-608"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-609">𝐘<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.084em;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> of size <code style="font-family:Consolas, monospace;font-size:0.8em;">(b, t, k)</code> whose rows are weighted sums over the rows of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-39-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-610"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-611"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-612"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-613"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-614">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">y = torch.bmm(weights, x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
That’s all. Two matrix multiplications and one softmax gives us a basic self-attention.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="additional-tricks">
Additional tricks
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The actual self-attention used in modern transformers relies on three additional tricks.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="1-queries-keys-and-values">
1) Queries, keys and values
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Every input vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-40-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-615"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-616"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-617"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-618"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-619"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-620">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-621"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-622"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-623"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-624"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-625">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> is used in three different ways in the self attention operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for its own output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-41-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-626"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-627"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-628"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-629"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-630"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-631">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-632"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-633"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-634"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-635"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-636">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for the output of the <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-42-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-637"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-638"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-639"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-640"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-641"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-642"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-643">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>-th vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-43-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-644"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.664em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-645"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-646"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-647"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-648"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-649">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-650"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-651"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-652"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-653"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-654">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.543em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is used as part of the weighted sum to compute each output vector once the weights have been established.
        </p>
    </li>
</ul>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
These roles are often called the <strong>query</strong>, the <strong>key</strong> and the <strong>value</strong> (we'll explain where these names come from later). In the basic self-attention we've seen so far, each input vector must play all three roles. We make its life a little easier by deriving new vectors for each role, by applying a linear transformation to the original input vector. In other words, we add three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-44-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-655"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-656"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-657">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-658">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-659">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> weight matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-45-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-660"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.64em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-661"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-662"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-663"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-664"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-665">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-666">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-46-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.804em;" id="MathJax-Span-667"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.6em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-668"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-669"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-670"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-671"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-672">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-673">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-47-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-674"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.56em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-675"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-676"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-677"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-678"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-679">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-680">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and compute three linear transformations of each <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-48-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-681"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-682"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-683"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-684">x</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-685"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-686"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-687"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-688"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-689">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>, for the three different parts of the self attention:
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-49-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:20.149em;" id="MathJax-Span-690"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:18.143em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1018.14em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-691"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-692"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:17.815em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-693"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-694"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-695"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-696"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-697"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-698">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-699"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-700"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-701"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-702"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-703">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.769em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-704"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-705"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-706"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-707">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-708"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-709"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-710"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-711">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-712">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-713"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-714"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-715"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-716">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-717"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-718"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-719"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-720"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-721">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;left:6.677em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-722"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-723"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-724"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-725"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-726"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-727">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-728"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-729"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-730"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-731"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-732">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:7.619em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.729em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-733"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-734"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-735"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-736">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-737"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-738"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-739"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-740">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-741">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-742"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-743"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-744"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-745">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-746"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-747"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-748"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-749"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-750">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:13.27em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-751"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-752"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-753"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-754"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-755"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-756">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-757"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-758"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-759"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-760"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-761">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:14.13em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-762"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-763"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-764"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-765">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-766"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-767"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-768"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-769">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-770">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-771"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-772"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-773"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-774">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-775"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-776"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-777"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-778"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-779">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>
</div>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-50-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:9.257em;" id="MathJax-Span-780"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:8.315em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(-1.104em, 1008.19em, 4.793em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-781"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-782"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.377em, 1001.39em, 6.964em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-5.362em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.39em, 4.629em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-783"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-784"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-785"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-786">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-787">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-788"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-789"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-790"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-791"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-792"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-793"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-794">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-795"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-796"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-797"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-798"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-799">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1001.39em, 4.466em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-826"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-827"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-828"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-829">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-830"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-831"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-832"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-833"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-834"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-835"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-836">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-837"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-838"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-839"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-840"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-841">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-864"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-865"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-866"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-867"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-868"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-869">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-870"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-871"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-872"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-873"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-874">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:5.367em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1006.47em, 9.339em, -999.998em);display:inline;left:1.394em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.632em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.595em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.65em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-800"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-801"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-802"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-803">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-804"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-805"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-806"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-807"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-808"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-809"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-810">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-811"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-812"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-813"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-814"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-815">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-816">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-817"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-818"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-819"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-820">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-821"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-822"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-823"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-824"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-825">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1006.47em, 4.629em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-842"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-843"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-844"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-845">=</span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-846"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">softmax</span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-847">(</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-848"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-849">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-850">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-851"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-852"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-853"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-854"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-855"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-856"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-857">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-858"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-859"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-860"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-861"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-862">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-863">)</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1005.49em, 5.489em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-875"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-876"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-877"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-878">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-879"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-880">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-881"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-882"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-883"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-884"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-885">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-886"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-887">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-888"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-889"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-890"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-891"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-892"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-893"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-894">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-895"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-896"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-897"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-898"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-899">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-900"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-901"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-902"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-903">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-904"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-905"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-906"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-907"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-908">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-909"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-910"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:6.636em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:6.366em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-2.907em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This gives the self-attention layer some controllable parameters, and allows it to modify the incoming vectors to suit the three roles they must play.
</p>
<p>
<img class="image_resized" style="aspect-ratio:873/724;width:660px;" src="https://peterbloem.nl/files/transformers/key-query-value.svg" width="873" height="724">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
Illustration of the self-attention with <span style="color:rgb(48,102,147);"><span class="bc">key</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">query</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">value</span></span> transformations.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="2-scaling-the-dot-product">
2) Scaling the dot product
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The softmax function can be sensitive to very large input values. These kill the gradient, and slow down learning, or cause it to stop altogether. Since the average value of the dot product grows with the embedding dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-51-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-911"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-912"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-913">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, it helps to scale the dot product back a little to stop the inputs to the softmax function from growing too large:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
&nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-52-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.063em;" id="MathJax-Span-914"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.448em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.412em, 1005.45em, 3.196em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-915"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-916"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-917">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-918">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-919"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-920"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-921"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-922"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-923"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-924"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-925">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-926"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-927"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-928"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-929"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-930">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-931">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-932"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1002.42em, 4.466em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -1.186em;padding:0px;position:absolute;text-decoration:none;top:-4.748em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-933"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-934"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-935"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-936"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-937"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-938"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-939"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-940">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-941"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-942"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-943"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-944"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-945">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-946">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-947"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-948"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-949"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-950">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-951"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-952"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-953"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-954"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-955">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1001.43em, 4.261em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -0.694em;padding:0px;position:absolute;text-decoration:none;top:-3.233em;transition:none;vertical-align:0px;"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-956"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-957"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-958">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.58em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.121em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.888em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1002.54em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:2.541em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.089em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>Why </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-53-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.605em;" id="MathJax-Span-959"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.43em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-960"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-961"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-962"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-963">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>? Imagine a vector in&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-54-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.204em;" id="MathJax-Span-964"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.982em, 1001.07em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-965"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-966"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-967"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-968"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.204em, 1000.58em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-969"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-970"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-971"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:20.2198px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.581em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.539em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-972">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.436em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> with values all </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-55-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.537em;" id="MathJax-Span-973"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.492em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.45em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-974"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-975">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.645em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i>. Its Euclidean length is </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-56-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.139em;" id="MathJax-Span-976"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.917em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.87em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-977"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-978"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-979"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-980">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-981">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>. Therefore, we are dividing out the amount by which the increase in dimension increases the length of the average vectors.</i>
    </p>
</aside>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="3-multi-head-attention">
3) Multi-head attention
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, we must account for the fact that a word can mean different things to different neighbours. Consider the following example.
</p>
<div class="MathJax_Display" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:block !important;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;orphans:2;position:relative;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:748px;word-spacing:0px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-57-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:11.959em;" id="MathJax-Span-982"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:10.772em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1010.77em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-983"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-984"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-985"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-986"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-987"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-988"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-989">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-990"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-991"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-992"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-993"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-994"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-995">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-996"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-997"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-998"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-999"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1000"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">roses</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1001">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1002"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1003"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1004"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1005"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1006"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">to</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1007">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1008"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1009"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1010"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1011"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1012"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We see that the word <span style="color:rgb(48,102,147);"><span class="bc">gave</span></span> has different relations to different parts of the sentence. <span style="color:rgb(48,102,147);"><span class="bc">mary</span></span> expresses who’s doing the giving, <span style="color:rgb(48,102,147);"><span class="bc">roses</span></span> expresses what’s being given, and <span style="color:rgb(48,102,147);"><span class="bc">susan</span></span> expresses who the recipient is.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
In a single self-attention operation, all this information just gets summed together. The inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-58-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;" id="MathJax-Span-1013"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.09em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1014"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1015"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1016"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1017"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1018">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1019"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1020"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1021"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1022"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1023"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-59-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1024"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1025"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1026"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1027"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1028"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1029">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1030"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1031"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1032"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1033"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1034"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> can influence the output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-60-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1035"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1036"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1037"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1038"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1039"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1040">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1041"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1042"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1043"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1044"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1045"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> by different amounts, depending on their dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-61-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;" id="MathJax-Span-1046"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.89em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1047"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1048"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1049"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1050"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1051">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1052"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1053"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1054"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1055"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1056"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, but they can’t influence it <i>in different ways</i>. If, for instance, we want the information about who gave the roses and who received them to end up in different parts of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-62-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1057"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1058"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1059"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1060"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1061"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1062">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1063"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1064"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1065"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1066"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1067"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we need a little more flexibility.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>This leaves aside how we figure out who gave the roses. We can do that based on prior knowledge about Mary and Susan, encoded in the embeddings. We can also look at the order of the words, but we'll look at how to achieve that later.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can give the self attention greater power of discrimination, by combining several self-attention mechanisms (which we'll index with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-63-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;" id="MathJax-Span-1068"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1069"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1070"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1071"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1072"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1073"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1074">r</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>), each with different matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-64-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1075"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1076"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1077"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1078"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1079"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1080">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1081"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1082"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1083"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1084"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1085">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.524em, 1000.49em, 4.302em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1086">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.498em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-65-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1087"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1088"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1089"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1090"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1091"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1092">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1093"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1094"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1095"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1096"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1097">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.49em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1098">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-66-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1099"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1100"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1101"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1102"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1103"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1104">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1109">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.41em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1110">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. These are called <i>attention heads</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
For input&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-67-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1111"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1112"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1113"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1114"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1115"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1116">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1117"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1118"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1119"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1120"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1121">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> each attention head produces a different output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-68-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.19em;" id="MathJax-Span-1122"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.07em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1123"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1124"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1125"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1126"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1127">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1132">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.33em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1133"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1134"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1135"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1136"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1137">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. We concatenate these, and pass them through a linear transformation to reduce the dimension back to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-69-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1138"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1139"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1140">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
<strong>Efficient multi-head self-attention.</strong> The simplest way to understand multi-head self-attention is to see it as a small number of copies of the self-attention mechanism applied in parallel, each with their own key, value and query transformation. This works well, but for&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-70-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1141"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1142"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1143">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> heads, the self-attention operation is&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-71-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1145"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1146">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> times as slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
It turns out we can have our cake and eat it too: there is a way to implement multi-head self-attention so that it is roughly as fast as the single-head version, but we still get the benefit of having different self-attention operations in parallel. To accomplish this, each head receives low-dimensional keys queries and values. If the input vector has&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-72-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;" id="MathJax-Span-1147"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.319em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.28em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1149">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1150">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1151">256</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> dimensions, and we have&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-73-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.664em;" id="MathJax-Span-1152"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.377em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.34em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1153"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1154">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1155">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1156">4</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> attention heads, we multiply the input vectors by a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-74-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1158"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1159">256</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1160">×</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1161">64</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix to project them down to a sequence of 64 dimansional vectors. For every head, we do this 3 times: for the keys, the queries and the values.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Here is the whole process illustrated in one image.
</p>
<p>
<img class="image_resized" style="aspect-ratio:1057/648;width:660px;" src="https://peterbloem.nl/files/transformers/multi-head.svg" alt="A diagram showing the operation of multi-head self-attention." width="1057" height="648">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
The basic idea of multi-head self-attention with 4 heads. To get our <span style="color:rgb(48,102,147);"><span class="bc">keys</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">queries</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">values</span></span>, we project the input down to vector sequences of smaller dimension.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This requires&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-75-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;" id="MathJax-Span-1162"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.11em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1163"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1164">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1165">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrices of size&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-76-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1166"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1167"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1168">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-77-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;" id="MathJax-Span-1169"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.68em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1170"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1171">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1172"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1173"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1174">/</span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1175">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>. In total, this gives us&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-78-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.94em;" id="MathJax-Span-1176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.326em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1005.33em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1177"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1178">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1179">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1180">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1181"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.41em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1182">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.45em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-3.643em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1183">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1000.58em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.575em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1184">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1185">3</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1187">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1188">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.502em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.452em;width:0px;"></span></span></nobr></span></span> parameters to compute the inputs to the multi-head self-attention: the same as we had for the single-head self-attention.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>The only difference is the matrix </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-79-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1189"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1190"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1191"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1192">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1193">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i>, used at the end of the multi-head self attention. This adds&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-80-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.16em;" id="MathJax-Span-1194"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.03em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1195"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1196"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1197">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.626em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.361em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1198">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.09em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i> parameters compared to the single-head version. In most transformers, the first thing that happens after each self attention is a feed-forward layer, so this may not be strictly necessary. I've never seen a proper ablation to test whether&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-81-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1200"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1201"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1202">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1203">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> can be removed.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can even implement this with just three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-82-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-1204"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1205"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1206">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1207">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1208">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix multiplications as in the single-head self-attention. The only extra operation we need is to slice the resulting sequence of vectors into chunks.
</p>
<figure class="narrow centering" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <figure class="image image_resized" style="width:495px;">
<img class="three-quarters" style="aspect-ratio:489/789;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/files/transformers/kqv-computation.svg" alt="A diagram showing the efficient computation of key query and value matrices in multi-head self-attention." width="489" height="789">
    </figure>
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
To compute multi-head attention efficiently, we combine the computation of the projections down to a lower dimensional representation and the computations of the keys, queries and values into three&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-83-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.585em;" id="MathJax-Span-1209"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.318em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1002.32em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1210"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1211">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1212">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1213">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.892em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></span> matrices.
    </figcaption>
</figure>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-complete-self-attention">
In Pytorch: complete self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Let’s now implement a self-attention module with all the bells and whistles. We’ll package it into a Pytorch module, so we can reuse it later.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
from torch import nn
import torch.nn.functional as F
class SelfAttention(nn.Module):
    def __init__(self, k, heads=4, mask=False):
      
    super().__init__()
    
    assert k % heads == 0
    
    self.k, self.heads = k, heads
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note the assert: the embedding dimension needs to be divisible by the number of heads.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we set up some linear transformations with <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> matrices. The <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">nn.Linear</code> module with the bias disabled gives us such a projection, and provides a reasonable initialization for us.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # These compute the queries, keys and values for all
    # heads
    self.tokeys    = nn.Linear(k, k, bias=False)
    self.toqueries = nn.Linear(k, k, bias=False)
    self.tovalues  = nn.Linear(k, k, bias=False)
	# This will be applied after the multi-head self-attention operation.
    self.unifyheads = nn.Linear(k, k)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We can now implement the computation of the self-attention (the module’s <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">forward</code> function). First, we compute the queries, keys and values for all heads:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">  def forward(self, x):
    b, t, k = x.size()
    h = self.heads
    queries = self.toqueries(x)
    keys    = self.tokeys(x)   
    values  = self.tovalues(x)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This gives us three vector sequences of the full embedding dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. As we saw above we can now cut these into <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> chunks. we can do this with a simple view operation:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">
	s = k // h
	keys    = keys.view(b, t, h, s)
	queries = queries.view(b, t, h, s)
	values  = values.view(b, t, h, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This simply reshapes the tensors to add a dimension that iterations over the heads. For a single vector in our sequence you can think of it as reshaping a vector of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code> into a matrix of <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k//h</code>:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:882/519;width:660px;" src="https://peterbloem.nl/files/transformers/reshape.svg" width="882" height="519">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we need to compute the dot products. This is the same operation for every head, so we fold the heads into the batch dimension. This ensures that we can use <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">torch.bmm()</code> as before, and the whole collection of keys, queries and values will just be seen as a slightly larger batch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since the head and batch dimension are not next to each other, we need to transpose before we reshape. (This is costly, but it seems to be unavoidable.)
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # - fold heads into the batch dimension
    keys = keys.transpose(1, 2).contiguous().view(b * h, t, s)
    queries = queries.transpose(1, 2).contiguous().view(b * h, t, s)
    values = values.transpose(1, 2).contiguous().view(b * h, t, s)
</code></pre>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>You can avoid these calls to </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>contiguous()</i></code><i> by using </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>reshape()</i></code><i> instead of </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>view()</i></code><i> but I prefer to make it explicit when we are copying a tensor, and when we are just viewing it. See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/mlvu/worksheets/blob/master/Worksheet%205%2C%20Pytorch.ipynb"><i>this notebook</i></a><i> for an explanation of the difference.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As before, the dot products can be computed in a single matrix multiplication, but now between the queries and the keys.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">   
    # Get dot product of queries and keys, and scale
    dot = torch.bmm(queries, keys.transpose(1, 2))
    # -- dot has size (b*h, t, t) containing raw weights
    # scale the dot product
    dot = dot / (s ** (1/2))
	
    # normalize 
    dot = F.softmax(dot, dim=2)
    # - dot now contains row-wise normalized weights
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We apply the self attention weights <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">dot</code> to the values, giving us the output for each attention head
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # apply the self attention to the values
    out = torch.bmm(dot, values).view(b, h, t, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To unify the attention heads, we transpose again, so that the head dimension and the embedding dimension are next to each other, and reshape to get concatenated vectors of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">e</code>. We then pass these through the <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">unifyheads</code> layer for a final projection.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # swap h, t back, unify heads
    out = out.transpose(1, 2).contiguous().view(b, t, s * h)
    
    return self.unifyheads(out)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And there you have it: multi-head, scaled dot-product self attention. You can see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/b438731ceeaf6c468f8b961bb07c2adde3b54a9f/former/modules.py#L10">the complete implementation here</a>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The implementation can be made more concise using </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://rockt.github.io/2018/04/30/einsum"><i>einsum notation</i></a><i> (see an example </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/4"><i>here</i></a><i>).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="building-transformers">
    Building <i>transformers</i>
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A transformer is not just a self-attention layer, it is an <i>architecture</i>. It’s not quite clear what does and doesn’t qualify as a transformer, but here we’ll use the following definition:
</p>
<blockquote style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, Helvetica, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px 0px 0px 4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        Any architecture designed to process a connected set of units—such as the tokens in a sequence or the pixels in an image—where the only interaction between units is through self-attention.
    </p>
</blockquote>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As with other mechanisms, like convolutions, a more or less standard approach has emerged for how to build self-attention layers up into a larger network. The first step is to wrap the self-attention into a <i>block</i> that we can repeat.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-transformer-block">
    The transformer block
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    There are some variations on how to build a basic transformer block, but most of them are structured roughly like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1090/473;width:660px;" src="https://peterbloem.nl/files/transformers/transformer-block.svg" width="1090" height="473">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    That is, the block applies, in sequence: <span style="color:rgb(103,125,0);"><span class="gc">a self attention layer,</span></span> <span style="color:rgb(177,62,38);"><span class="rc">layer normalization</span></span>, <span style="color:rgb(103,125,0);"><span class="gc">a feed forward layer</span></span> (a single <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="multi-layer perceptron">MLP</abbr> applied independently to each vector), and <span style="color:rgb(177,62,38);"><span class="rc">another layer normalization</span></span>. <span style="color:rgb(48,102,147);"><span class="bc">Residual connections</span></span> are added around both, before the normalization. The order of the various components is not set in stone; the important thing is to combine self-attention with a local feedforward, and to add normalization and residual connections.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Normalization and residual connections are standard tricks used to help deep neural networks train faster and more accurately. The layer normalization is applied over the embedding dimension only.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s what the transformer block looks like in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ruby" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class TransformerBlock(nn.Module):
  def __init__(self, k, heads):
    super().__init__()
    self.attention = SelfAttention(k, heads=heads)
    self.norm1 = nn.LayerNorm(k)
    self.norm2 = nn.LayerNorm(k)
    self.ff = nn.Sequential(
      nn.Linear(k, 4 * k),
      nn.ReLU(),
      nn.Linear(4 * k, k))
  def forward(self, x):
    attended = self.attention(x)
    x = self.norm1(attended + x)
    fedforward = self.ff(x)
    return self.norm2(fedforward + x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve made the relatively arbitrary choice of making the hidden layer of the feedforward 4 times as big as the input and output. Smaller values may work as well, and save memory, but it should be bigger than the input/output layers.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="classification-transformer">
    Classification transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The simplest transformer we can build is a <i>sequence classifier</i>. We’ll use the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Internet Movie Database">IMDb</abbr> sentiment classification dataset: the instances are movie reviews, tokenized into sequences of words, and the classification labels are <span style="color:rgb(48,102,147);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="bc">positive</span></code></span> and <span style="color:rgb(177,62,38);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="rc">negative</span></code></span> (indicating whether the review was positive or negative about the movie).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The heart of the architecture will simply be a large chain of transformer blocks. All we need to do is work out how to feed it the input sequences, and how to transform the final output sequence into a a single classification.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole experiment can be <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/master/experiments/classify.py">found here</a>. We won’t deal with the data wrangling in this blog post. Follow the links in the code to see how the data is loaded and prepared.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="output-producing-a-classification">
    Output: producing a classification
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The most common way to build a sequence classifier out of sequence-to-sequence layers, is to apply global average pooling to the final output sequence, and to map the result to a softmaxed class vector.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1039/460;width:660px;" src="https://peterbloem.nl/files/transformers/classifier.svg" width="1039" height="460">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Overview of a simple sequence classification transformer. The output sequence is <span style="color:rgb(48,102,147);"><span class="bc">averaged</span></span> to produce a single vector representing the whole sequence. This vector is projected down to a vector with one element per class and softmaxed to produce probabilities.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="input-using-the-positions">
    Input: using the positions
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve already discussed the principle of an embedding layer. This is what we’ll use to represent the words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    However, as we’ve also mentioned already, we’re stacking permutation equivariant layers, and the final global average pooling is permutation <i>in</i>variant, so the network as a whole is also permutation invariant. Put more simply: if we shuffle up the words in the sentence, we get the exact same classification, whatever weights we learn. Clearly, we want our state-of-the-art language model to have at least some sensitivity to word order, so this needs to be fixed.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The solution is simple: we create a second vector of equal length, that represents the position of the word in the current sentence, and add this to the word embedding. There are two options.
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position embeddings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            We simply <i>embed</i> the positions like we did the words. Just like we created embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-84-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1214"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1215"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1216"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1217"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1218"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1219">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1220"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1221"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1222"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1223"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1224"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-85-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1225"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1226"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1227"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1228"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1229"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1230">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1231"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1232"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1233"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1234"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1235"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we create embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-86-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;" id="MathJax-Span-1236"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.23em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1237"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1238"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1239"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1240"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1241">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1242"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1243"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1244"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1245"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1246"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">12</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-87-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;" id="MathJax-Span-1247"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.31em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1248"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1249"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1250"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1251"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1252">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1253"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1254"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1255"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1256"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1257"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">25</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>. Up to however long we expect sequences to get. The drawback is that we have to see sequences of every length during training, otherwise the relevant position embeddings don't get trained. The benefit is that it works pretty well, and it's easy to implement.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position encodings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Position encodings work in the same way as embeddings, except that we don't <i>learn</i> the position vectors, we just choose some function&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-88-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.875em;" id="MathJax-Span-1258"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.384em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.985em, 1004.38em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1259"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1260">f<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1261">:</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1262"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1263"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1265"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1266"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℕ</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1267">→</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1268"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1000.62em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1269"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1270"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1271"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1272"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1273"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.543em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1274">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.457em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> to map the positions to real valued vectors, and let the network figure out how to interpret these encodings. The benefit is that for a well chosen function, the network should be able to deal with sequences that are longer than those it's seen during training (it's unlikely to perform well on them, but at least we can check). The drawbacks are that the choice of encoding function is a complicated hyperparameter, and it complicates the implementation a little.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For the sake of simplicity, we’ll use position embeddings in our implementation.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="pytorch">
    Pytorch
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here is the complete text classification transformer in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class Transformer(nn.Module):
    def __init__(self, k, heads, depth, seq_length, num_tokens, num_classes):
        super().__init__()
        self.num_tokens = num_tokens
        self.token_emb = nn.Embedding(num_tokens, k)
        self.pos_emb = nn.Embedding(seq_length, k)
		# The sequence of transformer blocks that does all the
		# heavy lifting
        tblocks = []
        for i in range(depth):
            tblocks.append(TransformerBlock(k=k, heads=heads))
        self.tblocks = nn.Sequential(*tblocks)
		# Maps the final output sequence to class logits
        self.toprobs = nn.Linear(k, num_classes)
    def forward(self, x):
        """
        :param x: A (b, t) tensor of integer values representing
                  words (in some predetermined vocabulary).
        :return: A (b, c) tensor of log-probabilities over the
                 classes (where c is the nr. of classes).
        """
		# generate token embeddings
        tokens = self.token_emb(x)
        b, t, k = tokens.size()
		# generate position embeddings
		positions = torch.arange(t)
        positions = self.pos_emb(positions)[None, :, :].expand(b, t, k)
        x = tokens + positions
        x = self.tblocks(x)
        # Average-pool over the t dimension and project to class
        # probabilities
        x = self.toprobs(x.mean(dim=1))
        return F.log_softmax(x, dim=1)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At depth 6, with a maximum sequence length of 512, this transformer achieves an accuracy of about 85%, competitive with results from RNN models, and much faster to train. To see the real near-human performance of transformers, we’d need to train a much deeper model on much more data. More about how to do that later.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="text-generation-transformer">
    Text generation transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The next trick we’ll try is an <i>autoregressive</i> model. We’ll train a <i>character</i> level transformer to predict the next character in a sequence. The training regime is simple (and has been around <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">for far longer than transformers have</a>). We give the sequence-to-sequence model a sequence, and we ask it to predict the next character at each point in the sequence. In other words, the target output is the same sequence shifted one character to the left:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1122/458;width:660px;" src="https://peterbloem.nl/files/transformers/generator.svg" width="1122" height="458">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    With RNNs this is all we need to do, since they cannot look forward into the input sequence: output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-89-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1275"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1276"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1277">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> depends only on inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-90-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;" id="MathJax-Span-1278"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1279"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1280">0</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-91-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1281"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1282"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1283">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. With a transformer, the output depends on the entire input sequence, so prediction of the next character becomes vacuously easy, just retrieve it from the input.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To use self-attention as an autoregressive model, we’ll need to ensure that it cannot look forward into the sequence. We do this by applying a mask to the matrix of dot products, before the softmax is applied. This mask disables all elements above the diagonal of the matrix.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1014/366;width:660px;" src="https://peterbloem.nl/files/transformers/masked-attention.svg" width="1014" height="366">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Masking the self attention, to ensure that elements can only attend to input elements that precede them in the sequence. Note that the multiplication symbol is slightly misleading: we actually set the masked out elements (the white squares) to&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-92-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.961em;" id="MathJax-Span-1284"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.427em, 1001.69em, 2.362em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1285"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1286">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1287">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.146em;width:0px;"></span></span></nobr></span></span>
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we want these elements to be zero after the softmax, we set them to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-93-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.968em;" id="MathJax-Span-1288"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.763em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.435em, 1001.72em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1289"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1290">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1291">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Here’s how that looks in pytorch:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">dot = torch.bmm(queries, keys.transpose(1, 2))
indices = torch.triu_indices(t, t, offset=1)
dot[:, indices[0], indices[1]] = float('-inf')
dot = F.softmax(dot, dim=2)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After we’ve handicapped the self-attention module like this, the model can no longer look forward in the sequence.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on the standard <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">enwik8</code> dataset (taken from the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://prize.hutter1.net/">Hutter prize</a>), which contains&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-94-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1292"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.026em, 1001.43em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1293"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1295">10</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1296">8</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> characters of Wikipedia text (including markup). During training, we generate batches by randomly sampling subsequences from the data.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on sequences of length 256, using a model of 12 transformer blocks and 256 embedding dimension. After about 24 hours training on an RTX 2080Ti (some 170K batches of size 32), we let the model generate from <span style="color:rgb(115,167,211);"><span class="lbc">a 256-character seed</span></span>: for each character, we feed it the preceding 256 characters, and look what it predicts for the next character (the last output vector). We sample from that with a <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277">temperature</a> of 0.5, and move to the next character.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The output looks like this:
</p>
<div class="sample" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Consolas, monospace;font-size:0.8em;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <span style="color:rgb(115,167,211);"><span class="lbc">1228X Human &amp; Rousseau. Because many of his stories were originally published in long-forgotten magazines and journals, there are a number of [[anthology|anthologies]] by different collators each containing a different selection. His original books ha</span></span>ve been considered an anthologie in the [[Middle Ages]], and were likely to be one of the most common in the [[Indian Ocean]] in the [[1st century]]. As a result of his death, the Bible was recognised as a counter-attack by the [[Gospel of Matthew]] (1177-1133), and the [[Saxony|Saxons]] of the [[Isle of Matthew]] (1100-1138), the third was a topic of the [[Saxony|Saxon]] throne, and the [[Roman Empire|Roman]] troops of [[Antiochia]] (1145-1148). The [[Roman Empire|Romans]] resigned in [[1148]] and [[1148]] began to collapse. The [[Saxony|Saxons]] of the [[Battle of Valasander]] reported the y
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note that the Wikipedia link tag syntax is correctly used, that the text inside the links represents reasonable subjects for links. Most importantly, note that there is a rough thematic consistency; the generated text keeps on the subject of the bible, and the Roman empire, using different related terms at different points. While this is far from the performance of a model like <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>, the benefits over a similar RNN model are clear already: faster training (a similar RNN model would take many days to train) and better long-term coherence.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>In case you're curious, the Battle of Valasander seems to be an invention of the network.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At this point, the model achieves a compression of 1.343 bits per byte on the validation set, which is not too far off the state of the art of 0.93 bits per byte, achieved by the GPT-2 model (described below).
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="design-considerations">
    Design considerations
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To understand why transformers are set up this way, it helps to understand the basic design considerations that went into them. The main point of the transformer was to overcome the problems of the previous state-of-the-art architecture, the RNN (usually an LSTM or a GRU). <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Unrolled</a>, an RNN looks like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:940/301;width:660px;" src="https://peterbloem.nl/files/transformers/recurrent-connection.svg" width="940" height="301">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big weakness here is the <span style="color:rgb(48,102,147);"><span class="bc">recurrent connection</span></span>. while this allows information to propagate along the sequence, it also means that we cannot compute the cell at time step&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-95-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1297"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1299">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> until we’ve computed the cell at timestep <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-96-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;" id="MathJax-Span-1300"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.05em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.85em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1301"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1302">i</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1303">−</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1304">1</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Contrast this with a 1D convolution:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:968/347;width:660px;" src="https://peterbloem.nl/files/transformers/convolutional-connection.svg" width="968" height="347">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In this model, every output vector can be computed in parallel with every other output vector. This makes convolutions much faster. The drawback with convolutions, however, is that they’re severely limited in modeling <i>long range dependencies</i>. In one convolution layer, only words that are closer together than the kernel size can interact with each other. For longer dependence we need to stack many convolutions.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer is an attempt to capture the best of both worlds. They can model dependencies over the whole range of the input sequence just as easily as they can for words that are next to each other (in fact, without the position vectors, they can’t even tell the difference). And yet, there are no recurrent connections, so the whole model can be computed in a very efficient feedforward fashion.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The rest of the design of the transformer is based primarily on one consideration: depth. Most choices follow from the desire to train big stacks of transformer blocks. Note for instance that there are only two places in the transformer where non-linearities occur: the softmax in the self-attention and the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="rectified linear unit">ReLU</abbr> in the feedforward layer. The rest of the model is entirely composed of linear transformations, which perfectly preserve the gradient.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>I suppose the layer normalization is also nonlinear, but that is one nonlinearity that actually helps to keep the gradient stable as it propagates back down the network.</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="historical-baggage">
    Historical baggage
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If you’ve read other introductions to transformers, you may have noticed that they contain some bits I’ve skipped. I think these are not necessary to understand modern transformers. They are, however, helpful to understand some of the terminology and some of the writing <i>about</i> modern transformers. Here are the most important ones.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="why-is-it-called-self-attention">
    Why is it called self-<i>attention</i>?
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before self-attention was first presented, sequence models consisted mostly of recurrent networks or convolutions stacked together. At some point, it was discovered that these models could be helped by adding <i>attention mechanisms</i>: instead of feeding the output sequence of the previous layer directly to the input of the next, an intermediate mechanism was introduced, that decided which elements of the input were relevant for a particular word of the output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The general mechanism was as follows. We call the input the <strong>values</strong>. Some (trainable) mechanism assigns a <strong>key</strong> to each value. Then to each output, some other mechanism assigns a <strong>query</strong>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    These names derive from the datastructure of a key-value store. In that case we expect only one item in our store to have a key that matches the query, which is returned when the query is executed. Attention is a softened version of this: <i>every</i> key in the store matches the query to some extent. All are returned, and we take a sum, weighted by the extent to which each key matches the query.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The great breakthrough of self-attention was that attention by itself is a strong enough mechanism to do all the learning. <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1706.03762">Attention is all you need</a>, as the authors put it. The key, query and value are all the same vectors (with minor linear transformations). They <i>attend to themselves</i> and stacking such self-attention provides sufficient nonlinearity and representational power to learn very complicated functions.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-original-transformer-encoders-and-decoders">
    The original transformer: encoders and decoders
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    But the authors did not dispense with all the complexity of contemporary sequence modeling. The standard structure of sequence-to-sequence models in those days was an encoder-decoder architecture, with <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">teacher forcing</a>.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1036/557;width:660px;" src="https://peterbloem.nl/files/transformers/encoder-decoder.svg" width="1036" height="557">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The <i>encoder</i> takes the input sequence and maps it to a <i>latent</i> representation of the whole sequence. This can be either a sequence of latent vectors, or a single one as in the image above. This vector is then passed to a <i>decoder</i> which unpacks it to the desired target sequence (for instance, the same sentence in another language).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <i>Teacher forcing</i> refers to the technique of also allowing the decoder access to the input sentence, but in an autoregressive fashion. That is, the decoder generates the output sentence word for word based both on the latent vector and the words it has already generated. This takes some of the pressure off the latent representation: the decoder can use word-for-word sampling to take care of the low-level structure like syntax and grammar and use the latent vector to capture more high-level semantic structure. Decoding twice with the same latent representation would, ideally, give you two different sentences with the same meaning.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In later transformers, like BERT and GPT-2, the encoder/decoder configuration was entirely dispensed with. A simple stack of transformer blocks was found to be sufficient to achieve state of the art in many sequence based tasks.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This approach is sometimes called a decoder-only transformer (for an autoregressive model) or an encoder-only transformer (for a model without masking).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="modern-transformers">
    Modern transformers
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s a small selection of some modern transformers and their most characteristic details.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="bert">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1810.04805">BERT</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Bidirectional Encoder Representations from Transformers">BERT</abbr> was one of the first models to show that transformers could reach human-level performance on a variety of language based tasks: question answering, sentiment classification or classifying whether two sentences naturally follow one another.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT consists of a simple stack of transformer blocks, of the type we’ve described above. This stack is <i>pre-trained</i> on a large general-domain corpus consisting of 800M words from English books (modern work, from unpublished authors), and 2.5B words of text from English Wikipedia articles (without markup).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Pretraining is done through two tasks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Masking</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            A certain number of words in the input sequence are: masked out, replaced with a random word or kept as is. The model is then asked to predict, for these words, what the original words were. Note that the model doesn't need to predict the entire denoised sentence, just the modified words. Since the model doesn't know which words it will be asked about, it learns a representation for every word in the sequence.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Next sequence classification</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Two sequences of about 256 words are sampled that either (a) follow each other directly in the corpus, or (b) are both taken from random places. The model must then predict whether a or b is the case.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT uses WordPiece tokenization, which is somewhere in between word-level and character level sequences. It breaks words like <span style="color:rgb(48,102,147);"><span class="bc">walking</span></span> up into the tokens <span style="color:rgb(48,102,147);"><span class="bc">walk</span></span> and <span style="color:rgb(48,102,147);"><span class="bc">##ing</span></span>. This allows the model to make some inferences based on word structure: two verbs ending in -ing have similar grammatical functions, and two verbs starting with walk- have similar semantic function.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The input is prepended with a special <span style="color:rgb(48,102,147);"><span class="bc">&lt;cls&gt;</span></span> token. The output vector corresponding to this token is used as a sentence representation in sequence classification tasks like the next sentence classification (as opposed to the global average pooling over all vectors that we used in our classification model above).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After pretraining, a single task-specific layer is placed after the body of transformer blocks, which maps the general purpose representation to a task specific output. For classification tasks, this simply maps the first output token to softmax probabilities over the classes. For more complex tasks, a final sequence-to-sequence layer is designed specifically for the task.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole model is then re-trained to finetune the model for the specific task at hand.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In an ablation experiment, the authors show that the largest improvement as compared to previous models comes from the bidirectional nature of BERT. That is, previous models like GPT used an autoregressive mask, which allowed attention only over previous tokens. The fact that in BERT all attention is over the whole sequence is the main cause of the improved performance.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This is why the B in BERT stands for "bidirectional".</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The largest BERT model uses 24 transformer blocks, an embedding dimension of 1024 and 16 attention heads, resulting in 340M parameters.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="gpt-2">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="generative pre-trained transformer">GPT</abbr>-2 is the first transformer model that actually made it into <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.bbc.com/news/technology-47249163">the mainstream news</a>, after the controversial decision by OpenAI not to release the full model.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The reason was that GPT-2 could generate sufficiently believable text that large-scale fake news campaigns of the kind seen in the 2016 US presidential election would become effectively a one-person job.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first trick that the authors of GPT-2 employed was to create a new high-quality dataset. While BERT used high-quality data, their sources (lovingly crafted books and well-edited wikipedia articles) had a certain lack of diversity in the writing style. To collect more diverse data without sacrificing quality the authors used links posted on the social media site <i>Reddit</i> to gather a large collection of writing with a certain minimum level of social support (expressed on Reddit as <i>karma</i>).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is fundamentally a language <i>generation</i> model, so it uses masked self-attention like we did in our model above. It uses byte-pair encoding to tokenize the language, which , like the WordPiece encoding breaks words up into tokens that are slightly larger than single characters but less than entire words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is built very much like our text generation model above, with only small differences in layer order and added tricks to train at greater depths. The largest model uses 48 transformer blocks, a sequence length of 1024 and an embedding dimension of 1600, resulting in 1.5B parameters.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    They show state-of-the art performance on many tasks. On the wikipedia compression task that we tried above, they achieve 0.93 bits per byte.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="transformer-xl">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1901.02860">Transformer-XL</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    While the transformer represents a massive leap forward in modeling long-range dependency, the models we have seen so far are still fundamentally limited by the size of the input. Since the size of the dot-product matrix grows quadratically in the sequence length, this quickly becomes the bottleneck as we try to extend the length of the input sequence. Transformer-XL is one of the first succesful transformer models to tackle this problem.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    During training, a long sequence of text (longer than the model could deal with) is broken up into shorter segments. Each segment is processed in sequence, with self-attention computed over the tokens in the curent segment <i>and the previous segment</i>. Gradients are only computed over the current segment, but information still propagates as the segment window moves through the text. In theory at layer <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-97-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1306"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1307">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, information may be used from&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-98-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1308"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1309"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1310">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> segments ago.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>A similar trick in RNN training is called truncated backpropagation through time. We feed the model a very long sequence, but backpropagate only over part of it. The first part of the sequence, for which no gradients are computed, still influences the values of the hidden states in the part for which they are.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To make this work, the authors had to let go of the standard position encoding/embedding scheme. Since the position encoding is <i>absolute</i>, it would change for each segment and not lead to a consistent embedding over the whole sequence. Instead they use a <i>relative</i> encoding. For each output vector, a different sequence of position vectors is used that denotes not the absolute position, but the distance to the current output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This requires moving the position encoding into the attention mechanism (which is detailed in the paper). One benefit is that the resulting transformer will likely generalize much better to sequences of unseen length.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="sparse-transformers">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/sparse-transformer/">Sparse transformers</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Sparse transformers tackle the problem of quadratic memory use head-on. Instead of computing a dense matrix of attention weights (which grows quadratically), they compute the self-attention only for particular pairs of input tokens, resulting in a <i>sparse</i> attention matrix, with only&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-99-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.418em;" id="MathJax-Span-1311"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.172em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1002.17em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1312"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1313">n</span><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1314"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.66em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1315"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1316">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.7em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> explicit elements.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This allows models with very large context sizes, for instance for generative modeling over images, with large dependencies between pixels. The tradeoff is that the sparsity structure is not learned, so by the choice of sparse matrix, we are disabling some interactions between input tokens that might otherwise have been useful. However, two units that are not directly related may still interact in higher layers of the transformer (similar to the way a convolutional net builds up a larger receptive field with more convolutional layers).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Beyond the simple benefit of training transformers with very large sequence lengths, the sparse transformer also allows a very elegant way of designing an inductive bias. We take our input as a collection of units (words, characters, pixels in an image, nodes in a graph) and we specify, through the sparsity of the attention matrix, which units we believe to be related. The rest is just a matter of building the transformer up as deep as it will go and seeing if it trains.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="going-big">
    Going big
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big bottleneck in training transformers is the matrix of dot products in the self attention. For a sequence length <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-100-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-1317"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1318"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1319">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, this is a dense matrix containing&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-101-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1320"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1000.86em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1321"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1322"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.278em, 1000.41em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1323">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.412em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1324">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> elements. At standard 32-bit precision, and with&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-102-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1325"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1326"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1327">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1328">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1329">1000</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> a batch of 16 such matrices takes up about 64Mb of memory. Since we need to store at least four of them for each head of each self-attention operation (before and after softmax, plus their gradients), that limits us to at most twelve 4-head layers in a standard 12Gb GPU. In practice, we get even less, since the inputs and outputs also take up a lot of memory (although the dot product dominates).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And yet models reported in the literature contain much longer sequence lengths, with 48 or more layers, using dense dot product matrices. These models are trained on clusters, of course, but a single GPU is still required to do a single forward/backward pass. How do we fit such humongous transformers into 12Gb of memory? There are three main tricks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Half precision</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            On modern GPUs and on TPUs, tensor computations can be done efficiently on 16-bit float tensors. This isn't quite as simple as just setting the dtype of the tensor to <code style="font-family:Consolas, monospace;font-size:0.8em;">torch.float16</code>. For some parts of the network, like the loss, 32 bit precision is required. But most of this can be handled with relative ease by <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/NVIDIA/apex">existing libraries</a>. Practically, this doubles your effective memory.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient accumulation</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            For a large model, we may only be able to perform a forward/backward pass on a single instance. Batch size 1 is not likely to lead to stable learning. Luckily, we can perform a single forward/backward for each instance in a larger batch, and simply sum the gradients we find (this is a consequence of the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/#slide-024">multivariate chain rule</a>). When we hit the end of the batch, we do a single step of gradient descent, and zero out the gradient. In Pytorch this is particulary easy: you know that <code style="font-family:Consolas, monospace;font-size:0.8em;">optimizer.zero_grad()</code> call in your training loop that seems so superfluous? If you don't make that call, the new gradients are simply added to the old ones.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient checkpointing</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            If your model is so big that even a single forward/backward won't fit in memory, you can trade off even more computation for memory efficiency. In gradient checkpointing, you separate your model into sections. For each section, you do a separate forward/backward to compute the gradients, without retaining the intermediate values for the rest. Pytorch has <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/docs/stable/checkpoint.html">special utilities</a> for gradient checkpointng.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For more information on how to do this, see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://medium.com/huggingface/training-larger-batches-practical-tips-on-1-gpu-multi-gpu-distributed-setups-ec88c3e51255">this blogpost</a>.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="conclusion">
    Conclusion
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer may well be the simplest machine learning architecture to dominate the field in decades. There are good reasons to start paying attention to them if you haven’t been already.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Firstly, <strong>the current performance limit is purely in the hardware</strong>. Unlike convolutions or LSTMs the current limitations to what they can do are entirely determined by how big a model we can fit in GPU memory and how much data we can push through it in a reasonable amount of time. I have no doubt, we will eventually hit the point where more layers and and more data won’t help anymore, but we don’t seem to have reached that point yet.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Second, <strong>transformers are extremely generic</strong>. So far, the big successes have been in language modelling, with some more modest achievements in image and music analysis, but the transformer has a level of generality that is waiting to be exploited. The basic transformer is a <i>set-to-set</i> model. So long as your data is a set of units, you can apply a transformer. Anything else you know about your data (like local structure) you can add by means of position embeddings, or by manipulating the structure of the attention matrix (making it sparse, or masking out parts).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is particularly useful in multi-modal learning. We could easily combine a captioned image into a set of pixels and characters and design some clever embeddings and sparsity structure to help the model figure out how to combine and align the two. If we combine the entirety of our knowledge about our domain into a relational structure like a multi-modal knowledge graph (as discussed in [3]), simple transformer blocks could be employed to propagate information between multimodal units, and to align them with the sparsity structure providing control over which units directly interact.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    So far, transformers are still primarily seen as a language model. I expect that in time, we’ll see them adopted much more in other domains, not just to increase performance, but to simplify existing models, and to allow practitioners more intuitive control over their models’ inductive biases.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="references">
    References
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [1] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://jalammar.github.io/illustrated-transformer/">The illustrated transformer</a>, Jay Allamar.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [2] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://nlp.seas.harvard.edu/2018/04/03/attention.html">The annotated transformer</a>, Alexander Rush.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [3] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://content.iospress.com/articles/data-science/ds007">The knowledge graph as the default data model for learning on heterogeneous knowledge</a> Xander Wilcke, Peter Bloem, Victor de Boer
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [4] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf">Matrix factorization techniques for recommender systems</a> Yehuda Koren et al.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="updates-and-corrections">
    Updates and corrections
</h2>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>19 October 2019</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Added a section on the difference between wide and narrow self-attention. Thanks to <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/sidneyaraujomelo">Sidney Melo</a> for <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/8">spotting the mistake</a> in the original implementation.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>9 December 2022</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Clarified the example in the section on multi-head attention.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>4 March 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a persistent mistake in the definition of multi-head self-attention. Rewrote the final self-attention to be the canonical form (rather than the earlier "wide" variety we used for the sake of simplicity).
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>1 Aug 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed some small mistakes in the section "Going big".
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>7 May 2024</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a mistake in the multi-head self-attention: the rescaling of the parameters should divide by <code style="font-family:Consolas, monospace;font-size:0.8em;">s</code> not <code style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. Thanks to Vivek Harshey for spotting this.
        </p>
    </dd>
</dl>`,
        tags: ["Node.js", "JavaScript", "Backend"],
        categories: ["Development", "Backend"],
        publishedDate: "2024-06-25T12:00:00Z",
        updatedDate: "2024-06-26T14:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "5",
        title: "CSS Grid Layout: A Complete Guide",
        imgURL: "",
        content: "CSS Grid is a powerful tool for creating complex layouts Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs",
        tags: ["CSS", "Grid", "Design"],
        categories: ["Design", "Frontend"],
        publishedDate: "2024-05-20T11:00:00Z",
        updatedDate: "2024-05-21T12:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"

    },
    {
        postId: "6",
        title: "Exploring MongoDB for Beginners",
        imgURL: "",
        content: `<header style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <h1 style="font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-weight:normal;margin:3vw auto 2vw;text-align:center;text-transform:uppercase;">
        Transformers from scratch
    </h1>
</header>
<ul class="links" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:table;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px 0px 0.3em;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            18 Aug 2019
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former">code on github</a>
        </p>
    </li>
    <li style="display:inline;list-style:none;padding:0px;position:static;">
        <p style="margin-left:auto;text-align:center;">
            <a class="code" style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/playlist?list=PLIXJ-Sacf8u60G1TwcznBmK6rEL3gmZmV">video lecture</a>
        </p>
    </li>
</ul>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Transformers are a very exciting family of machine learning architectures. Many good tutorials exist (e.g. [1, 2]) but in the last few years, transformers have mostly become simpler, so that it is now much more straightforward to explain how modern architectures work. This post is an attempt to explain directly how modern transformers work, and why, without some of the historical baggage.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    I will assume a basic understanding of neural networks and backpropagation. If you’d like to brush up, <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture06/">this lecture</a> will give you the basics of neural networks and <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/">this one</a> will explain how these principles are applied in modern deep learning systems.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html">working knowledge of Pytorch</a> is required to understand the programming examples, but these can also be safely skipped.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="self-attention">
    Self-attention
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The fundamental operation of any transformer architecture is the <i>self-attention operation</i>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>We'll explain where the name "self-attention" comes from later. For now, don't read too much in to it.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Self-attention is a sequence-to-sequence operation: a sequence of vectors goes in, and a sequence of vectors comes out. Let’s call the input vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-1-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.694em;" id="MathJax-Span-1"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.121em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.12em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-2"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-3"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-4"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-5"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-6">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-7">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-8">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-9"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-10"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-11"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-12">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-13">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-14">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-15">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-16">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-17"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-18"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-19"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-20">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-21">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and the corresponding output vectors <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-2-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.104em;" id="MathJax-Span-22"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.489em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1005.49em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-23"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-24"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-25"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-26"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-27">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-28">1</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-29">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-30"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-31"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-32"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-33">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-34">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-35">,</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-36">…</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-37">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-38"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-39"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-40"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-41">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-42">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>. The vectors all have dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-3-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-43"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-44"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-45">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To produce output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-4-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-46"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-47"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-48"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-49"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-50"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-51">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-52"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-53"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-54"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-55"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-56">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>, the self attention operation simply takes <i>a weighted average over all the input vectors</i>
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-5-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:7.25em;" id="MathJax-Span-57"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.513em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.067em, 1006.51em, 3.606em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-58"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-59"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-60"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-61"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-62">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-63"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-64"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-65"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-66"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-67">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-68">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-69"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-70">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-71"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-72"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-73"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-74"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-75"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-76"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-77">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-78"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-79">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-80"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-81"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-82"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-83"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-84"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-85"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-86">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-87"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-88"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-89"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-90"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-91">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-92"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-93"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-94"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-95">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-96"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-97"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-98"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-99"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-100">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-101"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-102"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.543em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-6-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-103"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-104"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-109">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> indexes over the whole sequence and the weights sum to one over all <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-7-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-110"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-111"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-112"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-113"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-114"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-115"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-116">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. The weight&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-8-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-117"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1001.39em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-118"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-119"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-120">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-121"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-122"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-123"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-124"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-125"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-126"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-127">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-132">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span> is not a parameter, as in a normal neural net, but it is <i>derived</i> from a function over&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-9-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-133"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-134"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-135"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-136"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-137"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-138">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-139"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-140"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-141"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-142"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-143">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-10-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-145"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-146"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-147"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-149">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-150"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-151"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-152"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-153"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-154">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.002em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. The simplest option for this function is the dot product:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-11-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.858em;" id="MathJax-Span-155"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.285em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1005.28em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-156"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-158">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-159">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-160"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-161"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-162"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-163"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-164"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-165"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-166">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-167"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-168"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-169"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-170"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-171">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-172">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-173"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-174"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-175"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-177"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-178"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-179">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-180"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-181"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-182"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-183"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-184">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.862em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-185">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-187"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-188"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-189">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-190"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-191"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-192"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-193"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-194">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-195"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-196"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Note that&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-12-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;" id="MathJax-Span-197"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.89em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-198"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.893em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-200"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-201"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-202">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.537em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-203"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-204"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-205"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-206"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-207">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i> is the input vector at the same position as the current output vector </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-13-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.115em;" id="MathJax-Span-208"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.98em, 2.54em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-209"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-210"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.982em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.386em, 1000.54em, 4.366em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-211"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-212"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-213">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.67em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.738em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-214"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-215"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-216"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-217"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-218">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.942em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.343em;width:0px;"></span></span></nobr></span></i></span><i>. For the next output vector, we get an entirely new series of dot products, and a different weighted sum.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The dot product gives us a value anywhere between negative and positive infinity, so we apply a softmax to map the values to&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-14-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-219"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.89em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-220"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-221">[</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-222">0</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-223">,</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-224">1</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-225">]</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> and to ensure that they sum to 1 over the whole sequence:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-15-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:8.888em;" id="MathJax-Span-226"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.166em, 1007.99em, 3.565em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-227"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-228"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-229">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-230"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-231"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-232"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-233"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-234"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-235"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-236">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-237"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-238"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-239"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-240"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-241">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-242">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-243"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.67em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.03em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -1.513em;padding:0px;position:absolute;text-decoration:none;top:-4.953em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-244"><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-245"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-246"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-247">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-248">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-249"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-250"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-251"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-252"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-253"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-254"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-255">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-256"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-257"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-258"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-259"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-260">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1004.55em, 4.629em, -999.998em);display:inline;left:57.0156px;line-height:normal;margin:0px 0px 0px -2.25em;padding:0px;position:absolute;text-decoration:none;top:-3.151em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-261"><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-262"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.155em, 1000.99em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Operators;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.203em;" id="MathJax-Span-263">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.067em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-265"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-266"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-267"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-268">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-269"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">exp&nbsp;</span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-270"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-271">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-272">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-273"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-274"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-275"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-276"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-277"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-278"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-279">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-280"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-281"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-282"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-283"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-284">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1004.67em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:4.67em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-285"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-286"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:3.593em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.498em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And that’s the basic operation of self attention.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1092/697;width:660px;" src="https://peterbloem.nl/files/transformers/self-attention.svg" width="1092" height="697">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        A visual illustration of basic self-attention. Note that the softmax operation over the <span style="color:rgb(177,62,38);"><span class="rc">weights</span></span> is not illustrated.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A few other ingredients are needed for a complete transformer, which we’ll discuss later, but this is the fundamental operation. More importantly, this is the only operation in the whole architecture that propagates information <i>between</i> vectors. Every other operation in the transformer is applied to each vector in the input sequence without interactions between vectors.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="understanding-why-self-attention-works">
    Understanding why self-attention works
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Despite its simplicity, it’s not immediately obvious why self-attention should work so well. To build up some intuition, let’s look first at the standard approach to <i>movie recommendation</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Let’s say you run a movie rental business and you have some movies, and some users, and you would like to recommend movies to your users that they are likely to enjoy.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    One way to go about this, is to create manual features for your movies, such as how much romance there is in the movie, and how much action, and then to design corresponding features for your users: how much they enjoy romantic movies and how much they enjoy action-based movies. If you did this, the dot product between the two feature vectors would give you a score for how well the attributes of the movie match what the user enjoys.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1011/410;width:660px;" src="https://peterbloem.nl/files/transformers/dot-product.svg" width="1011" height="410">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If the signs of a feature match for the user and the movie—the movie is romantic and the user loves romance or the movie is <i>unromantic</i> and the user hates romance—then the resulting dot product gets a positive term for that feature. If the signs don’t match—the movie is romantic and the user hates romance or vice versa—the corresponding term is negative.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Furthermore, the <i>magnitudes</i> of the features indicate how much the feature should contribute to the total score: a movie may be a little romantic, but not in a noticeable way, or a user may simply prefer no romance, but be largely ambivalent.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Of course, gathering such features is not practical. Annotating a database of millions of movies is very costly, and annotating users with their likes and dislikes is pretty much impossible.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What happens instead is that we make the movie features and user features <i>parameters</i> of the model. We then ask users for a small number of movies that they like and we optimize the user features and movie features so that their dot product matches the known likes.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Even though we don’t tell the model what any of the features should mean, in practice, it turns out that after training the features do actually reflect meaningful semantics about the movie content.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:431/333;width:660px;" src="https://peterbloem.nl/files/transformers/movie-features.svg" width="431" height="333">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        The first two learned features from a basic matrix factorization model. The model had no access to any information about the content of the movies, only which users liked them. Note that movies are arranged from low-brow to high-brow horizontally, and from mainstream to quirky vertically. From [4].
    </figcaption>
</figure>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture12/"><i>this lecture</i></a><i> for more details on recommender systems. For now, this suffices as an explanation of how the dot product helps us to represent objects and their relations.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic principle at work in the self-attention. Let’s say we are faced with a sequence of words. To apply self-attention, we simply assign each word&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-16-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-287"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-288"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-289"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-290"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-291"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-292"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-293">t</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> in our vocabulary an <i>embedding vector</i>&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-17-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-295"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-296"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-297"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-299">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-300"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-301"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-302"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-303"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-304">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> (the values of which we’ll learn). This is what’s known as an <i>embedding layer</i> in sequence modeling. It turns the word sequence&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-18-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:12.697em;" id="MathJax-Span-305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:11.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1011.43em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-306"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-307"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-308"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-309"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-310"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-311"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-312">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-313"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-314"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-315"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-316"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-317"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-318">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-319"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-320"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-321"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-322"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-323"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-324">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-325"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-326"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-327"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-328"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-329"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-330">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-331"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-332"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-333"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-334"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-335"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-336">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-337"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-338"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-339"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-340"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-341"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> into the vector sequence
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    &nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-19-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.294em;" id="MathJax-Span-342"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:12.86em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1012.86em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-343"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-344"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-345"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-346"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-347">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-348"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-349"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-350"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-351"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-352"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-353">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-354"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-355"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-356"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-357">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-358"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-359"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-360"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-361"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-362"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-363">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-364"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-365"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-366"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-367">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-368"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-369"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-370"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-371"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-372"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-373">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-374"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.353em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-375"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-376"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-377">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-378"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-379"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-380"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-381"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-382"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-383">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-384"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-385"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-386"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-387">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-388"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-389"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-390"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-391"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-392"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-393">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-394"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-395"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-396"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-397">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-398"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-399"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-400"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-401"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-402"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-403"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-404"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If we feed this sequence into a self-attention layer, the output is another sequence of vectors
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
    <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-20-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:14.662em;" id="MathJax-Span-405"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:13.188em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1013.19em, 2.746em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-406"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-407"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-408"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-409"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-410">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-411"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-412"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-413"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-414"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-415"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-416">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-417"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-418"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-419"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-420">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-421"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-422"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-423"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-424"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-425"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-426">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-427"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-428"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-429"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-430">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-431"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-432"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-433"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-434"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-435"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-436">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-437"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-438"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-439"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-440">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-441"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-442"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-443"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-444"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-445"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">on</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-446">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-447"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-448"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-449"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-450">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-451"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-452"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-453"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-454"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-455"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-456">,</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-457"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-458"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-459"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-460">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-461"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-462"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-463"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-464"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-465"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">street</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
    where&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-21-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-466"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.56em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-467"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-468"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-469"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-470"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-471">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-472"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-473"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-474"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-475"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-476"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> is a weighted sum over all the embedding vectors in the first sequence, weighted by their (normalized) dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-22-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-477"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-478"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-479"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-480"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-481"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-482">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-483"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-484"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-485"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-486"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-487"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>.
</p>
<p>
    &nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we are <i>learning</i> what the values in&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-23-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;" id="MathJax-Span-488"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.9em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-489"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-490"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-491"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-492"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-493">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-494"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-495"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-496"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-497"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-498">t</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> should be, how "related" two words are is entirely determined by the task. In most cases, the definite article <span style="color:rgb(48,102,147);"><span class="bc">the</span></span> is not very relevant to the interpretation of the other words in the sentence; therefore, we will likely end up with an embedding&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-24-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;" id="MathJax-Span-499"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.52em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-500"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-501"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-502"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-503"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-504">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-505"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-506"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-507"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-508"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-509"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">the</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that has a low or negative dot product with all other words. On the other hand, to interpret what <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span> means in this sentence, it's very helpful to work out <i>who</i> is doing the walking. This is likely expressed by a noun, so for nouns like <span style="color:rgb(48,102,147);"><span class="bc">cat</span></span> and verbs like <span style="color:rgb(48,102,147);"><span class="bc">walks</span></span>, we will likely learn embeddings&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-25-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-510"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-511"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-512"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-513"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-514"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-515">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-516"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-517"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-518"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-519"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-520"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-26-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-521"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-522"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-523"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-524"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-525"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-526">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-527"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-528"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-529"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-530"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-531"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">walks</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> that have a high, positive dot product together.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is the basic intuition behind self-attention. The dot product expresses how related two vectors in the input sequence are, with “related” defined by the learning task, and the output vectors are weighted sums over the whole input sequence, with the weights determined by these dot products.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before we move on, it’s worthwhile to note the following properties, which are unusual for a sequence-to-sequence operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            There are no parameters (yet). What the basic self-attention actually does is entirely determined by whatever mechanism creates the input sequence. Upstream mechanisms, like an embedding layer, drive the self-attention by learning representations with particular dot products (although we’ll add a few parameters later).
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
            Self attention sees its input as a <i>set</i>, not a sequence. If we permute the input sequence, the output sequence will be exactly the same, except permuted also (i.e. self-attention is <i>permutation equivariant</i>). We will mitigate this somewhat when we build the full transformer, but the self-attention by itself actually <i>ignores</i> the sequential nature of the input.
        </p>
    </li>
</ul>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-basic-self-attention">
    In Pytorch: basic self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    What I cannot create, I do not understand, as Feynman said. So we’ll build a simple transformer as we go along. We’ll start by implementing this basic self-attention operation in Pytorch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first thing we should do is work out how to express the self attention in matrix multiplications. A naive implementation that loops over all vectors to compute the weights and outputs would be much too slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ll represent the input, a sequence of&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-27-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-532"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-533"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-534">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> vectors of dimension&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-28-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-535"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-536"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-537">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> as a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-29-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-538"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-539"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-540">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-30-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-541"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-542"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-543">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-31-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-544"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-545"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-546"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-547"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-548">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. Including a minibatch dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-32-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-549"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.49em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-550"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-551">b</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, gives us an input tensor of size <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-33-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.606em;" id="MathJax-Span-552"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.237em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1003.11em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-553"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-554">(</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-555">b</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-556">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-557">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-558">,</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-559">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-560">)</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The set of all raw dot products&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-34-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-561"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-562"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-563"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-564">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-565">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-566"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-567"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-568"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-569"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-570"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-571"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-572">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-573"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-574"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-575"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-576"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-577">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> forms a matrix, which we can compute simply by multiplying&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-35-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-578"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-579"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-580"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-581"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-582">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by its transpose:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs makefile" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
import torch.nn.functional as F
# assume we have some tensor x with size (b, t, k)
x = ...
raw_weights = torch.bmm(x, x.transpose(1, 2))
# - torch.bmm is a batched matrix multiplication. It
#   applies matrix multiplication over batches of
#   matrices.</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Then, to turn the raw weights&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-36-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;" id="MathJax-Span-583"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.39em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-584"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-585"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-586">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-587">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-588"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-589"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-590"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-591"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-592"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-593"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-594">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-595"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-596"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-597"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-598"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-599">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> into positive values that sum to one, we apply a <i>row-wise</i> softmax:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">weights = F.softmax(raw_weights, dim=2)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, to compute the output sequence, we just multiply the weight matrix by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-37-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-600"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-601"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-602"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-603"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-604">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. This results in a batch of output matrices&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-38-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-605"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-606"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-607"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-608"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-609">𝐘<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.084em;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> of size <code style="font-family:Consolas, monospace;font-size:0.8em;">(b, t, k)</code> whose rows are weighted sums over the rows of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-39-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.821em;" id="MathJax-Span-610"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.7em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-611"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-612"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-613"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-614">𝐗</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ini" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">y = torch.bmm(weights, x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
That’s all. Two matrix multiplications and one softmax gives us a basic self-attention.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="additional-tricks">
Additional tricks
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The actual self-attention used in modern transformers relies on three additional tricks.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="1-queries-keys-and-values">
1) Queries, keys and values
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Every input vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-40-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-615"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-616"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-617"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-618"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-619"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-620">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-621"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-622"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-623"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-624"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-625">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> is used in three different ways in the self attention operation:
</p>
<ul style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;list-style:none;margin-bottom:1em;margin-right:auto;margin-top:0px;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for its own output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-41-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-626"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-627"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-628"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-629"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-630"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-631">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-632"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-633"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-634"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-635"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-636">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.361em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is compared to every other vector to establish the weights for the output of the <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-42-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;" id="MathJax-Span-637"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.33em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.21em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-638"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-639"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-640"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-641"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-642"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-643">j</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>-th vector&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-43-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;" id="MathJax-Span-644"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.99em, 2.664em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-645"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-646"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-647"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-648"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-649">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-650"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-651"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-652"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-653"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-654">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.543em;width:0px;"></span></span></nobr></span></span>
        </p>
    </li>
    <li style="list-style:none;padding-left:3em;position:relative;">
        <p style="margin-left:auto;">
It is used as part of the weighted sum to compute each output vector once the weights have been established.
        </p>
    </li>
</ul>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
These roles are often called the <strong>query</strong>, the <strong>key</strong> and the <strong>value</strong> (we'll explain where these names come from later). In the basic self-attention we've seen so far, each input vector must play all three roles. We make its life a little easier by deriving new vectors for each role, by applying a linear transformation to the original input vector. In other words, we add three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-44-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-655"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-656"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-657">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-658">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-659">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> weight matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-45-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-660"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.64em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-661"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-662"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-663"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-664"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-665">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-666">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-46-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.804em;" id="MathJax-Span-667"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.6em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-668"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-669"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-670"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-671"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-672">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-673">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-47-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.722em;" id="MathJax-Span-674"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.56em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-675"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-676"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-677"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-678"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-679">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-680">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> and compute three linear transformations of each <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-48-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-681"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-682"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-683"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-684">x</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-685"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-686"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-687"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-688"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-689">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span>, for the three different parts of the self attention:
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-49-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:20.149em;" id="MathJax-Span-690"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:18.143em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1018.14em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-691"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-692"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:17.815em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-693"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-694"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-695"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-696"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-697"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-698">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-699"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-700"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-701"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-702"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-703">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.769em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.77em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-704"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-705"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-706"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-707">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-708"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-709"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-710"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-711">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-712">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-713"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-714"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-715"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-716">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-717"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-718"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-719"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-720"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-721">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;left:6.677em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-722"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-723"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-724"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.944em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-725"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-726"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-727">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-728"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-729"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-730"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-731"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-732">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:7.619em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.729em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.73em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-733"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-734"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-735"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-736">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-737"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-738"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-739"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-740">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-741">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-742"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-743"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-744"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-745">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-746"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-747"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-748"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-749"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-750">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;left:13.27em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.86em, 4.302em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-751"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-752"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-753"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-754"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-755"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-756">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-757"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-758"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-759"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-760"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-761">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:14.13em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1003.69em, 4.302em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-762"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-763"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-764"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-765">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-766"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.558em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-767"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-768"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-769">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-770">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-771"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-772"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-773"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-774">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-775"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-776"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-777"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-778"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-779">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>
</div>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-50-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:9.257em;" id="MathJax-Span-780"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:8.315em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(-1.104em, 1008.19em, 4.793em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-781"><span class="mtable" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-782"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.166em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:7.987em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.377em, 1001.39em, 6.964em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-5.362em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.39em, 4.629em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-783"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-784"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-785"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-786">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-787">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-788"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-789"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-790"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-791"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-792"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-793"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-794">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-795"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-796"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-797"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-798"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-799">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1001.39em, 4.466em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-826"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-827"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-828"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-829">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-830"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-831"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-832"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-833"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-834"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-835"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-836">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-837"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-838"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-839"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-840"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-841">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.99em, 4.425em, -999.998em);display:inline;line-height:normal;margin:0px;padding:0px;position:absolute;right:0em;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-864"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-865"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-866"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-867"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-868"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-869">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-870"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-871"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-872"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-873"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-874">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:5.367em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1006.47em, 9.339em, -999.998em);display:inline;left:1.394em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.632em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:6.595em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1003.65em, 4.466em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-6.181em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-800"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-801"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-802"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-803">=</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-804"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-805"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-806"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-807"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-808"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-809"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-810">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-811"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-812"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-813"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-814"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-815">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-816">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-817"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-818"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-819"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-820">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-821"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-822"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-823"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-824"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-825">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.991em, 1006.47em, 4.629em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.502em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-842"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-843"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-844"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-845">=</span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-846"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">softmax</span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-847">(</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-848"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-849">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-850">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-851"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-852"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-853"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-854"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-855"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-856"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-857">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-858"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-859"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-860"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-861"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-862">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-863">)</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1005.49em, 5.489em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.783em;transition:none;vertical-align:0px;"><span class="mtd" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-875"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-876"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-877"></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-878">=</span><span class="munderover" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-879"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(2.95em, 1001.35em, 4.588em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Size1;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.244em;" id="MathJax-Span-880">∑</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.17em, 4.384em, -999.998em);display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.905em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-881"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-882"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-883"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-884"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-885">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-886"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-887">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-888"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-889"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-890"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-891"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-892"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-893"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-894">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-895"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-896"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-897"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-898"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-899">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-900"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-901"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-902"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-903">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-904"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-905"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-906"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-907"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-908">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mspace" style="border-width:0px;box-sizing:content-box;display:inline-block;height:0em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.166em;" id="MathJax-Span-909"></span><span class="mtext" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-910"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">.</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:6.636em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:6.366em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-2.907em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This gives the self-attention layer some controllable parameters, and allows it to modify the incoming vectors to suit the three roles they must play.
</p>
<p>
<img class="image_resized" style="aspect-ratio:873/724;width:660px;" src="https://peterbloem.nl/files/transformers/key-query-value.svg" width="873" height="724">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
Illustration of the self-attention with <span style="color:rgb(48,102,147);"><span class="bc">key</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">query</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">value</span></span> transformations.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="2-scaling-the-dot-product">
2) Scaling the dot product
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
The softmax function can be sensitive to very large input values. These kill the gradient, and slow down learning, or cause it to stop altogether. Since the average value of the dot product grows with the embedding dimension <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-51-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-911"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-912"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-913">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, it helps to scale the dot product back a little to stop the inputs to the softmax function from growing too large:
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
&nbsp;
</p>
<div class="MathJax_Display" style="display:block !important;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;position:relative;text-align:center;text-indent:0px;width:660px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-52-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:6.063em;" id="MathJax-Span-914"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.448em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.412em, 1005.45em, 3.196em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-915"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-916"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.442em, 1000.78em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-917">w</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.483em, 1000.33em, 4.097em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Variants;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-918">′</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.58em, 4.302em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-919"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-920"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-921"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-922"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-923"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-924"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-925">i</span></span></span></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-926"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-927"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-928"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-929"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-930">j</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-931">=</span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-932"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1002.42em, 4.466em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -1.186em;padding:0px;position:absolute;text-decoration:none;top:-4.748em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-933"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-934"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.99em, 4.425em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-935"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-936"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-937"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.36em, 1000.58em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-938"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-939"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-940">𝐪</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.724em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-941"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-942"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-943"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-944"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-945">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-946">T<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-947"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.903em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.62em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-948"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-949"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-950">𝐤<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-951"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-952"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-953"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-954"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(103, 125, 0);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-955">j</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.032em, 1001.43em, 4.261em, -999.998em);display:inline;left:31.0156px;line-height:normal;margin:0px 0px 0px -0.694em;padding:0px;position:absolute;text-decoration:none;top:-3.233em;transition:none;vertical-align:0px;"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-956"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-957"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-958">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.58em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.121em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.888em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1002.54em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:2.541em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:2.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-1.089em;width:0px;"></span></span></nobr></span></span>
</div>
<p>
&nbsp;
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>Why </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-53-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.605em;" id="MathJax-Span-959"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.43em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-960"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-961"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-962"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-963">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>? Imagine a vector in&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-54-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.204em;" id="MathJax-Span-964"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.982em, 1001.07em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-965"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-966"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-967"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-968"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.071em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.204em, 1000.58em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-969"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-970"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-971"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:20.2198px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.581em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.539em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-972">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.436em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> with values all </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-55-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.537em;" id="MathJax-Span-973"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.492em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.516em, 1000.45em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-974"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-975">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.645em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i>. Its Euclidean length is </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-56-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.139em;" id="MathJax-Span-976"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.917em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.87em, 2.407em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-977"><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-978"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.427em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-979"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-980">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.609em, 1000.58em, 3.92em, -999.998em);display:inline;left:0.848em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.584em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.581em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.042em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.131em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.896em, 1000.85em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-981">c</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.189em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.195em;width:0px;"></span></span></nobr></span></i></span><i>. Therefore, we are dividing out the amount by which the increase in dimension increases the length of the average vectors.</i>
    </p>
</aside>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="3-multi-head-attention">
3) Multi-head attention
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Finally, we must account for the fact that a word can mean different things to different neighbours. Consider the following example.
</p>
<div class="MathJax_Display" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);display:block !important;font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:1em 0em;max-height:none;max-width:none;min-height:0px;min-width:0px;orphans:2;position:relative;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:748px;word-spacing:0px;">
<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:center;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-57-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:11.959em;" id="MathJax-Span-982"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:10.772em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1010.77em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-983"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-984"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-985"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-986"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-987"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-988"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-989">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-990"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-991"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-992"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-993"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-994"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-995">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-996"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-997"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-998"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-999"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1000"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">roses</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1001">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1002"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1003"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1004"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1005"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1006"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">to</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1007">,</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.166em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1008"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1009"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1010"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1011"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1012"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:21.978px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.32em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We see that the word <span style="color:rgb(48,102,147);"><span class="bc">gave</span></span> has different relations to different parts of the sentence. <span style="color:rgb(48,102,147);"><span class="bc">mary</span></span> expresses who’s doing the giving, <span style="color:rgb(48,102,147);"><span class="bc">roses</span></span> expresses what’s being given, and <span style="color:rgb(48,102,147);"><span class="bc">susan</span></span> expresses who the recipient is.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
In a single self-attention operation, all this information just gets summed together. The inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-58-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.336em;" id="MathJax-Span-1013"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.09em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1014"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1015"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1016"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1017"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1018">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1019"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1020"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1021"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1022"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1023"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">mary</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-59-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1024"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1025"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1026"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1027"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1028"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1029">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1030"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1031"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1032"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1033"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1034"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> can influence the output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-60-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1035"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1036"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1037"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1038"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1039"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1040">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1041"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1042"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1043"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1044"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1045"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> by different amounts, depending on their dot-product with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-61-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.09em;" id="MathJax-Span-1046"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.89em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1047"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1048"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1049"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1050"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1051">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1052"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1053"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1054"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1055"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1056"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, but they can’t influence it <i>in different ways</i>. If, for instance, we want the information about who gave the roses and who received them to end up in different parts of <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-62-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.254em;" id="MathJax-Span-1057"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.01em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1058"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1059"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.009em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1060"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1061"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1062">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1063"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1064"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1065"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1066"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1067"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">gave</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we need a little more flexibility.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>This leaves aside how we figure out who gave the roses. We can do that based on prior knowledge about Mary and Susan, encoded in the embeddings. We can also look at the order of the words, but we'll look at how to achieve that later.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can give the self attention greater power of discrimination, by combining several self-attention mechanisms (which we'll index with <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-63-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;" id="MathJax-Span-1068"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1069"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1070"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1071"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1072"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1073"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1074">r</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>), each with different matrices <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-64-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1075"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1076"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1077"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1078"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1079"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1080">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1081"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1082"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1083"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1084"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1085">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.524em, 1000.49em, 4.302em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1086">q</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.411em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.498em;width:0px;"></span></span></nobr></span></span>, <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-65-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1087"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1088"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1089"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1090"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1091"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1092">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1093"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1094"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1095"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1096"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1097">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.49em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1098">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>,<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-66-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.845em;" id="MathJax-Span-1099"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1001.64em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1100"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1101"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.64em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1001.19em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1102"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1103"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1104">𝐖<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.043em;"></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:1.231em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1105"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1106"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1107"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1108"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1109">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.41em, 4.138em, -999.998em);display:inline;left:1.108em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1110">v</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span>. These are called <i>attention heads</i>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
For input&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-67-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1111"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1000.86em, 2.377em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1112"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1113"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1114"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1115"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1116">𝐱</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.847em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1117"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1118"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1119"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1120"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1121">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.225em;width:0px;"></span></span></nobr></span></span> each attention head produces a different output vector <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-68-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.19em;" id="MathJax-Span-1122"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.07em, 2.541em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1123"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1124"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.384em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1125"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1126"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1127">𝐲</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.565em, 1000.37em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.339em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1128"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1129"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1130"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1131"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1132">r</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.33em, 4.138em, -999.998em);display:inline;left:0.657em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1133"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1134"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1135"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1136"><span class="mi" style="border-width:0px;box-sizing:content-box;color:rgb(177, 62, 38);display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1137">i</span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.23em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.407em;width:0px;"></span></span></nobr></span></span>. We concatenate these, and pass them through a linear transformation to reduce the dimension back to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-69-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1138"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1139"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1140">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
<strong>Efficient multi-head self-attention.</strong> The simplest way to understand multi-head self-attention is to see it as a small number of copies of the self-attention mechanism applied in parallel, each with their own key, value and query transformation. This works well, but for&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-70-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1141"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1142"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1143">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> heads, the self-attention operation is&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-71-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;" id="MathJax-Span-1144"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.616em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1145"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1146">R</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> times as slow.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
It turns out we can have our cake and eat it too: there is a way to implement multi-head self-attention so that it is roughly as fast as the single-head version, but we still get the benefit of having different self-attention operations in parallel. To accomplish this, each head receives low-dimensional keys queries and values. If the input vector has&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-72-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:3.688em;" id="MathJax-Span-1147"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.319em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.28em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1148"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1149">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1150">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1151">256</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> dimensions, and we have&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-73-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.664em;" id="MathJax-Span-1152"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.377em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.34em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1153"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1154">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1155">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1156">4</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> attention heads, we multiply the input vectors by a&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-74-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1157"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1158"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1159">256</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1160">×</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1161">64</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix to project them down to a sequence of 64 dimansional vectors. For every head, we do this 3 times: for the keys, the queries and the values.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Here is the whole process illustrated in one image.
</p>
<p>
<img class="image_resized" style="aspect-ratio:1057/648;width:660px;" src="https://peterbloem.nl/files/transformers/multi-head.svg" alt="A diagram showing the operation of multi-head self-attention." width="1057" height="648">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
The basic idea of multi-head self-attention with 4 heads. To get our <span style="color:rgb(48,102,147);"><span class="bc">keys</span></span>, <span style="color:rgb(177,62,38);"><span class="rc">queries</span></span> and <span style="color:rgb(103,125,0);"><span class="gc">values</span></span>, we project the input down to vector sequences of smaller dimension.
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
This requires&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-75-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;" id="MathJax-Span-1162"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.11em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1163"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1164">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1165">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrices of size&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-76-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;" id="MathJax-Span-1166"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.58em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1167"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1168">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> by <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-77-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.886em;" id="MathJax-Span-1169"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.681em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1001.68em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1170"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1171">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1172"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1173"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1174">/</span></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1175">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.093em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span>. In total, this gives us&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-78-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:5.94em;" id="MathJax-Span-1176"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:5.326em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.149em, 1005.33em, 2.623em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1177"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1178">3</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1179">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1180">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mfrac" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1181"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px 0.125em;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.41em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-4.421em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1182">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.45em, 4.138em, -999.998em);display:inline;left:7.01562px;line-height:normal;margin:0px 0px 0px -0.203em;padding:0px;position:absolute;text-decoration:none;top:-3.643em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1183">h<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(0.903em, 1000.58em, 1.19em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-1.267em;transition:none;vertical-align:0px;"><span style="border-bottom-style:initial;border-bottom-width:0px;border-color:initial;border-image:initial;border-left-style:initial;border-left-width:0px;border-right-style:initial;border-right-width:0px;border-top-style:solid;border-top-width:1.5px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0em;width:0.575em;"></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1.067em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1184">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1185">3</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1186"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.067em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.58em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1187">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1188">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.502em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.452em;width:0px;"></span></span></nobr></span></span> parameters to compute the inputs to the multi-head self-attention: the same as we had for the single-head self-attention.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
<i>The only difference is the matrix </i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-79-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1189"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1190"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1191"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1192">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1193">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i>, used at the end of the multi-head self attention. This adds&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-80-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.16em;" id="MathJax-Span-1194"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.16em, 1001.03em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1195"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1196"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.026em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1000.58em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1197">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.626em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.361em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1198">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.09em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></i></span><i> parameters compared to the single-head version. In most transformers, the first thing that happens after each self attention is a feed-forward layer, so this may not be strictly necessary. I've never seen a proper ablation to test whether&nbsp;</i><span style="font-size:20.24px;"><i><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-81-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.65em;" id="MathJax-Span-1199"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1001.47em, 2.451em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1200"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1201"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.472em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.208em, 1001.07em, 4.143em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.005em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1202">W<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.091em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.982em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.871em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:15.8837px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1203">o</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.01em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.04em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.245em;width:0px;"></span></span></nobr></span></i></span><i> can be removed.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
We can even implement this with just three&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-82-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.541em;" id="MathJax-Span-1204"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1002.29em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1205"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1206">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1207">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1208">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> matrix multiplications as in the single-head self-attention. The only extra operation we need is to slice the resulting sequence of vectors into chunks.
</p>
<figure class="narrow centering" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <figure class="image image_resized" style="width:495px;">
<img class="three-quarters" style="aspect-ratio:489/789;display:block;margin:0px auto;min-width:150px;" src="https://peterbloem.nl/files/transformers/kqv-computation.svg" alt="A diagram showing the efficient computation of key query and value matrices in multi-head self-attention." width="489" height="789">
    </figure>
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
To compute multi-head attention efficiently, we combine the computation of the projections down to a lower dimensional representation and the computations of the keys, queries and values into three&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-83-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.585em;" id="MathJax-Span-1209"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.318em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.338em, 1002.32em, 2.273em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1210"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1211">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1212">×</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.225em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1213">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.892em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.047em;width:0px;"></span></span></nobr></span></span> matrices.
    </figcaption>
</figure>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="in-pytorch-complete-self-attention">
In Pytorch: complete self-attention
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
Let’s now implement a self-attention module with all the bells and whistles. We’ll package it into a Pytorch module, so we can reuse it later.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">import torch
from torch import nn
import torch.nn.functional as F
class SelfAttention(nn.Module):
    def __init__(self, k, heads=4, mask=False):
      
    super().__init__()
    
    assert k % heads == 0
    
    self.k, self.heads = k, heads
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note the assert: the embedding dimension needs to be divisible by the number of heads.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we set up some linear transformations with <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">emb</code> matrices. The <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">nn.Linear</code> module with the bias disabled gives us such a projection, and provides a reasonable initialization for us.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # These compute the queries, keys and values for all
    # heads
    self.tokeys    = nn.Linear(k, k, bias=False)
    self.toqueries = nn.Linear(k, k, bias=False)
    self.tovalues  = nn.Linear(k, k, bias=False)
	# This will be applied after the multi-head self-attention operation.
    self.unifyheads = nn.Linear(k, k)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We can now implement the computation of the self-attention (the module’s <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">forward</code> function). First, we compute the queries, keys and values for all heads:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">  def forward(self, x):
    b, t, k = x.size()
    h = self.heads
    queries = self.toqueries(x)
    keys    = self.tokeys(x)   
    values  = self.tovalues(x)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This gives us three vector sequences of the full embedding dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. As we saw above we can now cut these into <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> chunks. we can do this with a simple view operation:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">
	s = k // h
	keys    = keys.view(b, t, h, s)
	queries = queries.view(b, t, h, s)
	values  = values.view(b, t, h, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This simply reshapes the tensors to add a dimension that iterations over the heads. For a single vector in our sequence you can think of it as reshaping a vector of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k</code> into a matrix of <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">h</code> by <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">k//h</code>:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:882/519;width:660px;" src="https://peterbloem.nl/files/transformers/reshape.svg" width="882" height="519">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Next, we need to compute the dot products. This is the same operation for every head, so we fold the heads into the batch dimension. This ensures that we can use <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">torch.bmm()</code> as before, and the whole collection of keys, queries and values will just be seen as a slightly larger batch.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since the head and batch dimension are not next to each other, we need to transpose before we reshape. (This is costly, but it seems to be unavoidable.)
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # - fold heads into the batch dimension
    keys = keys.transpose(1, 2).contiguous().view(b * h, t, s)
    queries = queries.transpose(1, 2).contiguous().view(b * h, t, s)
    values = values.transpose(1, 2).contiguous().view(b * h, t, s)
</code></pre>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>You can avoid these calls to </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>contiguous()</i></code><i> by using </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>reshape()</i></code><i> instead of </i><code style="font-family:Consolas, monospace;font-size:0.8em;"><i>view()</i></code><i> but I prefer to make it explicit when we are copying a tensor, and when we are just viewing it. See </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/mlvu/worksheets/blob/master/Worksheet%205%2C%20Pytorch.ipynb"><i>this notebook</i></a><i> for an explanation of the difference.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As before, the dot products can be computed in a single matrix multiplication, but now between the queries and the keys.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">   
    # Get dot product of queries and keys, and scale
    dot = torch.bmm(queries, keys.transpose(1, 2))
    # -- dot has size (b*h, t, t) containing raw weights
    # scale the dot product
    dot = dot / (s ** (1/2))
	
    # normalize 
    dot = F.softmax(dot, dim=2)
    # - dot now contains row-wise normalized weights
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We apply the self attention weights <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">dot</code> to the values, giving us the output for each attention head
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    
    # apply the self attention to the values
    out = torch.bmm(dot, values).view(b, h, t, s)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To unify the attention heads, we transpose again, so that the head dimension and the embedding dimension are next to each other, and reshape to get concatenated vectors of dimension <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">e</code>. We then pass these through the <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">unifyheads</code> layer for a final projection.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">    # swap h, t back, unify heads
    out = out.transpose(1, 2).contiguous().view(b, t, s * h)
    
    return self.unifyheads(out)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And there you have it: multi-head, scaled dot-product self attention. You can see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/b438731ceeaf6c468f8b961bb07c2adde3b54a9f/former/modules.py#L10">the complete implementation here</a>.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The implementation can be made more concise using </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://rockt.github.io/2018/04/30/einsum"><i>einsum notation</i></a><i> (see an example </i><a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/4"><i>here</i></a><i>).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="building-transformers">
    Building <i>transformers</i>
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    A transformer is not just a self-attention layer, it is an <i>architecture</i>. It’s not quite clear what does and doesn’t qualify as a transformer, but here we’ll use the following definition:
</p>
<blockquote style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, Helvetica, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px 0px 0px 4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        Any architecture designed to process a connected set of units—such as the tokens in a sequence or the pixels in an image—where the only interaction between units is through self-attention.
    </p>
</blockquote>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    As with other mechanisms, like convolutions, a more or less standard approach has emerged for how to build self-attention layers up into a larger network. The first step is to wrap the self-attention into a <i>block</i> that we can repeat.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-transformer-block">
    The transformer block
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    There are some variations on how to build a basic transformer block, but most of them are structured roughly like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1090/473;width:660px;" src="https://peterbloem.nl/files/transformers/transformer-block.svg" width="1090" height="473">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    That is, the block applies, in sequence: <span style="color:rgb(103,125,0);"><span class="gc">a self attention layer,</span></span> <span style="color:rgb(177,62,38);"><span class="rc">layer normalization</span></span>, <span style="color:rgb(103,125,0);"><span class="gc">a feed forward layer</span></span> (a single <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="multi-layer perceptron">MLP</abbr> applied independently to each vector), and <span style="color:rgb(177,62,38);"><span class="rc">another layer normalization</span></span>. <span style="color:rgb(48,102,147);"><span class="bc">Residual connections</span></span> are added around both, before the normalization. The order of the various components is not set in stone; the important thing is to combine self-attention with a local feedforward, and to add normalization and residual connections.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>Normalization and residual connections are standard tricks used to help deep neural networks train faster and more accurately. The layer normalization is applied over the embedding dimension only.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s what the transformer block looks like in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext hljs ruby" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class TransformerBlock(nn.Module):
  def __init__(self, k, heads):
    super().__init__()
    self.attention = SelfAttention(k, heads=heads)
    self.norm1 = nn.LayerNorm(k)
    self.norm2 = nn.LayerNorm(k)
    self.ff = nn.Sequential(
      nn.Linear(k, 4 * k),
      nn.ReLU(),
      nn.Linear(4 * k, k))
  def forward(self, x):
    attended = self.attention(x)
    x = self.norm1(attended + x)
    fedforward = self.ff(x)
    return self.norm2(fedforward + x)</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve made the relatively arbitrary choice of making the hidden layer of the feedforward 4 times as big as the input and output. Smaller values may work as well, and save memory, but it should be bigger than the input/output layers.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="classification-transformer">
    Classification transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The simplest transformer we can build is a <i>sequence classifier</i>. We’ll use the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Internet Movie Database">IMDb</abbr> sentiment classification dataset: the instances are movie reviews, tokenized into sequences of words, and the classification labels are <span style="color:rgb(48,102,147);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="bc">positive</span></code></span> and <span style="color:rgb(177,62,38);"><code style="font-family:Consolas, monospace;font-size:0.8em;"><span class="rc">negative</span></code></span> (indicating whether the review was positive or negative about the movie).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The heart of the architecture will simply be a large chain of transformer blocks. All we need to do is work out how to feed it the input sequences, and how to transform the final output sequence into a a single classification.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole experiment can be <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/blob/master/experiments/classify.py">found here</a>. We won’t deal with the data wrangling in this blog post. Follow the links in the code to see how the data is loaded and prepared.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="output-producing-a-classification">
    Output: producing a classification
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The most common way to build a sequence classifier out of sequence-to-sequence layers, is to apply global average pooling to the final output sequence, and to map the result to a softmaxed class vector.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1039/460;width:660px;" src="https://peterbloem.nl/files/transformers/classifier.svg" width="1039" height="460">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Overview of a simple sequence classification transformer. The output sequence is <span style="color:rgb(48,102,147);"><span class="bc">averaged</span></span> to produce a single vector representing the whole sequence. This vector is projected down to a vector with one element per class and softmaxed to produce probabilities.
    </figcaption>
</figure>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="input-using-the-positions">
    Input: using the positions
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We’ve already discussed the principle of an embedding layer. This is what we’ll use to represent the words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    However, as we’ve also mentioned already, we’re stacking permutation equivariant layers, and the final global average pooling is permutation <i>in</i>variant, so the network as a whole is also permutation invariant. Put more simply: if we shuffle up the words in the sentence, we get the exact same classification, whatever weights we learn. Clearly, we want our state-of-the-art language model to have at least some sensitivity to word order, so this needs to be fixed.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The solution is simple: we create a second vector of equal length, that represents the position of the word in the current sentence, and add this to the word embedding. There are two options.
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position embeddings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            We simply <i>embed</i> the positions like we did the words. Just like we created embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-84-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1214"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.43em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1215"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1216"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1217"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1218"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1219">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1220"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1221"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1222"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1223"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1224"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">cat</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-85-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.459em;" id="MathJax-Span-1225"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1002.21em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1226"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1227"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.213em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1228"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1229"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1230">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1231"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1232"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1233"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1234"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1235"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">susan</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>, we create embedding vectors&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-86-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.394em;" id="MathJax-Span-1236"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.23em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1237"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1238"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.231em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1239"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1240"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1241">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1242"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1243"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1244"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1245"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1246"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">12</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span> and <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-87-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.476em;" id="MathJax-Span-1247"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.476em, 1001.31em, 2.705em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1248"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1249"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.312em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.53em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1250"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1251"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1252">𝐯</span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.534em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.683em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1253"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1254"><span class="mstyle" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1255"><span class="mrow" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1256"><span class="mtext" style="border-width:0px;box-sizing:content-box;color:rgb(48, 102, 147);display:inline;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1257"><span style="border-width:0px;box-sizing:content-box;display:inline;font-size:15.5384px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">25</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.589em;width:0px;"></span></span></nobr></span></span>. Up to however long we expect sequences to get. The drawback is that we have to see sequences of every length during training, otherwise the relevant position embeddings don't get trained. The benefit is that it works pretty well, and it's easy to implement.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>position encodings</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Position encodings work in the same way as embeddings, except that we don't <i>learn</i> the position vectors, we just choose some function&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-88-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.875em;" id="MathJax-Span-1258"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:4.384em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(0.985em, 1004.38em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1259"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1260">f<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1261">:</span><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1262"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1263"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1264"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1265"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1266"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℕ</span></span></span></span></span></span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1267">→</span><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1268"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.108em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.19em, 1000.62em, 2.459em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1269"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1270"><span class="texatom" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1271"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1272"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1273"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:STIXGeneral, &quot;Arial Unicode MS&quot;, serif;font-size:21.978px;font-style:normal;font-weight:normal;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">ℝ</span></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.616em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.543em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1274">k<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:1px;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.002em;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.457em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.27em;width:0px;"></span></span></nobr></span></span> to map the positions to real valued vectors, and let the network figure out how to interpret these encodings. The benefit is that for a well chosen function, the network should be able to deal with sequences that are longer than those it's seen during training (it's unlikely to perform well on them, but at least we can check). The drawbacks are that the choice of encoding function is a complicated hyperparameter, and it complicates the implementation a little.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For the sake of simplicity, we’ll use position embeddings in our implementation.
</p>
<h4 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="pytorch">
    Pytorch
</h4>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here is the complete text classification transformer in pytorch.
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">class Transformer(nn.Module):
    def __init__(self, k, heads, depth, seq_length, num_tokens, num_classes):
        super().__init__()
        self.num_tokens = num_tokens
        self.token_emb = nn.Embedding(num_tokens, k)
        self.pos_emb = nn.Embedding(seq_length, k)
		# The sequence of transformer blocks that does all the
		# heavy lifting
        tblocks = []
        for i in range(depth):
            tblocks.append(TransformerBlock(k=k, heads=heads))
        self.tblocks = nn.Sequential(*tblocks)
		# Maps the final output sequence to class logits
        self.toprobs = nn.Linear(k, num_classes)
    def forward(self, x):
        """
        :param x: A (b, t) tensor of integer values representing
                  words (in some predetermined vocabulary).
        :return: A (b, c) tensor of log-probabilities over the
                 classes (where c is the nr. of classes).
        """
		# generate token embeddings
        tokens = self.token_emb(x)
        b, t, k = tokens.size()
		# generate position embeddings
		positions = torch.arange(t)
        positions = self.pos_emb(positions)[None, :, :].expand(b, t, k)
        x = tokens + positions
        x = self.tblocks(x)
        # Average-pool over the t dimension and project to class
        # probabilities
        x = self.toprobs(x.mean(dim=1))
        return F.log_softmax(x, dim=1)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At depth 6, with a maximum sequence length of 512, this transformer achieves an accuracy of about 85%, competitive with results from RNN models, and much faster to train. To see the real near-human performance of transformers, we’d need to train a much deeper model on much more data. More about how to do that later.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="text-generation-transformer">
    Text generation transformer
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The next trick we’ll try is an <i>autoregressive</i> model. We’ll train a <i>character</i> level transformer to predict the next character in a sequence. The training regime is simple (and has been around <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">for far longer than transformers have</a>). We give the sequence-to-sequence model a sequence, and we ask it to predict the next character at each point in the sequence. In other words, the target output is the same sequence shifted one character to the left:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1122/458;width:660px;" src="https://peterbloem.nl/files/transformers/generator.svg" width="1122" height="458">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    With RNNs this is all we need to do, since they cannot look forward into the input sequence: output&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-89-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1275"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1276"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1277">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> depends only on inputs&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-90-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.575em;" id="MathJax-Span-1278"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.493em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.45em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1279"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1280">0</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-91-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1281"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1282"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1283">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>. With a transformer, the output depends on the entire input sequence, so prediction of the next character becomes vacuously easy, just retrieve it from the input.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To use self-attention as an autoregressive model, we’ll need to ensure that it cannot look forward into the sequence. We do this by applying a mask to the matrix of dot products, before the softmax is applied. This mask disables all elements above the diagonal of the matrix.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1014/366;width:660px;" src="https://peterbloem.nl/files/transformers/masked-attention.svg" width="1014" height="366">
</p>
<figure class="narrow" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;">
    <figcaption style="font-size:0.92em;line-height:1.875em;padding-left:2em;">
        Masking the self attention, to ensure that elements can only attend to input elements that precede them in the sequence. Note that the multiplication symbol is slightly misleading: we actually set the masked out elements (the white squares) to&nbsp;<span style="font-size:20.24px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-92-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.961em;" id="MathJax-Span-1284"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:22.4664px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.739em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.427em, 1001.69em, 2.362em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.135em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1285"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1286">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1287">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.139em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.843em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.146em;width:0px;"></span></span></nobr></span></span>
    </figcaption>
</figure>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Since we want these elements to be zero after the softmax, we set them to <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-93-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.968em;" id="MathJax-Span-1288"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.763em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.435em, 1001.72em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1289"><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1290">−</span><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1291">∞</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.82em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Here’s how that looks in pytorch:
</p>
<pre style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;widows:2;width:660px;word-spacing:0px;"><code class="language-plaintext python hljs" style="background-color:rgb(240, 240, 240);color:rgb(68, 68, 68);display:block;font-family:Consolas, monospace;font-size:0.8em;overflow-x:auto;padding:0.5em;">dot = torch.bmm(queries, keys.transpose(1, 2))
indices = torch.triu_indices(t, t, offset=1)
dot[:, indices[0], indices[1]] = float('-inf')
dot = F.softmax(dot, dim=2)
</code></pre>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After we’ve handicapped the self-attention module like this, the model can no longer look forward in the sequence.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on the standard <code class="language-plaintext highlighter-rouge" style="font-family:Consolas, monospace;font-size:0.8em;">enwik8</code> dataset (taken from the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://prize.hutter1.net/">Hutter prize</a>), which contains&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-94-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:1.599em;" id="MathJax-Span-1292"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.026em, 1001.43em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1293"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1294"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.435em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.196em, 1000.94em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1295">10</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.985em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1296">8</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.139em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> characters of Wikipedia text (including markup). During training, we generate batches by randomly sampling subsequences from the data.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    We train on sequences of length 256, using a model of 12 transformer blocks and 256 embedding dimension. After about 24 hours training on an RTX 2080Ti (some 170K batches of size 32), we let the model generate from <span style="color:rgb(115,167,211);"><span class="lbc">a 256-character seed</span></span>: for each character, we feed it the preceding 256 characters, and look what it predicts for the next character (the last output vector). We sample from that with a <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277">temperature</a> of 0.5, and move to the next character.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The output looks like this:
</p>
<div class="sample" style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Consolas, monospace;font-size:0.8em;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <span style="color:rgb(115,167,211);"><span class="lbc">1228X Human &amp; Rousseau. Because many of his stories were originally published in long-forgotten magazines and journals, there are a number of [[anthology|anthologies]] by different collators each containing a different selection. His original books ha</span></span>ve been considered an anthologie in the [[Middle Ages]], and were likely to be one of the most common in the [[Indian Ocean]] in the [[1st century]]. As a result of his death, the Bible was recognised as a counter-attack by the [[Gospel of Matthew]] (1177-1133), and the [[Saxony|Saxons]] of the [[Isle of Matthew]] (1100-1138), the third was a topic of the [[Saxony|Saxon]] throne, and the [[Roman Empire|Roman]] troops of [[Antiochia]] (1145-1148). The [[Roman Empire|Romans]] resigned in [[1148]] and [[1148]] began to collapse. The [[Saxony|Saxons]] of the [[Battle of Valasander]] reported the y
</div>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Note that the Wikipedia link tag syntax is correctly used, that the text inside the links represents reasonable subjects for links. Most importantly, note that there is a rough thematic consistency; the generated text keeps on the subject of the bible, and the Roman empire, using different related terms at different points. While this is far from the performance of a model like <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>, the benefits over a similar RNN model are clear already: faster training (a similar RNN model would take many days to train) and better long-term coherence.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>In case you're curious, the Battle of Valasander seems to be an invention of the network.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    At this point, the model achieves a compression of 1.343 bits per byte on the validation set, which is not too far off the state of the art of 0.93 bits per byte, achieved by the GPT-2 model (described below).
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="design-considerations">
    Design considerations
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To understand why transformers are set up this way, it helps to understand the basic design considerations that went into them. The main point of the transformer was to overcome the problems of the previous state-of-the-art architecture, the RNN (usually an LSTM or a GRU). <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Unrolled</a>, an RNN looks like this:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:940/301;width:660px;" src="https://peterbloem.nl/files/transformers/recurrent-connection.svg" width="940" height="301">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big weakness here is the <span style="color:rgb(48,102,147);"><span class="bc">recurrent connection</span></span>. while this allows information to propagate along the sequence, it also means that we cannot compute the cell at time step&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-95-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;" id="MathJax-Span-1297"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.371em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1000.37em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1298"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1299">i</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.866em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> until we’ve computed the cell at timestep <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-96-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.295em;" id="MathJax-Span-1300"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.05em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1001.85em, 2.336em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1301"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1302">i</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1303">−</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.207em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1304">1</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.957em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.134em;width:0px;"></span></span></nobr></span></span>. Contrast this with a 1D convolution:
</p>
<p>
    <img class="image_resized" style="aspect-ratio:968/347;width:660px;" src="https://peterbloem.nl/files/transformers/convolutional-connection.svg" width="968" height="347">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In this model, every output vector can be computed in parallel with every other output vector. This makes convolutions much faster. The drawback with convolutions, however, is that they’re severely limited in modeling <i>long range dependencies</i>. In one convolution layer, only words that are closer together than the kernel size can interact with each other. For longer dependence we need to stack many convolutions.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer is an attempt to capture the best of both worlds. They can model dependencies over the whole range of the input sequence just as easily as they can for words that are next to each other (in fact, without the position vectors, they can’t even tell the difference). And yet, there are no recurrent connections, so the whole model can be computed in a very efficient feedforward fashion.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The rest of the design of the transformer is based primarily on one consideration: depth. Most choices follow from the desire to train big stacks of transformer blocks. Note for instance that there are only two places in the transformer where non-linearities occur: the softmax in the self-attention and the <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="rectified linear unit">ReLU</abbr> in the feedforward layer. The rest of the model is entirely composed of linear transformations, which perfectly preserve the gradient.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>I suppose the layer normalization is also nonlinear, but that is one nonlinearity that actually helps to keep the gradient stable as it propagates back down the network.</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="historical-baggage">
    Historical baggage
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    If you’ve read other introductions to transformers, you may have noticed that they contain some bits I’ve skipped. I think these are not necessary to understand modern transformers. They are, however, helpful to understand some of the terminology and some of the writing <i>about</i> modern transformers. Here are the most important ones.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="why-is-it-called-self-attention">
    Why is it called self-<i>attention</i>?
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Before self-attention was first presented, sequence models consisted mostly of recurrent networks or convolutions stacked together. At some point, it was discovered that these models could be helped by adding <i>attention mechanisms</i>: instead of feeding the output sequence of the previous layer directly to the input of the next, an intermediate mechanism was introduced, that decided which elements of the input were relevant for a particular word of the output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The general mechanism was as follows. We call the input the <strong>values</strong>. Some (trainable) mechanism assigns a <strong>key</strong> to each value. Then to each output, some other mechanism assigns a <strong>query</strong>.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    These names derive from the datastructure of a key-value store. In that case we expect only one item in our store to have a key that matches the query, which is returned when the query is executed. Attention is a softened version of this: <i>every</i> key in the store matches the query to some extent. All are returned, and we take a sum, weighted by the extent to which each key matches the query.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The great breakthrough of self-attention was that attention by itself is a strong enough mechanism to do all the learning. <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1706.03762">Attention is all you need</a>, as the authors put it. The key, query and value are all the same vectors (with minor linear transformations). They <i>attend to themselves</i> and stacking such self-attention provides sufficient nonlinearity and representational power to learn very complicated functions.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="the-original-transformer-encoders-and-decoders">
    The original transformer: encoders and decoders
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    But the authors did not dispense with all the complexity of contemporary sequence modeling. The standard structure of sequence-to-sequence models in those days was an encoder-decoder architecture, with <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html">teacher forcing</a>.
</p>
<p>
    <img class="image_resized" style="aspect-ratio:1036/557;width:660px;" src="https://peterbloem.nl/files/transformers/encoder-decoder.svg" width="1036" height="557">
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The <i>encoder</i> takes the input sequence and maps it to a <i>latent</i> representation of the whole sequence. This can be either a sequence of latent vectors, or a single one as in the image above. This vector is then passed to a <i>decoder</i> which unpacks it to the desired target sequence (for instance, the same sentence in another language).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <i>Teacher forcing</i> refers to the technique of also allowing the decoder access to the input sentence, but in an autoregressive fashion. That is, the decoder generates the output sentence word for word based both on the latent vector and the words it has already generated. This takes some of the pressure off the latent representation: the decoder can use word-for-word sampling to take care of the low-level structure like syntax and grammar and use the latent vector to capture more high-level semantic structure. Decoding twice with the same latent representation would, ideally, give you two different sentences with the same meaning.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In later transformers, like BERT and GPT-2, the encoder/decoder configuration was entirely dispensed with. A simple stack of transformer blocks was found to be sufficient to achieve state of the art in many sequence based tasks.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This approach is sometimes called a decoder-only transformer (for an autoregressive model) or an encoder-only transformer (for a model without masking).</i>
    </p>
</aside>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="modern-transformers">
    Modern transformers
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Here’s a small selection of some modern transformers and their most characteristic details.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="bert">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1810.04805">BERT</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="Bidirectional Encoder Representations from Transformers">BERT</abbr> was one of the first models to show that transformers could reach human-level performance on a variety of language based tasks: question answering, sentiment classification or classifying whether two sentences naturally follow one another.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT consists of a simple stack of transformer blocks, of the type we’ve described above. This stack is <i>pre-trained</i> on a large general-domain corpus consisting of 800M words from English books (modern work, from unpublished authors), and 2.5B words of text from English Wikipedia articles (without markup).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Pretraining is done through two tasks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Masking</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            A certain number of words in the input sequence are: masked out, replaced with a random word or kept as is. The model is then asked to predict, for these words, what the original words were. Note that the model doesn't need to predict the entire denoised sentence, just the modified words. Since the model doesn't know which words it will be asked about, it learns a representation for every word in the sequence.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Next sequence classification</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Two sequences of about 256 words are sampled that either (a) follow each other directly in the corpus, or (b) are both taken from random places. The model must then predict whether a or b is the case.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    BERT uses WordPiece tokenization, which is somewhere in between word-level and character level sequences. It breaks words like <span style="color:rgb(48,102,147);"><span class="bc">walking</span></span> up into the tokens <span style="color:rgb(48,102,147);"><span class="bc">walk</span></span> and <span style="color:rgb(48,102,147);"><span class="bc">##ing</span></span>. This allows the model to make some inferences based on word structure: two verbs ending in -ing have similar grammatical functions, and two verbs starting with walk- have similar semantic function.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The input is prepended with a special <span style="color:rgb(48,102,147);"><span class="bc">&lt;cls&gt;</span></span> token. The output vector corresponding to this token is used as a sentence representation in sequence classification tasks like the next sentence classification (as opposed to the global average pooling over all vectors that we used in our classification model above).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    After pretraining, a single task-specific layer is placed after the body of transformer blocks, which maps the general purpose representation to a task specific output. For classification tasks, this simply maps the first output token to softmax probabilities over the classes. For more complex tasks, a final sequence-to-sequence layer is designed specifically for the task.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The whole model is then re-trained to finetune the model for the specific task at hand.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    In an ablation experiment, the authors show that the largest improvement as compared to previous models comes from the bidirectional nature of BERT. That is, previous models like GPT used an autoregressive mask, which allowed attention only over previous tokens. The fact that in BERT all attention is over the whole sequence is the main cause of the improved performance.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>This is why the B in BERT stands for "bidirectional".</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The largest BERT model uses 24 transformer blocks, an embedding dimension of 1024 and 16 attention heads, resulting in 340M parameters.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="gpt-2">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/better-language-models/">GPT-2</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <abbr style="border-bottom:1px dotted rgb(172, 211, 115);font-size:0.9em;text-decoration:none;" title="generative pre-trained transformer">GPT</abbr>-2 is the first transformer model that actually made it into <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://www.bbc.com/news/technology-47249163">the mainstream news</a>, after the controversial decision by OpenAI not to release the full model.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>The reason was that GPT-2 could generate sufficiently believable text that large-scale fake news campaigns of the kind seen in the 2016 US presidential election would become effectively a one-person job.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The first trick that the authors of GPT-2 employed was to create a new high-quality dataset. While BERT used high-quality data, their sources (lovingly crafted books and well-edited wikipedia articles) had a certain lack of diversity in the writing style. To collect more diverse data without sacrificing quality the authors used links posted on the social media site <i>Reddit</i> to gather a large collection of writing with a certain minimum level of social support (expressed on Reddit as <i>karma</i>).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is fundamentally a language <i>generation</i> model, so it uses masked self-attention like we did in our model above. It uses byte-pair encoding to tokenize the language, which , like the WordPiece encoding breaks words up into tokens that are slightly larger than single characters but less than entire words.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    GPT2 is built very much like our text generation model above, with only small differences in layer order and added tricks to train at greater depths. The largest model uses 48 transformer blocks, a sequence length of 1024 and an embedding dimension of 1600, resulting in 1.5B parameters.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    They show state-of-the art performance on many tasks. On the wikipedia compression task that we tried above, they achieve 0.93 bits per byte.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="transformer-xl">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1901.02860">Transformer-XL</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    While the transformer represents a massive leap forward in modeling long-range dependency, the models we have seen so far are still fundamentally limited by the size of the input. Since the size of the dot-product matrix grows quadratically in the sequence length, this quickly becomes the bottleneck as we try to extend the length of the input sequence. Transformer-XL is one of the first succesful transformer models to tackle this problem.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    During training, a long sequence of text (longer than the model could deal with) is broken up into shorter segments. Each segment is processed in sequence, with self-attention computed over the tokens in the curent segment <i>and the previous segment</i>. Gradients are only computed over the current segment, but information still propagates as the segment window moves through the text. In theory at layer <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-97-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1305"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1306"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1307">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, information may be used from&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-98-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.739em;" id="MathJax-Span-1308"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.657em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.517em, 1000.66em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1309"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1310">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.639em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> segments ago.
</p>
<aside style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:0.92em;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;line-height:1.875em;margin:0px auto 1em;orphans:2;padding-left:4em;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <p>
        <i>A similar trick in RNN training is called truncated backpropagation through time. We feed the model a very long sequence, but backpropagate only over part of it. The first part of the sequence, for which no gradients are computed, still influences the values of the hidden states in the part for which they are.</i>
    </p>
</aside>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    To make this work, the authors had to let go of the standard position encoding/embedding scheme. Since the position encoding is <i>absolute</i>, it would change for each segment and not lead to a consistent embedding over the whole sequence. Instead they use a <i>relative</i> encoding. For each output vector, a different sequence of position vectors is used that denotes not the absolute position, but the distance to the current output.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This requires moving the position encoding into the attention mechanism (which is detailed in the paper). One benefit is that the resulting transformer will likely generalize much better to sequences of unseen length.
</p>
<h3 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="sparse-transformers">
    <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://openai.com/blog/sparse-transformer/">Sparse transformers</a>
</h3>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Sparse transformers tackle the problem of quadratic memory use head-on. Instead of computing a dense matrix of attention weights (which grows quadratically), they compute the self-attention only for particular pairs of input tokens, resulting in a <i>sparse</i> attention matrix, with only&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-99-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:2.418em;" id="MathJax-Span-1311"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:2.172em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.271em, 1002.17em, 2.5em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1312"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1313">n</span><span class="msqrt" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1314"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:1.517em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.401em, 1000.66em, 4.138em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1315"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1316">n</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(3.606em, 1000.7em, 3.892em, -999.998em);display:inline;left:0.821em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.462em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.698em;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;left:-0.039em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;">−<span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;clip:rect(2.91em, 1000.86em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-3.765em;transition:none;vertical-align:0px;"><span style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;">√</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.184em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.316em;width:0px;"></span></span></nobr></span></span> explicit elements.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This allows models with very large context sizes, for instance for generative modeling over images, with large dependencies between pixels. The tradeoff is that the sparsity structure is not learned, so by the choice of sparse matrix, we are disabling some interactions between input tokens that might otherwise have been useful. However, two units that are not directly related may still interact in higher layers of the transformer (similar to the way a convolutional net builds up a larger receptive field with more convolutional layers).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Beyond the simple benefit of training transformers with very large sequence lengths, the sparse transformer also allows a very elegant way of designing an inductive bias. We take our input as a collection of units (words, characters, pixels in an image, nodes in a graph) and we specify, through the sparsity of the attention matrix, which units we believe to be related. The rest is just a matter of building the transformer up as deep as it will go and seeing if it trains.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="going-big">
    Going big
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The big bottleneck in training transformers is the matrix of dot products in the self attention. For a sequence length <span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-100-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.452em;" id="MathJax-Span-1317"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.412em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.394em, 1000.41em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1318"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1319">t</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.775em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span>, this is a dense matrix containing&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-101-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0.985em;" id="MathJax-Span-1320"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.108em, 1000.86em, 2.213em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.086em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1321"><span class="msubsup" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1322"><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:0.862em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(3.278em, 1000.41em, 4.138em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.011em;transition:none;vertical-align:0px;"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1323">t</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span><span style="border-width:0px;box-sizing:content-box;display:inline;left:0.412em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-4.38em;transition:none;vertical-align:0px;"><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;font-size:17.2649px;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1324">2</span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:4.015em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span></span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.09em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:1.048em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> elements. At standard 32-bit precision, and with&nbsp;<span style="font-size:22px;"><span class="MathJax" style="border-width:0px;direction:ltr;display:inline;float:none;font-size-adjust:none;font-style:normal;font-weight:normal;letter-spacing:normal;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;overflow-wrap:normal;padding:0px;text-align:left;text-indent:0px;text-transform:none;white-space:nowrap;word-spacing:normal;" id="MathJax-Element-102-Frame" tabindex="0"><nobr style="border-width:0px;line-height:normal;margin:0px;max-height:none;max-width:none;min-height:0px;min-width:0px;padding:0px;text-decoration:none;transition:none;vertical-align:0px;white-space:nowrap !important;"><span class="math" style="border-width:0px;box-sizing:content-box;display:inline-block;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:4.056em;" id="MathJax-Span-1325"><span style="border-width:0px;box-sizing:content-box;display:inline-block;font-size:24.42px;height:0px;line-height:normal;margin:0px;padding:0px;position:relative;text-decoration:none;transition:none;vertical-align:0px;width:3.647em;"><span style="border-width:0px;box-sizing:content-box;clip:rect(1.312em, 1003.61em, 2.254em, -999.998em);display:inline;left:0em;line-height:normal;margin:0px;padding:0px;position:absolute;text-decoration:none;top:-2.127em;transition:none;vertical-align:0px;"><span class="mrow" style="border-width:0px;box-sizing:content-box;display:inline;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1326"><span class="mi" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1327">t</span><span class="mo" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1328">=</span><span class="mn" style="border-width:0px;box-sizing:content-box;display:inline;font-family:NeoEulerMathJax_Main;line-height:normal;margin:0px;padding:0px 0px 0px 0.248em;position:static;text-decoration:none;transition:none;vertical-align:0px;" id="MathJax-Span-1329">1000</span></span><span style="border-width:0px;box-sizing:content-box;display:inline-block;height:2.131em;line-height:normal;margin:0px;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:0px;width:0px;"></span></span></span><span style="border-bottom-style:initial;border-color:initial;border-image:initial;border-left-style:solid;border-right-style:initial;border-top-style:initial;border-width:0px;box-sizing:content-box;display:inline-block;height:0.911em;line-height:normal;margin:0px;overflow:hidden;padding:0px;position:static;text-decoration:none;transition:none;vertical-align:-0.043em;width:0px;"></span></span></nobr></span></span> a batch of 16 such matrices takes up about 64Mb of memory. Since we need to store at least four of them for each head of each self-attention operation (before and after softmax, plus their gradients), that limits us to at most twelve 4-head layers in a standard 12Gb GPU. In practice, we get even less, since the inputs and outputs also take up a lot of memory (although the dot product dominates).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    And yet models reported in the literature contain much longer sequence lengths, with 48 or more layers, using dense dot product matrices. These models are trained on clusters, of course, but a single GPU is still required to do a single forward/backward pass. How do we fit such humongous transformers into 12Gb of memory? There are three main tricks:
</p>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Half precision</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            On modern GPUs and on TPUs, tensor computations can be done efficiently on 16-bit float tensors. This isn't quite as simple as just setting the dtype of the tensor to <code style="font-family:Consolas, monospace;font-size:0.8em;">torch.float16</code>. For some parts of the network, like the loss, 32 bit precision is required. But most of this can be handled with relative ease by <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/NVIDIA/apex">existing libraries</a>. Practically, this doubles your effective memory.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient accumulation</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            For a large model, we may only be able to perform a forward/backward pass on a single instance. Batch size 1 is not likely to lead to stable learning. Luckily, we can perform a single forward/backward for each instance in a larger batch, and simply sum the gradients we find (this is a consequence of the <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://mlvu.github.io/lecture07/#slide-024">multivariate chain rule</a>). When we hit the end of the batch, we do a single step of gradient descent, and zero out the gradient. In Pytorch this is particulary easy: you know that <code style="font-family:Consolas, monospace;font-size:0.8em;">optimizer.zero_grad()</code> call in your training loop that seems so superfluous? If you don't make that call, the new gradients are simply added to the old ones.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>Gradient checkpointing</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            If your model is so big that even a single forward/backward won't fit in memory, you can trade off even more computation for memory efficiency. In gradient checkpointing, you separate your model into sections. For each section, you do a separate forward/backward to compute the gradients, without retaining the intermediate values for the rest. Pytorch has <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://pytorch.org/docs/stable/checkpoint.html">special utilities</a> for gradient checkpointng.
        </p>
    </dd>
</dl>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    For more information on how to do this, see <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://medium.com/huggingface/training-larger-batches-practical-tips-on-1-gpu-multi-gpu-distributed-setups-ec88c3e51255">this blogpost</a>.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="conclusion">
    Conclusion
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    The transformer may well be the simplest machine learning architecture to dominate the field in decades. There are good reasons to start paying attention to them if you haven’t been already.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Firstly, <strong>the current performance limit is purely in the hardware</strong>. Unlike convolutions or LSTMs the current limitations to what they can do are entirely determined by how big a model we can fit in GPU memory and how much data we can push through it in a reasonable amount of time. I have no doubt, we will eventually hit the point where more layers and and more data won’t help anymore, but we don’t seem to have reached that point yet.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    Second, <strong>transformers are extremely generic</strong>. So far, the big successes have been in language modelling, with some more modest achievements in image and music analysis, but the transformer has a level of generality that is waiting to be exploited. The basic transformer is a <i>set-to-set</i> model. So long as your data is a set of units, you can apply a transformer. Anything else you know about your data (like local structure) you can add by means of position embeddings, or by manipulating the structure of the attention matrix (making it sparse, or masking out parts).
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    This is particularly useful in multi-modal learning. We could easily combine a captioned image into a set of pixels and characters and design some clever embeddings and sparsity structure to help the model figure out how to combine and align the two. If we combine the entirety of our knowledge about our domain into a relational structure like a multi-modal knowledge graph (as discussed in [3]), simple transformer blocks could be employed to propagate information between multimodal units, and to align them with the sparsity structure providing control over which units directly interact.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    So far, transformers are still primarily seen as a language model. I expect that in time, we’ll see them adopted much more in other domains, not just to increase performance, but to simplify existing models, and to allow practitioners more intuitive control over their models’ inductive biases.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="references">
    References
</h2>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [1] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://jalammar.github.io/illustrated-transformer/">The illustrated transformer</a>, Jay Allamar.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [2] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="http://nlp.seas.harvard.edu/2018/04/03/attention.html">The annotated transformer</a>, Alexander Rush.
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [3] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://content.iospress.com/articles/data-science/ds007">The knowledge graph as the default data model for learning on heterogeneous knowledge</a> Xander Wilcke, Peter Bloem, Victor de Boer
</p>
<p style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    [4] <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf">Matrix factorization techniques for recommender systems</a> Yehuda Koren et al.
</p>
<h2 style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:GillSansMTStd-Medium, &quot;Gill Sans&quot;, sans-serif;font-size:1.4rem;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:normal;letter-spacing:normal;margin:6vw auto 2vw;orphans:2;text-align:center;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;" id="updates-and-corrections">
    Updates and corrections
</h2>
<dl style="-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:Georgia, sans-serif;font-size:22px;font-style:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:400;letter-spacing:normal;margin:0px auto 1em;orphans:2;padding:0px;text-align:start;text-decoration-color:initial;text-decoration-style:initial;text-decoration-thickness:initial;text-indent:0px;text-transform:none;white-space:normal;widows:2;width:660px;word-spacing:0px;">
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>19 October 2019</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Added a section on the difference between wide and narrow self-attention. Thanks to <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/sidneyaraujomelo">Sidney Melo</a> for <a style="color:black;padding-bottom:0.4em;text-decoration:none;" target="_blank" rel="noopener noreferrer" href="https://github.com/pbloem/former/issues/8">spotting the mistake</a> in the original implementation.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>9 December 2022</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Clarified the example in the section on multi-head attention.
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>4 March 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a persistent mistake in the definition of multi-head self-attention. Rewrote the final self-attention to be the canonical form (rather than the earlier "wide" variety we used for the sake of simplicity).
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>1 Aug 2023</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed some small mistakes in the section "Going big".
        </p>
    </dd>
    <dt style="float:left;margin:0px 1em 0px 0px;padding:0px;">
        <p>
            <strong>7 May 2024</strong>
        </p>
    </dt>
    <dd style="display:block;font-weight:normal;margin:0px;padding:0px;">
        <p>
            Fixed a mistake in the multi-head self-attention: the rescaling of the parameters should divide by <code style="font-family:Consolas, monospace;font-size:0.8em;">s</code> not <code style="font-family:Consolas, monospace;font-size:0.8em;">k</code>. Thanks to Vivek Harshey for spotting this.
        </p>
    </dd>
</dl>`,
        tags: ["MongoDB", "Database", "NoSQL"],
        categories: ["Development", "Database"],
        publishedDate: "2024-04-15T10:00:00Z",
        updatedDate: "2024-04-16T11:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "7",
        title: "Introduction to Express.js",
        imgURL: "",
        content: "Express.js is a minimal and flexible Node.js web application framework Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs",
        tags: ["Express.js", "Node.js", "Backend"],
        categories: ["Development", "Backend"],
        publishedDate: "2024-03-10T09:00:00Z",
        updatedDate: "2024-03-11T10:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "8",
        title: "Understanding Async/Await in JavaScript",
        imgURL: "",
        content: "Async/await is a way to write asynchronous code that looks synchronous Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs",
        tags: ["JavaScript", "Async", "Programming"],
        categories: ["Development", "Web"],
        publishedDate: "2024-02-05T08:00:00Z",
        updatedDate: "2024-02-06T09:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
    {
        postId: "9",
        title: "Building REST APIs with Node.js",
        imgURL: "",
        content: "REST APIs are a popular way to structure web services Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs",
        tags: ["Node.js", "REST", "API"],
        categories: ["Development", "Backend"],
        publishedDate: "2024-01-15T12:00:00Z",
        updatedDate: "2024-01-16T13:00:00Z",
        summary:"Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs Tailwind CSS is a utility-first CSS framework for creating custom designs"
    },
]